# Logs và Security cơ bản trên Windows 
***

## 1. Logs
- Nhật ký là bản ghi các sự kiện xảy ra trên máy tính của bạn, do một người hoặc một quy trình đang chạy. Chúng giúp bạn theo dõi những gì đã xảy ra và khắc phục sự cố.
- Nhật ký sự kiện Windows chứa các bản ghi từ hệ điều hành và các ứng dụng như SQL Server hoặc Internet Information Services (IIS). 
- Người quản trị sử dụng nó để chẩn đoán mọi sự cố trên thiết bị hoặc trên các ứng dụng được cài đặt. Đây có thể là dữ liệu hữu ích cho các sự kiện khắc phục sự cố trong tương lai như sự cố ứng dụng hoặc lỗi hệ thống và bảo mật Windows.
- Nhật ký sự kiện Windows cung cấp thông tin về các sự kiện phần cứng và phần mềm xảy ra trên hệ điều hành Windows. Nó giúp quản trị viên mạng theo dõi các mối đe dọa và sự cố tiềm ẩn có khả năng làm giảm hiệu suất. Windows lưu trữ nhật ký sự kiện theo định dạng chuẩn cho phép hiểu rõ thông tin. Sau đây là các thành phần chính của nhật ký sự kiện:
	* Log name (Tên nhật ký): Tên của nhật ký sự kiện mà các sự kiện từ các thành phần ghi nhật ký khác nhau sẽ được ghi vào. Các sự kiện thường được ghi vào hệ thống, bảo mật và ứng dụng.
	* Event date/time (Ngày/giờ sự kiện): Bao gồm ngày và giờ sự kiện xảy ra.
	* Task category (Loại tác vụ): Xác định loại nhật ký sự kiện đã ghi. Các nhà phát triển ứng dụng cũng có thể xác định các thể loại tác vụ để làm thông tin bổ sung về sự kiện.
	* Event ID (ID sự kiện): Số nhận dạng Windows này giúp quản trị viên mạng xác định duy nhất một sự kiện đã ghi nhật ký cụ thể.
	* Source (Nguồn): Tên của chương trình hoặc phần mềm gây ra nhật ký sự kiện.
	* Level (Mức độ): Mức độ sự kiện biểu thị mức độ nghiêm trọng của nhật ký sự kiện đã ghi. Những thông tin này bao gồm thông tin, lỗi, chi tiết, cảnh báo và nghiêm trọng.
	* User (Người dùng): Tên của người dùng đã đăng nhập vào máy tính Windows khi sự kiện xảy ra.
	* Computer (Máy tính): Tên của máy tính đang ghi nhật ký sự kiện.
- ![images](./images/log-1.png)
- Các loại thông tin được lưu trữ trong Nhật ký sự kiện Windows: Nhật ký sự kiện Windows lưu trữ thông tin về các sự kiện khác nhau xảy ra trong hệ thống. Loại thông tin được lưu trữ thay đổi tùy theo danh mục của nhật ký sự kiện. Dữ liệu thường được ghi lại cho `bốn` loại nhật ký sự kiện Windows:
	- System
	- Application 
	- Setup
	- Security 
- ![images](./images/log-2.png)
- Các loại log và loại event 
	- Nhật ký sự kiện được phân loại thành bốn loại như ứng dụng, bảo mật, thiết lập và hệ thống(application, security, setup, and system). Ngoài ra còn có một loại nhật ký sự kiện đặc biệt được gọi là sự kiện chuyển tiếp(forwarded events).
		* System Log (Nhật ký hệ thống): Nhật ký sự kiện hệ thống Windows chứa các sự kiện liên quan đến hệ thống và các thành phần của hệ thống. Không tải được trình điều khiển khởi động là một ví dụ về sự kiện cấp hệ thống.
		* Application Log (Nhật ký ứng dụng): Các sự kiện liên quan đến phần mềm hoặc ứng dụng được lưu trữ trên máy tính Windows được ghi vào nhật ký sự kiện ứng dụng. Ví dụ: sự cố khi khởi động Microsoft PowerPoint nằm trong nhật ký ứng dụng.
		* Security Log (Bảo mật): Nhật ký bảo mật chứa các sự kiện liên quan đến tính an toàn của hệ thống. Sự kiện được ghi lại thông qua quy trình kiểm tra Windows. Ví dụ bao gồm thông tin đăng nhập không thành công và hợp lệ, xóa tệp, v.v.
		* Setup (Thiết lập): Nhật ký thiết lập chứa các sự kiện xảy ra trong quá trình cài đặt hệ điều hành Windows. Trên bộ điều khiển miền, nhật ký này cũng sẽ ghi lại các sự kiện liên quan đến Active Directory.
		* Forwarded events (Sự kiện chuyển tiếp): Chứa các nhật ký sự kiện được chuyển tiếp từ các máy tính khác trong cùng một mạng.
	- ![images](./images/log-3.png)
	- Sự kiện Windows được chia thành năm loại khác nhau:
		* Information (Thông tin): Chỉ ra một ứng dụng hoặc dịch vụ đang hoạt động tốt. Ví dụ: khi Windows tải trình điều khiển mạng, sự cố sẽ được ghi lại dưới dạng sự kiện thông tin.
		* Warning (Cảnh báo): Sự kiện không quan trọng ám chỉ đến các sự cố tiềm ẩn trong tương lai. Sự kiện cảnh báo sẽ được ghi lại khi có sự cố như thiếu dung lượng đĩa.
		* Error (Lỗi): Mô tả sự cố quan trọng khi hệ thống không thể hoạt động bình thường—ví dụ: hệ điều hành ngừng phản hồi.
		* Audit Success (Kiểm toán thành công): Ghi lại nỗ lực hợp lệ của quyền truy cập bảo mật đã được kiểm toán vào nhật ký bảo mật. Ví dụ: nỗ lực đăng nhập diễn ra tốt đẹp sẽ nằm trong sự kiện kiểm toán thành công.
		* Audit Failure (Kiểm toán thất bại): Chỉ ra sự cố của quyền truy cập bảo mật đã được kiểm toán trong nhật ký bảo mật, chẳng hạn như không thể truy cập ổ đĩa mạng.
	- Các mức độ nghiêm trọng của sự kiện Windows: Mức độ sự kiện Windows biểu thị mức độ nghiêm trọng hoặc tầm quan trọng của sự kiện được ghi lại. Chúng được phân loại như sau:
		* Information (Thông tin): Biểu thị sự kiện đã xảy ra mà không có vấn đề gì. Hầu hết các nhật ký đều chứa thông tin sự kiện.
		* Verbose (Chi tiết): Biểu thị thông báo tiến trình hoặc thành công cho một sự kiện cụ thể.
		* Warning (Cảnh báo): Làm nổi bật một vấn đề tiềm ẩn mà quản trị viên hệ thống cần theo dõi.
		* Error (Lỗi): Mô tả các sự cố trong hệ thống hoặc dịch vụ không yêu cầu khắc phục sự cố ngay lập tức.
		* Critical (Nghiêm trọng): Biểu thị sự cố quan trọng trong ứng dụng hoặc hệ thống cần được xử lý khẩn cấp.
- Log trong Windows được lưu trữ ở `%SystemRoot%\\System32\\winevt\\Logs`: Định dạng của event log với extension là .EVTX và được lưu trữ ở định dạng XML, giúp việc giải mã cấu trúc nhật ký trở nên trực quan hơn và cũng dễ dàng để tạo bộ lọc hỗ trợ việc tìm kiếm
- ![images](./images/log-4.png)
- Task Scheduler : 
- là một công cụ có sẵn trong Windows giúp người dùng thực hiện một số hành động và tác vụ trên máy tính như tự động chạy một phần mềm nào đó có sẵn trên máy tính. Task Scheduler có rất nhiều tính năng hỗ trợ cho máy tính, khả năng tự động hóa các tác vụ người dùng muốn chạy trên Windows nhanh chóng và hiệu quả.
- ![images](./images/task.png)
- Các tính năng hữu ích của Task Scheduler
	* Bảo trì hệ thống: thực hiện nhiệm vụ chạy các chương trình diệt virus hoặc các công cụ bảo mật vào những thời điểm cụ thể để đảm bảo máy tính luôn an toàn. Các tác vụ này có thể được lập lịch để chạy vào ban đêm hoặc trong giờ làm việc thấp điểm, giúp tối ưu hóa hiệu suất hệ thống mà không làm gián đoạn công việc hàng ngày của người dùng.
	* Sao lưu và quản lý dữ liệu: cho phép người dùng tự động hóa quá trình sao lưu dữ liệu bằng cách lập lịch cho các tác vụ sao lưu theo thời gian định kỳ, chẳng hạn như hàng ngày, hàng tuần hoặc hàng tháng. Người dùng có thể cấu hình để sao lưu các thư mục quan trọng hoặc toàn bộ hệ thống.
	* Khởi chạy các ứng dụng và chương trình: có thể thiết lập để các ứng dụng quan trọng như trình duyệt web, phần mềm quản lý công việc, hoặc các ứng dụng kinh doanh khởi chạy tự động khi máy tính khởi động hoặc vào những thời điểm cụ thể trong ngày. Nó có tác dụng trong việc tiết kiệm thời gian và đảm bảo rằng các ứng dụng quan trọng luôn sẵn sàng sử dụng khi cần.
	* Báo cáo và xử lý dữ liệu: Có thể lập lịch để các chương trình phân tích dữ liệu chạy vào thời gian cụ thể, tạo ra các báo cáo chi tiết mà không cần sự can thiệp của con người. 
	* Thực thi các tập lệnh: cho phép người dùng tự động hóa việc thực thi các tập lệnh như batch, PowerShell hoặc các ngôn ngữ kịch bản khác. Việc lập lịch thực thi các tập lệnh này giúp tự động hóa nhiều tác vụ phức tạp, từ việc cài đặt phần mềm, cập nhật hệ thống, đến quản lý mạng và cấu hình hệ thống.
- Cách sử dụng Task Scheduler cơ bản:
- Khởi chạy 
Để khởi động Task Scheduler, có thể thực hiện một số cách sau đây:
* Cách 1: Nhấn vào nút Start, gõ "Task Scheduler" vào ô tìm kiếm và nhấn Enter.
- ![images](./images/task-1.png)
* Cách 2: Mở Control Panel, chọn "System and Security", sau đó chọn "Administrative Tools" và cuối cùng nhấp đúp vào "Task Scheduler".
- ![images](./images/task-2.png)
* Cách 3: Nhấn tổ hợp phím Win + R, gõ "taskschd.msc" và nhấn Enter.
- ![images](./images/task-3.png)
- Tạo tác vụ
Nhấp vào Create Task: Trong bảng điều khiển bên phải, chọn "Create Task...".
- ![images](./images/task-4.png)
Điền thông tin cơ bản: Trong thẻ "General", điền tên và mô tả cho tác vụ. Bạn cũng có thể chọn quyền chạy tác vụ với các tùy chọn như "Run only when user is logged on" hoặc "Run whether user is logged on or not".
- ![images](./images/task-5.png)
Chọn điều kiện kích hoạt: Chuyển sang thẻ "Triggers", nhấp "New..." để tạo một điều kiện kích hoạt. Bạn có thể chọn thời gian cụ thể, tần suất (hàng ngày, hàng tuần, hàng tháng) hoặc sự kiện hệ thống (khi khởi động, khi đăng nhập, v.v.).
- ![images](./images/task-6.png)
- Cấu hình tác vụ: Quá trình cấu hình tác vụ gồm các phần sau đây:
* Chọn hành động: Chuyển sang thẻ "Actions", nhấp "New..." để tạo một hành động. Bạn có thể chọn "Start a program", "Send an email", hoặc "Display a message".
* Cấu hình chương trình: Nếu bạn chọn "Start a program", bạn cần chỉ định đường dẫn đến chương trình hoặc script sẽ được chạy. Bạn cũng có thể thêm tham số nếu cần thiết.
- ![images](./images/task-7.png)
* Thiết lập điều kiện bổ sung: Trong thẻ "Conditions", bạn có thể thiết lập các điều kiện bổ sung như chỉ chạy tác vụ khi máy tính đang ở chế độ nhàn rỗi hoặc chỉ chạy khi kết nối mạng có sẵn.
- ![images](./images/task-8.png)
* Thiết lập cài đặt: Trong thẻ "Settings", bạn có thể tinh chỉnh các tùy chọn như cho phép tác vụ chạy thủ công, dừng tác vụ nếu chạy quá lâu, hoặc cấu hình tác vụ chạy lại nếu bị lỗi.
- ![images](./images/task-9.png)
- Thực thi và giám sát hiệu quả: Các bước thực thi và giám sát gồm
	* Kiểm tra thủ công: Nhấp chuột phải vào tác vụ và chọn "Run".
	* Giám sát lịch sử: Trong thẻ "History" của tác vụ, bạn có thể xem lịch sử chạy tác vụ, bao gồm thông tin về lần chạy cuối cùng và trạng thái của nó.
	* Xem nhật ký sự kiện: Kiểm tra Event Viewer để xem các nhật ký chi tiết liên quan đến tác vụ.
- Xóa tác vụ không sử dụng: Để xóa tác vụ không sử dụng, bạn thực hiện như sau:
	* Bước 1: Trong Task Scheduler, chọn tác vụ không còn cần thiết.
	* Bước 2: Nhấn chuột phải vào tác vụ và chọn "Delete". Bạn cũng có thể chọn nhiều tác vụ cùng lúc và xóa chúng.
	
- Ví dụ tạo task cơ bản mở notepad lúc 8h sáng hàng ngày:
	* Tạo task và cấu hình trigger, actions 
	- ![images](./images/demotask-1.png)
	- ![images](./images/demotask-2.png)
	- ![images](./images/demotask-3.png)
	- ![images](./images/demotask-4.png)
	* Chạy thử 
	- ![images](./images/demotask-5.png)
	* Kết quả 
	- ![images](./images/demotask-6.png)


Windows Firewall (IN/OUT port)
EventViewer 
Security cơ bản trên Windows 
- Bảo mật đăng nhập
- Quản lý user và quyền
- Firewall (Tường lửa)
- Cập nhật hệ thống
- Giám sát hệ thống
Phân tích logs để phát hiện tấn công
So sánh log windows/linux 

https://www.solarwinds.com/resources/it-glossary/windows-event-log
https://www.windowscentral.com/how-create-automated-task-using-task-scheduler-windows-10