# SSL (Secure Sockets Layer) - TLS (Transport Layer Security)

## 1. Tá»•ng quan SSL/TLS
### 1.1 SSL/TLS  
- SSL, hay Secure Sockets Layer, lÃ  má»™t giao thá»©c báº£o máº­t trÃªn Internet dá»±a trÃªn mÃ£ hÃ³a. NÃ³ Ä‘Æ°á»£c phÃ¡t triá»ƒn láº§n Ä‘áº§u tiÃªn bá»Ÿi Netscape vÃ o nÄƒm 1995 nháº±m Ä‘áº£m báº£o tÃ­nh riÃªng tÆ°, xÃ¡c thá»±c vÃ  toÃ n váº¹n dá»¯ liá»‡u trong cÃ¡c giao tiáº¿p qua Internet. SSL lÃ  tiá»n thÃ¢n cá»§a giao thá»©c mÃ£ hÃ³a hiá»‡n Ä‘áº¡i TLS Ä‘Æ°á»£c sá»­ dá»¥ng ngÃ y nay.
- Transport Layer Security, hay TLS, lÃ  má»™t giao thá»©c báº£o máº­t Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i nháº±m há»— trá»£ quyá»n riÃªng tÆ° vÃ  báº£o máº­t dá»¯ liá»‡u trong cÃ¡c giao tiáº¿p qua Internet. Má»™t trong nhá»¯ng á»©ng dá»¥ng chÃ­nh cá»§a TLS lÃ  mÃ£ hÃ³a thÃ´ng tin trao Ä‘á»•i giá»¯a cÃ¡c á»©ng dá»¥ng web vÃ  mÃ¡y chá»§, vÃ­ dá»¥ nhÆ° khi trÃ¬nh duyá»‡t táº£i má»™t trang web. TLS cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ£ hÃ³a cÃ¡c hÃ¬nh thá»©c giao tiáº¿p khÃ¡c nhÆ° email, tin nháº¯n vÃ  thoáº¡i qua IP (VoIP).
- Giao thá»©c TLS Ä‘Æ°á»£c Ä‘á» xuáº¥t bá»Ÿi Internet Engineering Task Force (IETF), má»™t tá»• chá»©c tiÃªu chuáº©n quá»‘c táº¿, vÃ  phiÃªn báº£n Ä‘áº§u tiÃªn Ä‘Æ°á»£c cÃ´ng bá»‘ vÃ o nÄƒm 1999. PhiÃªn báº£n má»›i nháº¥t lÃ  TLS 1.3, Ä‘Æ°á»£c phÃ¡t hÃ nh vÃ o nÄƒm 2018.
- Sá»± khÃ¡c biá»‡t cá»‘t lÃµi giá»¯a SSL vÃ  TLS náº±m á»Ÿ viá»‡c TLS giá»›i thiá»‡u má»™t loáº¡t cáº£i tiáº¿n quan trá»ng nhÆ° thuáº­t toÃ¡n mÃ£ hÃ³a máº¡nh máº½ hÆ¡n, cÆ¡ cháº¿ xÃ¡c thá»±c tá»‘t hÆ¡n vÃ  phÆ°Æ¡ng phÃ¡p trao Ä‘á»•i khÃ³a an toÃ n hÆ¡n. Nhá»¯ng nÃ¢ng cáº¥p nÃ y giÃºp giáº£m Ä‘Ã¡ng ká»ƒ nguy cÆ¡ bá»‹ táº¥n cÃ´ng vÃ  Ä‘áº£m báº£o má»©c Ä‘á»™ báº£o máº­t cao hÆ¡n trong truyá»n táº£i dá»¯ liá»‡u. Má»™t sá»‘ Ä‘iá»ƒm ná»•i báº­t cá»§a TLS bao gá»“m:
	- MÃ£ hÃ³a máº¡nh hÆ¡n: TLS há»— trá»£ cÃ¡c thuáº­t toÃ¡n mÃ£ hÃ³a tiÃªn tiáº¿n nhÆ° AES (Advanced Encryption Standard), mang láº¡i kháº£ nÄƒng báº£o vá»‡ tá»‘t hÆ¡n trÆ°á»›c cÃ¡c cuá»™c táº¥n cÃ´ng brute-force.
	- KhÃ¡c biá»‡t vá» máº­t mÃ£ há»c: Máº·c dÃ¹ cáº£ hai giao thá»©c Ä‘á»u dá»±a trÃªn nguyÃªn táº¯c tÆ°Æ¡ng tá»±, TLS Ã¡p dá»¥ng cÃ¡c ká»¹ thuáº­t máº­t mÃ£ máº¡nh máº½ hÆ¡n. VÃ­ dá»¥, TLS sá»­ dá»¥ng HMAC (MÃ£ xÃ¡c thá»±c thÃ´ng Ä‘iá»‡p dá»±a trÃªn hÃ m bÄƒm) cho tÃ­nh toÃ n váº¹n cá»§a dá»¯ liá»‡u, an toÃ n hÆ¡n so vá»›i MAC trong SSL. NgoÃ i ra, TLS cÅ©ng há»— trá»£ cÃ¡c bá»™ mÃ£ hÃ³a (cipher suite) an toÃ n hÆ¡n.
	- XÃ¡c thá»±c cáº£i tiáº¿n: TLS sá»­ dá»¥ng phÆ°Æ¡ng thá»©c xÃ¡c thá»±c báº£o máº­t hÆ¡n Ä‘á»ƒ xÃ¡c minh danh tÃ­nh giá»¯a cÃ¡c bÃªn giao tiáº¿p, giáº£m nguy cÆ¡ táº¥n cÃ´ng giáº£ máº¡o trung gian. Quy trÃ¬nh báº¯t tay (handshake) cá»§a TLS cÅ©ng an toÃ n hÆ¡n vá»›i cÃ¡c cÆ¡ cháº¿ xÃ¡c thá»±c máº¡nh máº½.
	- Hiá»‡u suáº¥t cao hÆ¡n: TLS Ä‘Æ°á»£c thiáº¿t káº¿ tá»‘i Æ°u hÆ¡n, giáº£m táº£i khi thiáº¿t láº­p káº¿t ná»‘i báº£o máº­t, tá»« Ä‘Ã³ giÃºp quy trÃ¬nh báº¯t tay diá»…n ra nhanh hÆ¡n vÃ  Ä‘á»™ trá»… tháº¥p hÆ¡nâ€”phÃ¹ há»£p cho cÃ¡c á»©ng dá»¥ng web hiá»‡n Ä‘áº¡i Ä‘Ã²i há»i tá»‘c Ä‘á»™ cao vÃ  thá»i gian pháº£n há»“i nhanh.
	- Trao Ä‘á»•i khÃ³a nÃ¢ng cao: TLS sá»­ dá»¥ng cÃ¡c giao thá»©c trao Ä‘á»•i khÃ³a an toÃ n hÆ¡n nhÆ° Diffie-Hellman vÃ  Elliptic Curve Diffie-Hellman Ä‘á»ƒ thiáº¿t láº­p káº¿t ná»‘i báº£o máº­t.
### 1.2 Lá»‹ch sá»­, phiÃªn báº£n 
- SSL vÃ  TLS lÃ  nhá»¯ng giao thá»©c dÃ¹ng Ä‘á»ƒ báº£o máº­t cÃ¡c káº¿t ná»‘i máº¡ng. SSL, do Netscape phÃ¡t triá»ƒn, lÃ  giao thá»©c Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i Ä‘áº§u tiÃªn, nhÆ°ng sau Ä‘Ã³ Ä‘Ã£ Ä‘Æ°á»£c thay tháº¿ bá»Ÿi TLS â€“ má»™t phiÃªn báº£n nÃ¢ng cáº¥p vá»›i cÃ¡c tÃ­nh nÄƒng báº£o máº­t vÃ  hiá»‡u suáº¥t cáº£i tiáº¿n vÆ°á»£t trá»™i. TLS, Ä‘Æ°á»£c giá»›i thiá»‡u láº§n Ä‘áº§u vÃ o nÄƒm 1999 nhÆ° báº£n nÃ¢ng cáº¥p cá»§a SSL 3.0, hiá»‡n nay Ä‘Ã£ trá»Ÿ thÃ nh tiÃªu chuáº©n cho viá»‡c báº£o máº­t giao tiáº¿p trÃªn Internet.
**SSL (Secure Sockets Layer):**  
- ÄÆ°á»£c phÃ¡t triá»ƒn bá»Ÿi Netscape vÃ o giá»¯a nhá»¯ng nÄƒm 1990  
- *SSL 1.0* chÆ°a tá»«ng Ä‘Æ°á»£c phÃ¡t hÃ nh cÃ´ng khai do cÃ³ nhiá»u lá»— há»•ng báº£o máº­t  
- *SSL 2.0* phÃ¡t hÃ nh vÃ o nÄƒm 1995, lÃ  phiÃªn báº£n cÃ´ng khai Ä‘áº§u tiÃªn nhÆ°ng cÅ©ng tá»“n táº¡i nhiá»u Ä‘iá»ƒm yáº¿u  
- *SSL 3.0* ra máº¯t nÄƒm 1996, lÃ  má»™t báº£n thiáº¿t káº¿ láº¡i vá»›i cáº£i tiáº¿n rÃµ rá»‡t, nhÆ°ng theo thá»i gian váº«n bá»‹ phÃ¡t hiá»‡n cÃ³ lá»— há»•ng  

**TLS (Transport Layer Security):**  
- TLS 1.0: ÄÃ¢y lÃ  phiÃªn báº£n Ä‘áº§u tiÃªn Ä‘Æ°á»£c phÃ¡t hÃ nh vÃ o nÄƒm 1999. LÃ  phiÃªn báº£n tiáº¿p ná»‘i vÃ  chá»©a nhiá»u Ä‘áº·c Ä‘iá»ƒm tÆ°Æ¡ng Ä‘á»“ng vá»›i SSL 3.0. PhiÃªn báº£n nÃ y Ä‘Ã£ Ä‘Æ°á»£c cáº£i tiáº¿n vÃ  cáº­p nháº­t cÃ¡c giao thá»©c vÃ  quy trÃ¬nh Ä‘á»ƒ tÆ°Æ¡ng thÃ­ch vá»›i cÃ¡c mÃ¡y tÃ­nh vÃ  káº¿t ná»‘i Internet trong giai Ä‘oáº¡n Ä‘áº§u cá»§a tháº­p ká»· 2000. PhiÃªn báº£n 1.0 Ä‘Æ°á»£c cÃ´ng bá»‘ theo RFC 2246, Ä‘á»‹nh nghÄ©a cÃ¡c yÃªu cáº§u vÃ  quy Ä‘á»‹nh chi tiáº¿t cho giao thá»©c nÃ y.
- TLS 1.1: ÄÃ¢y lÃ  phiÃªn báº£n thá»© hai Ä‘Æ°á»£c ra máº¯t vÃ o nÄƒm 2006, Ä‘áº¡i diá»‡n cho sá»± tiáº¿n bá»™ Ä‘Ã¡ng ká»ƒ Ä‘áº§u tiÃªn cá»§a giao thá»©c nÃ y. PhiÃªn báº£n nÃ y Ä‘Ã£ mang Ä‘áº¿n nhiá»u thay Ä‘á»•i vÃ  cáº£i tiáº¿n Ä‘Ã¡ng ká»ƒ, bao gá»“m viá»‡c thay tháº¿ VectÆ¡ Khá»Ÿi táº¡o báº±ng má»™t phiÃªn báº£n rÃµ rÃ ng hÆ¡n Ä‘á»ƒ cung cáº¥p kháº£ nÄƒng báº£o vá»‡ tá»‘t hÆ¡n chá»‘ng láº¡i cÃ¡c cuá»™c táº¥n cÃ´ng máº¡ng.
	- NgoÃ i ra, phiÃªn báº£n 1.1 cÅ©ng Ä‘Ã£ cáº£i thiá»‡n quÃ¡ trÃ¬nh xá»­ lÃ½ lá»—i vÃ  xÃ¡c thá»±c Ä‘á»ƒ phÃ¹ há»£p vá»›i mÃ´i trÆ°á»ng sá»­ dá»¥ng Internet vÃ o nÄƒm 2006. BÃªn cáº¡nh Ä‘Ã³, cÃ¡c ghi chÃº vÃ  giáº£i thÃ­ch liÃªn quan Ä‘áº¿n cÃ¡c hÃ¬nh thá»©c táº¥n cÃ´ng máº¡ng má»›i Ä‘Ã£ Ä‘Æ°á»£c bá»• sung vÃ o phiÃªn báº£n nÃ y. PhiÃªn báº£n 1.1 Ä‘Ã£ Ä‘Æ°á»£c cÃ´ng bá»‘ theo RFC 4346.
- TLS 1.2: ÄÃ¢y lÃ  phiÃªn báº£n thá»© ba vÃ  Ä‘Æ°á»£c ra máº¯t vÃ o nÄƒm 2008. LÃ  phiÃªn báº£n cáº­p nháº­t quan trá»ng thá»© hai cá»§a giao thá»©c vÃ  hiá»‡n váº«n lÃ  phiÃªn báº£n tiÃªu chuáº©n Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i. ÄÆ°á»£c coi lÃ  phiÃªn báº£n má»›i nháº¥t, PhiÃªn báº£n 1.2 mang Ä‘áº¿n nhiá»u cáº£i tiáº¿n báº£o máº­t Ä‘Ã¡ng ká»ƒ cÃ¹ng vá»›i viá»‡c cáº£i thiá»‡n tá»‘c Ä‘á»™ vÃ  kháº£ nÄƒng cá»§a cáº£ mÃ¡y chá»§ vÃ  mÃ¡y khÃ¡ch trong quÃ¡ trÃ¬nh thiáº¿t láº­p káº¿t ná»‘i vÃ  sá»­ dá»¥ng táº¥t cáº£ cÃ¡c thuáº­t toÃ¡n liÃªn quan Ä‘áº¿n quy trÃ¬nh TLS.
	- Má»™t cáº£i tiáº¿n quan trá»ng cá»§a phiÃªn báº£n 1.2 lÃ  viá»‡c Ã¡p dá»¥ng cÃ¡c thuáº­t toÃ¡n báº£o máº­t máº¡nh hÆ¡n Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh toÃ n váº¹n vÃ  báº£o máº­t dá»¯ liá»‡u. PhiÃªn báº£n nÃ y Ä‘Ã£ Ä‘Æ°á»£c cÃ´ng bá»‘ theo RFC 5246.
- TLS 1.3: ÄÃ¢y lÃ  phiÃªn báº£n má»›i nháº¥t cá»§a giao thá»©c nÃ y, Ä‘Æ°á»£c cÃ´ng bá»‘ vÃ o nÄƒm 2016 vÃ  Ä‘ang trong giai Ä‘oáº¡n thá»­ nghiá»‡m. Má»¥c tiÃªu chÃ­nh cá»§a báº£n cáº­p nháº­t nÃ y lÃ  cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ giao thá»©c báº£o máº­t hiá»‡n cÃ³, tÄƒng cÆ°á»ng tÃ­nh an toÃ n trÃªn internet vÃ  Ä‘áº£m báº£o tÃ­nh toÃ n váº¹n cá»§a viá»‡c truyá»n dá»¯ liá»‡u. PhiÃªn báº£n 1.3 Ä‘Ã£ Ã¡p dá»¥ng cÃ¡c cáº£i tiáº¿n Ä‘á»ƒ Ä‘á»‘i phÃ³ vá»›i cÃ¡c ká»¹ thuáº­t hack phá»©c táº¡p, nháº±m báº£o vá»‡ dá»¯ liá»‡u nháº¡y cáº£m vÃ  thÃ´ng tin cÃ¡ nhÃ¢n, cháº³ng háº¡n nhÆ° thÃ´ng tin tÃ i khoáº£n ngÃ¢n hÃ ng vÃ  thanh toÃ¡n.

| Protocol | Published | Status |
|----------|-----------|--------|
| ğŸ”´ SSL 1.0 | Unpublished | Unpublished |
| ğŸ”´ SSL 2.0 | 1995 | Deprecated in 2011 (RFC 6176) |
| ğŸ”´ SSL 3.0 | 1996 | Deprecated in 2015 (RFC 7568) |
| ğŸ”´ TLS 1.0 | 1999 | Deprecated in 2021 (RFC 8996) |
| ğŸ”´ TLS 1.1 | 2006 | Deprecated in 2021 (RFC 8996) |
| ğŸŸ¡ TLS 1.2 | 2008 | In use since 2008 |
| ğŸŸ¢ TLS 1.3 | 2018 | In use since 2018 |

### 1.3 Vai trÃ² cá»§a SSL trong báº£o máº­t máº¡ng (HTTPS, email, VPN, v.v.)
- HTTPS (Hypertext Transfer Protocol Secure): SSL/TLS lÃ  ná»n táº£ng cá»§a HTTPS â€“ má»™t phiÃªn báº£n báº£o máº­t cá»§a HTTP. Giao thá»©c nÃ y mÃ£ hÃ³a dá»¯ liá»‡u truyá»n giá»¯a trÃ¬nh duyá»‡t vÃ  mÃ¡y chá»§, giÃºp báº£o vá»‡ thÃ´ng tin khá»i bá»‹ nghe lÃ©n hoáº·c chá»‰nh sá»­a. NÃ³ cÅ©ng thá»±c hiá»‡n xÃ¡c thá»±c mÃ¡y chá»§ Ä‘á»ƒ ngÆ°á»i dÃ¹ng biáº¿t há» Ä‘ang káº¿t ná»‘i vá»›i Ä‘Ãºng website.
- Email: CÃ¡c giao thá»©c email nhÆ° SMTPS, POP3S vÃ  IMAPS sá»­ dá»¥ng SSL/TLS Ä‘á»ƒ báº£o vá»‡ ná»™i dung thÆ° Ä‘iá»‡n tá»­ trong quÃ¡ trÃ¬nh truyá»n táº£i. Äiá»u nÃ y ngÄƒn cháº·n viá»‡c rÃ² rá»‰ hoáº·c giáº£ máº¡o email, Ä‘á»“ng thá»i Ä‘áº£m báº£o tÃ­nh toÃ n váº¹n cá»§a thÃ´ng tin.
- VPN (Virtual Private Network): Má»™t sá»‘ giao thá»©c VPN (vÃ­ dá»¥: OpenVPN) dá»±a trÃªn SSL/TLS Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u giá»¯a thiáº¿t bá»‹ cá»§a ngÆ°á»i dÃ¹ng vÃ  mÃ¡y chá»§ VPN. Äiá»u nÃ y táº¡o ra má»™t kÃªnh truyá»n thÃ´ng an toÃ n, Ä‘áº·c biá»‡t há»¯u Ã­ch khi sá»­ dá»¥ng máº¡ng cÃ´ng cá»™ng.
- CÃ¡c á»©ng dá»¥ng khÃ¡c: SSL/TLS Ä‘Æ°á»£c á»©ng dá»¥ng trong báº£o máº­t cÃ¡c dá»‹ch vá»¥ nhÆ° nháº¯n tin, thoáº¡i qua IP (VoIP), truy cáº­p tá»« xa, vÃ  API trong kiáº¿n trÃºc microservices hoáº·c há»‡ thá»‘ng Ä‘Ã¡m mÃ¢y. Viá»‡c sá»­ dá»¥ng SSL giÃºp báº£o vá»‡ cÃ¡c tÆ°Æ¡ng tÃ¡c giá»¯a cÃ¡c thÃ nh pháº§n pháº§n má»m khÃ¡c nhau khá»i rÃ² rá»‰ hoáº·c can thiá»‡p dá»¯ liá»‡u.
### 1.4 Lá»£i Ã­ch
- Lá»£i Ã­ch cá»§a SSL/TLS:
	- Báº£o vá»‡ dá»¯ liá»‡u: MÃ£ hÃ³a thÃ´ng tin giÃºp ngÄƒn cháº·n nghe lÃ©n, Ä‘Ã¡nh cáº¯p vÃ  chá»‰nh sá»­a dá»¯ liá»‡u.
	- XÃ¡c thá»±c danh tÃ­nh: Äáº£m báº£o ngÆ°á»i dÃ¹ng Ä‘ang truy cáº­p Ä‘Ãºng website há»£p phÃ¡p.
	- TuÃ¢n thá»§ tiÃªu chuáº©n: Báº¯t buá»™c vá»›i cÃ¡c website thanh toÃ¡n Ä‘á»ƒ Ä‘Ã¡p á»©ng yÃªu cáº§u PCI-DSS.
	- NgÄƒn cháº·n táº¥n cÃ´ng: Báº£o vá»‡ khá»i giáº£ máº¡o, nghe lÃ©n vÃ  Ä‘Ã¡nh cáº¯p danh tÃ­nh.
	- Chá»‘ng lá»«a Ä‘áº£o: KhÃ³ cÃ³ trang giáº£ máº¡o nÃ o Ä‘áº¡t Ä‘Æ°á»£c chá»©ng chá»‰ báº£o máº­t cao cáº¥p nhÆ° EV/OV.
	- Cáº£i thiá»‡n thá»© háº¡ng tÃ¬m kiáº¿m: Google Æ°u tiÃªn cÃ¡c website sá»­ dá»¥ng HTTPS.
	- TÄƒng niá»m tin ngÆ°á»i dÃ¹ng: Biá»ƒu tÆ°á»£ng á»• khÃ³a vÃ  HTTPS táº¡o cáº£m giÃ¡c an toÃ n khi giao dá»‹ch.

### 1.5 CÃ¡c váº¥n Ä‘á» khi sá»­ dá»¥ng SSL/TLS
- Máº·c dÃ¹ SSL/TLS mang láº¡i nhiá»u lá»£i Ã­ch, nhÆ°ng cÃ¡c nhÃ  phÃ¡t triá»ƒn cÃ³ thá»ƒ gáº·p pháº£i má»™t sá»‘ thÃ¡ch thá»©c khi triá»ƒn khai:
	- TÃ¡c Ä‘á»™ng Ä‘áº¿n hiá»‡u suáº¥t: SSL/TLS táº¡o ra má»™t má»©c Ä‘á»™ táº£i bá»• sung do quÃ¡ trÃ¬nh mÃ£ hÃ³a vÃ  giáº£i mÃ£. Äiá»u nÃ y cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u suáº¥t á»©ng dá»¥ng, Ä‘áº·c biá»‡t khi xá»­ lÃ½ lÆ°á»£ng lá»›n dá»¯ liá»‡u hoáº·c giao tiáº¿p theo thá»i gian thá»±c.
	- Váº¥n Ä‘á» tÆ°Æ¡ng thÃ­ch: Viá»‡c triá»ƒn khai SSL/TLS cÃ³ thá»ƒ khÃ¡c nhau giá»¯a cÃ¡c ná»n táº£ng, thÆ° viá»‡n vÃ  phiÃªn báº£n. Äiá»u nÃ y cÃ³ thá»ƒ dáº«n Ä‘áº¿n sá»± cá»‘ tÆ°Æ¡ng thÃ­ch khi thiáº¿t láº­p káº¿t ná»‘i báº£o máº­t giá»¯a mÃ¡y khÃ¡ch vÃ  mÃ¡y chá»§.
	- Kháº£ nÄƒng má»Ÿ rá»™ng: CÃ¡c á»©ng dá»¥ng nháº¯n tin vÃ  chat theo thá»i gian thá»±c thÆ°á»ng pháº£i xá»­ lÃ½ nhiá»u káº¿t ná»‘i Ä‘á»“ng thá»i. Viá»‡c má»Ÿ rá»™ng SSL/TLS cÃ³ thá»ƒ gáº·p khÃ³ khÄƒn vÃ¬ cáº§n thÃªm tÃ i nguyÃªn tÃ­nh toÃ¡n Ä‘á»ƒ thá»±c hiá»‡n mÃ£ hÃ³a vÃ  giáº£i mÃ£. Cáº§n xem xÃ©t triá»ƒn khai cÃ¡c chiáº¿n lÆ°á»£c cÃ¢n báº±ng táº£i vÃ  bá»™ Ä‘á»‡m (caching) Ä‘á»ƒ xá»­ lÃ½ lÆ°u lÆ°á»£ng tÄƒng cao.
	- Äá»™ phá»©c táº¡p trong tÃ­ch há»£p: TÃ­ch há»£p SSL/TLS vÃ o á»©ng dá»¥ng cÃ³ thá»ƒ phá»©c táº¡p, Ä‘áº·c biá»‡t lÃ  Ä‘á»‘i vá»›i kiáº¿n trÃºc phÃ¢n tÃ¡n hoáº·c cÃ¡c há»‡ thá»‘ng phá»¥ thuá»™c vÃ o nhiá»u dá»‹ch vá»¥ bÃªn thá»© ba.
	- Quáº£n lÃ½ chá»©ng chá»‰: Viá»‡c quáº£n lÃ½ vÃ  gia háº¡n chá»©ng chá»‰ sá»‘ cÃ³ thá»ƒ tá»‘n thá»i gian vÃ  cÃ´ng sá»©c, Ä‘áº·c biá»‡t trong cÃ¡c há»‡ thá»‘ng quy mÃ´ lá»›n vá»›i nhiá»u mÃ¡y chá»§ vÃ  tÃªn miá»n.
	- Chi phÃ­ phÃ¡t triá»ƒn vÃ  báº£o trÃ¬ bá»• sung: Viá»‡c triá»ƒn khai SSL/TLS cho cÃ¡c á»©ng dá»¥ng chat thá»i gian thá»±c Ä‘Ã²i há»i thÃªm ná»— lá»±c vá» máº·t phÃ¡t triá»ƒn vÃ  báº£o trÃ¬.

### 1.6 So sÃ¡nh SSL/TLS

| TiÃªu chÃ­                  | SSL                                                                      | TLS                                                                      |
| ------------------------- | ------------------------------------------------------------------------ | ------------------------------------------------------------------------ |
| Viáº¿t táº¯t                  | SSL lÃ  viáº¿t táº¯t cá»§a *Secure Sockets Layer*.                              | TLS lÃ  viáº¿t táº¯t cá»§a *Transport Layer Security*.                          |
| Lá»‹ch sá»­ phiÃªn báº£n         | SSL hiá»‡n Ä‘Ã£ bá»‹ thay tháº¿ bá»Ÿi TLS. Bao gá»“m cÃ¡c phiÃªn báº£n 1.0, 2.0 vÃ  3.0.  | TLS lÃ  phiÃªn báº£n nÃ¢ng cáº¥p tá»« SSL. CÃ³ cÃ¡c phiÃªn báº£n 1.0, 1.1, 1.2 vÃ  1.3. |
| TÃ¬nh tráº¡ng hoáº¡t Ä‘á»™ng      | Táº¥t cáº£ cÃ¡c phiÃªn báº£n SSL Ä‘á»u Ä‘Ã£ bá»‹ khai tá»­ (deprecated).                 | TLS 1.2 vÃ  1.3 váº«n Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng phá»• biáº¿n.                           |
| ThÃ´ng bÃ¡o cáº£nh bÃ¡o        | Chá»‰ cÃ³ hai loáº¡i thÃ´ng bÃ¡o cáº£nh bÃ¡o. CÃ¡c thÃ´ng bÃ¡o nÃ y khÃ´ng Ä‘Æ°á»£c mÃ£ hÃ³a. | ThÃ´ng bÃ¡o cáº£nh bÃ¡o Ä‘Æ°á»£c mÃ£ hÃ³a vÃ  Ä‘a dáº¡ng hÆ¡n.                           |
| XÃ¡c thá»±c thÃ´ng Ä‘iá»‡p       | Sá»­ dá»¥ng MAC (Message Authentication Code).                               | Sá»­ dá»¥ng HMAC (Hash-based MAC), an toÃ n hÆ¡n.                              |
| Bá»™ mÃ£ hÃ³a (Cipher Suites) | Há»— trá»£ cÃ¡c thuáº­t toÃ¡n cÅ©, nhiá»u thuáº­t toÃ¡n Ä‘Ã£ cÃ³ lá»— há»•ng.                | Sá»­ dá»¥ng thuáº­t toÃ¡n mÃ£ hÃ³a tiÃªn tiáº¿n, báº£o máº­t cao.                        |
| Báº¯t tay (Handshake)       | QuÃ¡ trÃ¬nh báº¯t tay phá»©c táº¡p vÃ  cháº­m.                                      | Báº¯t tay Ä‘Æ¡n giáº£n hÆ¡n, thiáº¿t láº­p káº¿t ná»‘i nhanh hÆ¡n.                       |


## 2. CÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a SSL 
### 2.1 Hoáº¡t Ä‘á»™ng cá»§a SSL/TLS 
- Giao tiáº¿p an toÃ n báº¯t Ä‘áº§u báº±ng quÃ¡ trÃ¬nh báº¯t tay TLS (TLS handshake), trong Ä‘Ã³ hai bÃªn tham gia sáº½ thiáº¿t láº­p káº¿t ná»‘i báº£o máº­t vÃ  trao Ä‘á»•i khÃ³a cÃ´ng khai.
- Trong quÃ¡ trÃ¬nh báº¯t tay, cáº£ hai bÃªn sáº½ táº¡o ra khÃ³a phiÃªn (session key), vÃ  cÃ¡c khÃ³a nÃ y sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ£ hÃ³a vÃ  giáº£i mÃ£ toÃ n bá»™ dá»¯ liá»‡u truyá»n sau Ä‘Ã³.
- Má»—i phiÃªn giao tiáº¿p má»›i sá»­ dá»¥ng má»™t khÃ³a phiÃªn khÃ¡c nhau, Ä‘áº£m báº£o tÃ­nh riÃªng tÆ° vÃ  báº£o máº­t.
- TLS Ä‘áº£m báº£o ráº±ng bÃªn mÃ¡y chá»§ (hoáº·c website mÃ  ngÆ°á»i dÃ¹ng Ä‘ang tÆ°Æ¡ng tÃ¡c) thá»±c sá»± lÃ  Ä‘á»‘i tÆ°á»£ng chÃ­nh xÃ¡c nhÆ° há» tuyÃªn bá»‘.
- TLS cÅ©ng Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u khÃ´ng bá»‹ thay Ä‘á»•i trong quÃ¡ trÃ¬nh truyá»n, nhá» sá»­ dá»¥ng mÃ£ xÃ¡c thá»±c thÃ´ng Ä‘iá»‡p (MAC â€“ Message Authentication Code).
- Vá»›i TLS, táº¥t cáº£ dá»¯ liá»‡u HTTP mÃ  ngÆ°á»i dÃ¹ng gá»­i Ä‘áº¿n website (nhÆ° nháº¥p chuá»™t, Ä‘iá»n biá»ƒu máº«uâ€¦) vÃ  dá»¯ liá»‡u mÃ  website gá»­i láº¡i cho ngÆ°á»i dÃ¹ng Ä‘á»u Ä‘Æ°á»£c mÃ£ hÃ³a. Dá»¯ liá»‡u nÃ y chá»‰ cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i mÃ£ bá»Ÿi bÃªn nháº­n báº±ng khÃ³a thÃ­ch há»£p.

### 2.2 Handshake SSL/TLS: CÃ¡ch thiáº¿t láº­p káº¿t ná»‘i an toÃ n.
- CÃ¡c "SSL handshakes" thá»±c cháº¥t lÃ  TLS handshakes, máº·c dÃ¹ tÃªn â€œSSLâ€ váº«n Ä‘Æ°á»£c sá»­ dá»¥ng phá»• biáº¿n trong thá»±c táº¿.
- TLS handshake xáº£y ra khi ngÆ°á»i dÃ¹ng truy cáº­p vÃ o dá»‹ch vá»¥ sá»­ dá»¥ng SSL/TLS vÃ  client liÃªn láº¡c vá»›i server.
- LÆ°u Ã½: TLS handshake Ä‘Æ°á»£c thá»±c hiá»‡n sau khi káº¿t ná»‘i TCP Ä‘Ã£ Ä‘Æ°á»£c thiáº¿t láº­p thÃ´ng qua quÃ¡ trÃ¬nh TCP handshake.
- Trong quÃ¡ trÃ¬nh TLS handshake, mÃ¡y khÃ¡ch (client) vÃ  mÃ¡y chá»§ (server) sáº½ thá»±c hiá»‡n cÃ¡c bÆ°á»›c sau:
	- XÃ¡c Ä‘á»‹nh phiÃªn báº£n TLS sáº½ sá»­ dá»¥ng (vÃ­ dá»¥: TLS 1.0, 1.2, 1.3, v.v.)
	- Thá»a thuáº­n lá»±a chá»n bá»™ thuáº­t toÃ¡n mÃ£ hÃ³a (cipher suites) Ä‘Æ°á»£c há»— trá»£ vÃ  sá»­ dá»¥ng
	- XÃ¡c thá»±c danh tÃ­nh cá»§a mÃ¡y chá»§ thÃ´ng qua khÃ³a cÃ´ng khai (public key) vÃ  chá»¯ kÃ½ sá»‘ tá»« tá»• chá»©c phÃ¡t hÃ nh chá»©ng chá»‰ SSL
	- Táº¡o khÃ³a phiÃªn (session key) Ä‘á»ƒ sá»­ dá»¥ng mÃ£ hÃ³a Ä‘á»‘i xá»©ng sau khi handshake hoÃ n táº¥t
- TLS handshake lÃ  má»™t chuá»—i cÃ¡c datagram (gÃ³i tin) hoáº·c thÃ´ng Ä‘iá»‡p Ä‘Æ°á»£c trao Ä‘á»•i giá»¯a mÃ¡y khÃ¡ch (client) vÃ  mÃ¡y chá»§ (server). QuÃ¡ trÃ¬nh handshake bao gá»“m nhiá»u bÆ°á»›c, trong Ä‘Ã³ hai bÃªn trao Ä‘á»•i cÃ¡c thÃ´ng tin cáº§n thiáº¿t Ä‘á»ƒ hoÃ n táº¥t handshake vÃ  thiáº¿t láº­p kháº£ nÄƒng giao tiáº¿p báº£o máº­t tiáº¿p theo.
- CÃ¡c bÆ°á»›c cá»¥ thá»ƒ trong má»™t TLS handshake cÃ³ thá»ƒ khÃ¡c nhau tÃ¹y thuá»™c vÃ o thuáº­t toÃ¡n trao Ä‘á»•i khÃ³a Ä‘Æ°á»£c sá»­ dá»¥ng vÃ  cÃ¡c bá»™ mÃ£ hÃ³a (cipher suites) mÃ  cáº£ hai bÃªn há»— trá»£. Thuáº­t toÃ¡n trao Ä‘á»•i khÃ³a RSA â€“ hiá»‡n nay khÃ´ng cÃ²n Ä‘Æ°á»£c coi lÃ  an toÃ n â€“ tá»«ng Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c phiÃªn báº£n TLS trÆ°á»›c 1.3. Quy trÃ¬nh Ä‘iá»ƒn hÃ¬nh nhÆ° sau:
	1. Thiáº¿t láº­p káº¿t ná»‘i báº£o máº­t (Quy trÃ¬nh Handshake)
	- Client Hello: MÃ¡y khÃ¡ch (trÃ¬nh duyá»‡t cá»§a báº¡n) gá»­i má»™t thÃ´ng Ä‘iá»‡p Ä‘áº¿n mÃ¡y chá»§ Ä‘á»ƒ yÃªu cáº§u thiáº¿t láº­p káº¿t ná»‘i báº£o máº­t. ThÃ´ng Ä‘iá»‡p nÃ y bao gá»“m cÃ¡c thuáº­t toÃ¡n mÃ£ hÃ³a Ä‘Æ°á»£c há»— trá»£ vÃ  má»™t sá»‘ ngáº«u nhiÃªn dÃ¹ng Ä‘á»ƒ khá»Ÿi táº¡o mÃ£ hÃ³a.
	- Server Hello: MÃ¡y chá»§ pháº£n há»“i báº±ng sá»‘ ngáº«u nhiÃªn cá»§a riÃªng nÃ³, chá»n thuáº­t toÃ¡n mÃ£ hÃ³a phÃ¹ há»£p tá»« danh sÃ¡ch cá»§a mÃ¡y khÃ¡ch vÃ  gá»­i kÃ¨m chá»©ng chá»‰ SSL/TLS (chá»©a khÃ³a cÃ´ng khai vÃ  danh tÃ­nh cá»§a mÃ¡y chá»§).
	2. XÃ¡c thá»±c
	- MÃ¡y khÃ¡ch kiá»ƒm tra tÃ­nh há»£p lá»‡ cá»§a chá»©ng chá»‰ SSL/TLS thÃ´ng qua tá»• chá»©c chá»©ng thá»±c (CA) Ä‘Ã£ cáº¥p chá»©ng chá»‰ Ä‘Ã³. Viá»‡c nÃ y Ä‘áº£m báº£o mÃ¡y chá»§ lÃ  Ä‘Ãºng Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c khai bÃ¡o.
	- Náº¿u chá»©ng chá»‰ há»£p lá»‡ vÃ  Ä‘Ã¡ng tin cáº­y, mÃ¡y khÃ¡ch sáº½ tiáº¿p tá»¥c káº¿t ná»‘i. Náº¿u khÃ´ng, sáº½ xuáº¥t hiá»‡n cáº£nh bÃ¡o (vÃ­ dá»¥: â€œkáº¿t ná»‘i khÃ´ng Ä‘Ã¡ng tinâ€).
	3. Trao Ä‘á»•i khÃ³a
	- Client Key Exchange: MÃ¡y khÃ¡ch táº¡o má»™t sá»‘ ngáº«u nhiÃªn gá»i lÃ  "pre-master secret" vÃ  mÃ£ hÃ³a nÃ³ báº±ng khÃ³a cÃ´ng khai cá»§a mÃ¡y chá»§ rá»“i gá»­i Ä‘áº¿n mÃ¡y chá»§.
	- Server Decrypts: MÃ¡y chá»§ giáº£i mÃ£ pre-master secret báº±ng khÃ³a bÃ­ máº­t cá»§a mÃ¬nh.
	- Cáº£ hai bÃªn sau Ä‘Ã³ sá»­ dá»¥ng pre-master secret cÃ¹ng vá»›i cÃ¡c sá»‘ ngáº«u nhiÃªn tá»« handshake Ä‘á»ƒ táº¡o ra khÃ³a phiÃªn (session key). KhÃ³a nÃ y sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ£ hÃ³a vÃ  giáº£i mÃ£ dá»¯ liá»‡u trong suá»‘t phiÃªn lÃ m viá»‡c.
	4. MÃ£ hÃ³a dá»¯ liá»‡u vÃ  giao tiáº¿p an toÃ n
	- Khi cáº£ hai Ä‘Ã£ cÃ³ chung má»™t khÃ³a phiÃªn, há» cÃ³ thá»ƒ mÃ£ hÃ³a vÃ  giáº£i mÃ£ dá»¯ liá»‡u trao Ä‘á»•i. Nhá» Ä‘Ã³, ngay cáº£ khi káº» táº¥n cÃ´ng cháº·n Ä‘Æ°á»£c dá»¯ liá»‡u, há» cÅ©ng khÃ´ng thá»ƒ Ä‘á»c ná»™i dung náº¿u khÃ´ng cÃ³ khÃ³a phiÃªn.
	5. Káº¿t thÃºc phiÃªn lÃ m viá»‡c
	- Sau khi trao Ä‘á»•i xong, mÃ¡y khÃ¡ch vÃ  mÃ¡y chá»§ gá»­i thÃ´ng bÃ¡o cho nhau ráº±ng phiÃªn lÃ m viá»‡c Ä‘Ã£ káº¿t thÃºc. Viá»‡c nÃ y Ä‘áº£m báº£o khÃ³a phiÃªn Ä‘Æ°á»£c há»§y bá» vÃ  káº¿t ná»‘i báº£o máº­t Ä‘Æ°á»£c Ä‘Ã³ng láº¡i.
	- ![images](./images/tls-sequence-diagram.png)
- Handshake trong TLS 1.3 
	- TLS 1.3 khÃ´ng há»— trá»£ RSA hay cÃ¡c bá»™ mÃ£ hÃ³a vÃ  tham sá»‘ dá»… bá»‹ táº¥n cÃ´ng. Giao thá»©c nÃ y cÅ©ng rÃºt gá»n quÃ¡ trÃ¬nh handshake, giÃºp TLS 1.3 handshake diá»…n ra nhanh hÆ¡n vÃ  an toÃ n hÆ¡n.
	- CÃ¡c bÆ°á»›c cÆ¡ báº£n trong TLS 1.3 handshake:
		- Client Hello: MÃ¡y khÃ¡ch gá»­i thÃ´ng Ä‘iá»‡p hello chá»©a phiÃªn báº£n giao thá»©c, client random vÃ  danh sÃ¡ch cÃ¡c cipher suite Ä‘Æ°á»£c há»— trá»£. Do TLS 1.3 Ä‘Ã£ loáº¡i bá» cÃ¡c thuáº­t toÃ¡n yáº¿u, danh sÃ¡ch cipher suite Ä‘Ã£ Ä‘Æ°á»£c rÃºt gá»n Ä‘Ã¡ng ká»ƒ. ThÃ´ng Ä‘iá»‡p cÅ©ng bao gá»“m cÃ¡c tham sá»‘ cáº§n thiáº¿t Ä‘á»ƒ tÃ­nh toÃ¡n "premaster secret". TrÃªn thá»±c táº¿, mÃ¡y khÃ¡ch gáº§n nhÆ° Ä‘oÃ¡n trÆ°á»›c Ä‘Æ°á»£c phÆ°Æ¡ng phÃ¡p trao Ä‘á»•i khÃ³a mÃ  mÃ¡y chá»§ Æ°a dÃ¹ng â€” Ä‘iá»u nÃ y giÃºp rÃºt ngáº¯n tá»•ng thá»i gian handshake, lÃ  Ä‘iá»ƒm khÃ¡c biá»‡t chÃ­nh so vá»›i cÃ¡c phiÃªn báº£n TLS cÅ© hÆ¡n (1.0 â€“ 1.2).
		- MÃ¡y chá»§ táº¡o master secret: Sau khi nháº­n Ä‘Æ°á»£c client random vÃ  cÃ¡c tham sá»‘, mÃ¡y chá»§ tá»± táº¡o server random vÃ  cÃ³ Ä‘á»§ thÃ´ng tin Ä‘á»ƒ tÃ­nh master secret.
		- Server Hello + Finished: Server hello bao gá»“m chá»©ng chá»‰ sá»‘, chá»¯ kÃ½ sá»‘, server random vÃ  cipher suite Ä‘Ã£ chá»n. VÃ¬ Ä‘Ã£ cÃ³ master secret, mÃ¡y chá»§ cÅ©ng gá»­i luÃ´n thÃ´ng Ä‘iá»‡p "Finished".
		- BÆ°á»›c cuá»‘i â€“ Client Finished: MÃ¡y khÃ¡ch xÃ¡c minh chá»¯ kÃ½ vÃ  chá»©ng chá»‰, táº¡o master secret vÃ  gá»­i láº¡i thÃ´ng Ä‘iá»‡p "Finished".
		â†’ MÃ£ hÃ³a Ä‘á»‘i xá»©ng an toÃ n Ä‘Æ°á»£c thiáº¿t láº­p.
	- 0-RTT (Zero Round Trip Time) cho tÃ¡i sá»­ dá»¥ng phiÃªn: TLS 1.3 cÃ²n há»— trá»£ cháº¿ Ä‘á»™ 0-RTT cho cÃ¡c láº§n káº¿t ná»‘i tiáº¿p theo: náº¿u client vÃ  server Ä‘Ã£ tá»«ng káº¿t ná»‘i trÆ°á»›c Ä‘Ã³, há» cÃ³ thá»ƒ táº¡o ra má»™t "resumption main secret" tá»« phiÃªn Ä‘áº§u tiÃªn. Trong phiÃªn Ä‘áº§u, server gá»­i cho client má»™t vÃ© phiÃªn (session ticket). Khi client káº¿t ná»‘i láº¡i, nÃ³ dÃ¹ng shared secret nÃ y vÃ  session ticket Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u ngay tá»« thÃ´ng Ä‘iá»‡p Ä‘áº§u tiÃªn, khÃ´ng cáº§n máº¥t thá»i gian trao Ä‘á»•i thÃ´ng Ä‘iá»‡p qua láº¡i.

### 2.3 Vai trÃ² cá»§a khÃ³a cÃ´ng khai (public key) vÃ  khÃ³a bÃ­ máº­t (private key).
- Trong SSL, khÃ³a cÃ´ng khai (public key) vÃ  khÃ³a bÃ­ máº­t (private key) lÃ  hai thÃ nh pháº§n cá»‘t lÃµi trong há»‡ thá»‘ng mÃ£ hÃ³a Ä‘Æ°á»£c sá»­ dá»¥ng cho giao tiáº¿p an toÃ n.
	- KhÃ³a cÃ´ng khai Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u.
	- KhÃ³a bÃ­ máº­t Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ giáº£i mÃ£ dá»¯ liá»‡u Ä‘Ã£ mÃ£ hÃ³a.
- ÄÃ¢y lÃ  phÆ°Æ¡ng phÃ¡p mÃ£ hÃ³a báº¥t Ä‘á»‘i xá»©ng, Ä‘áº£m báº£o ráº±ng chá»‰ ngÆ°á»i nháº­n dá»± kiáº¿n sá»Ÿ há»¯u khÃ³a bÃ­ máº­t tÆ°Æ¡ng á»©ng má»›i cÃ³ thá»ƒ giáº£i mÃ£ vÃ  truy cáº­p thÃ´ng tin. Nhá» váº­y, dá»¯ liá»‡u Ä‘Æ°á»£c báº£o vá»‡ ngay cáº£ khi truyá»n qua cÃ¡c kÃªnh khÃ´ng an toÃ n.
- KhÃ³a cÃ´ng khai (Public Key):
	- Kháº£ dá»¥ng: KhÃ³a cÃ´ng khai Ä‘Æ°á»£c chia sáº» tá»± do vÃ  sáºµn sÃ ng cho báº¥t ká»³ ai muá»‘n gá»­i dá»¯ liá»‡u Ä‘Æ°á»£c mÃ£ hÃ³a Ä‘áº¿n ngÆ°á»i sá»Ÿ há»¯u khÃ³a.
	- MÃ£ hÃ³a: KhÃ³a nÃ y Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ mÃ£ hÃ³a cÃ¡c thÃ´ng Ä‘iá»‡p hoáº·c dá»¯ liá»‡u mÃ  chá»‰ ngÆ°á»i giá»¯ khÃ³a bÃ­ máº­t tÆ°Æ¡ng á»©ng má»›i cÃ³ thá»ƒ giáº£i mÃ£ vÃ  Ä‘á»c Ä‘Æ°á»£c.
	- VÃ­ dá»¥: Náº¿u Alice muá»‘n gá»­i má»™t thÃ´ng Ä‘iá»‡p an toÃ n cho Bob, cÃ´ áº¥y sáº½ mÃ£ hÃ³a thÃ´ng Ä‘iá»‡p báº±ng khÃ³a cÃ´ng khai cá»§a Bob. Khi Bob nháº­n Ä‘Æ°á»£c thÃ´ng Ä‘iá»‡p, anh áº¥y sáº½ giáº£i mÃ£ nÃ³ báº±ng khÃ³a bÃ­ máº­t cá»§a mÃ¬nh.
- KhÃ³a bÃ­ máº­t (Private Key):
	- Báº£o máº­t: KhÃ³a bÃ­ máº­t Ä‘Æ°á»£c giá»¯ kÃ­n tuyá»‡t Ä‘á»‘i vÃ  khÃ´ng bao giá» Ä‘Æ°á»£c chia sáº». NÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ giáº£i mÃ£ dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c mÃ£ hÃ³a báº±ng khÃ³a cÃ´ng khai tÆ°Æ¡ng á»©ng.
	- Giáº£i mÃ£: ÄÃ¢y lÃ  khÃ³a duy nháº¥t cÃ³ kháº£ nÄƒng giáº£i mÃ£ dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c mÃ£ hÃ³a báº±ng khÃ³a cÃ´ng khai cá»§a nÃ³.
	- VÃ­ dá»¥: Chá»‰ Bob sá»Ÿ há»¯u khÃ³a bÃ­ máº­t tÆ°Æ¡ng á»©ng vá»›i khÃ³a cÃ´ng khai Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ mÃ£ hÃ³a thÃ´ng Ä‘iá»‡p do Alice gá»­i.
	- ![images](./images/s-1.png)

## 3. Chá»©ng chá»‰ SSL (SSL Certificate)
### 3.1 KhÃ¡i niá»‡m vÃ  má»¥c Ä‘Ã­ch 
- SSL/TLS Certificate hay Chá»©ng chá»‰ SSL/TLS lÃ  má»™t Ä‘á»‘i tÆ°á»£ng sá»‘ cho phÃ©p cÃ¡c há»‡ thá»‘ng xÃ¡c minh danh tÃ­nh vÃ  thiáº¿t láº­p káº¿t ná»‘i máº¡ng Ä‘Æ°á»£c mÃ£ hÃ³a vá»›i má»™t há»‡ thá»‘ng khÃ¡c thÃ´ng qua giao thá»©c SSL/TLS (Secure Sockets Layer/Transport Layer Security).
- CÃ¡c chá»©ng chá»‰ nÃ y hoáº¡t Ä‘á»™ng trong má»™t há»‡ thá»‘ng máº­t mÃ£ gá»i lÃ  cÆ¡ sá»Ÿ háº¡ táº§ng khÃ³a cÃ´ng khai (PKI â€“ Public Key Infrastructure). PKI cho phÃ©p má»™t bÃªn xÃ¡c minh danh tÃ­nh cá»§a bÃªn kia náº¿u cáº£ hai cÃ¹ng tin tÆ°á»Ÿng vÃ o má»™t bÃªn thá»© ba â€“ gá»i lÃ  tá»• chá»©c chá»©ng thá»±c (Certificate Authority â€“ CA).
- Chá»©ng chá»‰ SSL/TLS Ä‘Ã³ng vai trÃ² nhÆ° má»™t tháº» cÄƒn cÆ°á»›c sá»‘, giÃºp báº£o vá»‡ cÃ¡c káº¿t ná»‘i máº¡ng, xÃ¡c thá»±c danh tÃ­nh cá»§a cÃ¡c website trÃªn Internet cÅ©ng nhÆ° cÃ¡c tÃ i nguyÃªn trong máº¡ng ná»™i bá»™.
- Lá»£i Ã­ch cá»§a chá»©ng chá»‰ SSL/TLS:
	- Báº£o vá»‡ dá»¯ liá»‡u cÃ¡ nhÃ¢n: TrÃ¬nh duyá»‡t kiá»ƒm tra chá»©ng chá»‰ SSL/TLS trÆ°á»›c khi cho phÃ©p káº¿t ná»‘i báº£o máº­t. CÃ´ng nghá»‡ nÃ y giÃºp mÃ£ hÃ³a toÃ n bá»™ thÃ´ng tin giá»¯a ngÆ°á»i dÃ¹ng vÃ  mÃ¡y chá»§ web.
	- TÄƒng Ä‘á»™ tin cáº­y vá»›i khÃ¡ch hÃ ng: NgÆ°á»i dÃ¹ng hiá»ƒu biáº¿t vá» Internet quan tÃ¢m Ä‘áº¿n quyá»n riÃªng tÆ° vÃ  tin tÆ°á»Ÿng hÆ¡n vÃ o cÃ¡c website cÃ³ biá»ƒu tÆ°á»£ng á»• khÃ³a xanh. SSL/TLS giÃºp kháº³ng Ä‘á»‹nh ráº±ng dá»¯ liá»‡u cá»§a há» Ä‘ang Ä‘Æ°á»£c báº£o vá»‡.
	- TuÃ¢n thá»§ quy Ä‘á»‹nh phÃ¡p lÃ½: Má»™t sá»‘ ngÃ nh, nhÆ° ngÃ nh thanh toÃ¡n, báº¯t buá»™c pháº£i tuÃ¢n thá»§ cÃ¡c quy Ä‘á»‹nh báº£o máº­t nhÆ° PCI DSS â€“ trong Ä‘Ã³ yÃªu cáº§u cÃ i chá»©ng chá»‰ SSL/TLS Ä‘á»ƒ Ä‘áº£m báº£o giao dá»‹ch an toÃ n.
	- Cáº£i thiá»‡n thá»© háº¡ng SEO: CÃ¡c cÃ´ng cá»¥ tÃ¬m kiáº¿m lá»›n xem SSL/TLS lÃ  yáº¿u tá»‘ Ä‘Ã¡nh giÃ¡ xáº¿p háº¡ng. Website Ä‘Æ°á»£c báº£o máº­t báº±ng SSL/TLS thÆ°á»ng cÃ³ vá»‹ trÃ­ cao hÆ¡n so vá»›i website khÃ´ng cÃ³ báº£o vá»‡, tá»« Ä‘Ã³ thu hÃºt nhiá»u lÆ°á»£t truy cáº­p hÆ¡n.
- XÃ¡c thá»±c vÃ  thá»i háº¡n cá»§a chá»©ng chá»‰ 
	- CÆ¡ quan cáº¥p chá»©ng chá»‰ (CA â€“ Certificate Authority) lÃ  tá»• chá»©c chuyÃªn cung cáº¥p cÃ¡c chá»©ng chá»‰ SSL/TLS cho chá»§ sá»Ÿ há»¯u trang web, cÃ´ng ty lÆ°u trá»¯ web hoáº·c doanh nghiá»‡p. CA sáº½ xÃ¡c minh thÃ´ng tin tÃªn miá»n vÃ  ngÆ°á»i sá»Ÿ há»¯u trÆ°á»›c khi cáº¥p chá»©ng chá»‰ SSL/TLS.
	- Chá»©ng chá»‰ SSL/TLS hiá»‡n cÃ³ thá»i háº¡n tá»‘i Ä‘a lÃ  13 thÃ¡ng. Trong nhá»¯ng nÄƒm qua, thá»i háº¡n nÃ y Ä‘Ã£ dáº§n Ä‘Æ°á»£c rÃºt ngáº¯n nháº±m giáº£m thiá»ƒu rá»§i ro báº£o máº­t cho doanh nghiá»‡p vÃ  ngÆ°á»i dÃ¹ng web. VÃ­ dá»¥, bÃªn thá»© ba khÃ´ng Ä‘Ã¡ng tin cÃ³ thá»ƒ táº­n dá»¥ng chá»©ng chá»‰ váº«n cÃ²n hiá»‡u lá»±c cá»§a má»™t tÃªn miá»n Ä‘Ã£ háº¿t háº¡n Ä‘á»ƒ táº¡o ra má»™t trang web trÃ¡i phÃ©p.
	- Viá»‡c rÃºt ngáº¯n thá»i gian hiá»‡u lá»±c sáº½ giÃºp háº¡n cháº¿ kháº£ nÄƒng bá»‹ láº¡m dá»¥ng. Khi chá»©ng chá»‰ SSL/TLS háº¿t háº¡n, trÃ¬nh duyá»‡t sáº½ cáº£nh bÃ¡o ngÆ°á»i dÃ¹ng ráº±ng trang web khÃ´ng cÃ²n an toÃ n. Do Ä‘Ã³, tá»• chá»©c cáº§n thu há»“i chá»©ng chá»‰ cÅ© vÃ  thay tháº¿ báº±ng chá»©ng chá»‰ má»›i Ä‘Æ°á»£c gia háº¡n. QuÃ¡ trÃ¬nh gia háº¡n nÃ y cáº§n hoÃ n táº¥t trÆ°á»›c khi chá»©ng chá»‰ hiá»‡n táº¡i háº¿t háº¡n Ä‘á»ƒ trÃ¡nh cÃ¡c sá»± cá»‘ báº£o máº­t.

### 3.2 CÃ¡c loáº¡i chá»©ng chá»‰ SSL:
#### 3.2.1 Theo cáº¥p Ä‘á»™ xÃ¡c thá»±c 
- Má»¥c Ä‘Ã­ch chÃ­nh cá»§a chá»©ng chá»‰ SSL lÃ  nháº±m xÃ¡c minh danh tÃ­nh mÃ¡y chá»§ trÃªn máº¡ng 
- Äá»ƒ thá»±c hiá»‡n Ä‘iá»u Ä‘Ã³, má»—i chá»©ng chá»‰ chá»©a thÃ´ng tin vá» thá»±c thá»ƒ Ä‘Æ°á»£c cáº¥p chá»©ng chá»‰. Má»©c Ä‘á»™ chi tiáº¿t cá»§a thÃ´ng tin phá»¥ thuá»™c vÃ o cáº¥p Ä‘á»™ xÃ¡c thá»±c cá»§a chá»©ng chá»‰. SSL cÃ³ ba cáº¥p Ä‘á»™ xÃ¡c thá»±c.
	- DV (Domain Validation) 
		- XÃ¡c thá»±c tÃªn miá»n (Domain Validation) lÃ  cáº¥p Ä‘á»™ xÃ¡c thá»±c nháº¹ nháº¥t trong cÃ¡c loáº¡i chá»©ng chá»‰ SSL. Vá»›i chá»©ng chá»‰ DV, Ä‘iá»u duy nháº¥t Ä‘Æ°á»£c xÃ¡c thá»±c vá» danh tÃ­nh cá»§a ngÆ°á»i sá»Ÿ há»¯u chá»©ng chá»‰ lÃ  há» thá»±c sá»± cÃ³ quyá»n kiá»ƒm soÃ¡t tÃªn miá»n mÃ  chá»©ng chá»‰ Ä‘Æ°á»£c cáº¥p cho.
		- Æ¯u Ä‘iá»ƒm chÃ­nh cá»§a chá»©ng chá»‰ DV lÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c cáº¥p trong vÃ i phÃºt. Chá»©ng chá»‰ DV Ä‘Æ°á»£c khuyáº¿n nghá»‹ sá»­ dá»¥ng trong cÃ¡c trÆ°á»ng há»£p chá»‰ cáº§n mÃ£ hÃ³a hoáº·c yÃªu cáº§u cÃ³ chá»©ng chá»‰, nhÆ°ng khÃ´ng pháº£i má»¥c tiÃªu cá»§a cÃ¡c cuá»™c táº¥n cÃ´ng lá»«a Ä‘áº£o vÃ  khÃ´ng Ä‘Ã²i há»i pháº£i táº¡o dá»±ng sá»± tin tÆ°á»Ÿng Ä‘áº·c biá»‡t vá»›i ngÆ°á»i truy cáº­p trang web.
	- OV (Organization Validation)
		- XÃ¡c thá»±c tá»• chá»©c lÃ  cáº¥p Ä‘á»™ xÃ¡c thá»±c trung bÃ¬nh trong cÃ¡c loáº¡i chá»©ng chá»‰ SSL. Chá»©ng chá»‰ OV Ä‘Æ°a ra tuyÃªn bá»‘ vá» danh tÃ­nh cá»§a tá»• chá»©c Ä‘Æ°á»£c cáº¥p chá»©ng chá»‰ vÃ  nÆ¡i tá»• chá»©c Ä‘Ã³ hoáº¡t Ä‘á»™ng.
		- Viá»‡c xÃ¡c thá»±c OV chá»§ yáº¿u do tá»«ng tá»• chá»©c cáº¥p chá»©ng chá»‰ (CA) quyáº¿t Ä‘á»‹nh. Máº·c dÃ¹ chá»©ng chá»‰ nÃ y cung cáº¥p thÃ´ng tin vá» danh tÃ­nh tá»• chá»©c, nhÆ°ng do quy trÃ¬nh xÃ¡c thá»±c khÃ´ng Ä‘Æ°á»£c thá»±c hiá»‡n vÃ  kiá»ƒm toÃ¡n á»Ÿ má»™t tiÃªu chuáº©n chung toÃ n cáº§u nÃªn cÃ¡c trÃ¬nh duyá»‡t phá»• biáº¿n khÃ´ng hiá»ƒn thá»‹ tÃªn cÃ´ng ty trong thanh Ä‘á»‹a chá»‰.
	- EV (Extended Validation)
		- XÃ¡c thá»±c má»Ÿ rá»™ng (Extended Validation â€“ EV) lÃ  cáº¥p Ä‘á»™ xÃ¡c thá»±c SSL cao nháº¥t. Danh tÃ­nh cá»§a chá»§ sá»Ÿ há»¯u chá»©ng chá»‰ EV Ä‘Æ°á»£c xÃ¡c minh theo má»™t bá»™ giao thá»©c tiÃªu chuáº©n, Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ lÃ  cÃ³ Ä‘á»™ tin cáº­y cao vÃ  Ä‘Ã£ Ä‘Æ°á»£c kiá»ƒm chá»©ng qua thá»±c tiá»…n sá»­ dá»¥ng rá»™ng rÃ£i.
		- VÃ¬ má»©c Ä‘á»™ tin tÆ°á»Ÿng cao Ä‘á»‘i vá»›i thÃ´ng tin trong loáº¡i chá»©ng chá»‰ nÃ y, háº§u háº¿t cÃ¡c trÃ¬nh duyá»‡t phá»• biáº¿n Ä‘á»u hiá»ƒn thá»‹ biá»ƒu tÆ°á»£ng tin cáº­y mÃ u xanh lÃ¡ (thanh Ä‘á»‹a chá»‰ mÃ u xanh), kÃ¨m theo tÃªn cá»§a tá»• chá»©c á»Ÿ bÃªn trÃ¡i Ä‘Æ°á»ng dáº«n URL. Nhiá»u trÃ¬nh duyá»‡t cÃ²n cung cáº¥p thÃªm thÃ´ng tin nhÆ° thÃ nh phá»‘ nÆ¡i tá»• chá»©c hoáº¡t Ä‘á»™ng vÃ  tÃªn cá»§a cÆ¡ quan cáº¥p chá»©ng chá»‰.
		- Chá»©ng chá»‰ EV Ä‘Æ°á»£c khuyáº¿n nghá»‹ sá»­ dá»¥ng cho cÃ¡c á»©ng dá»¥ng cáº§n tá»‘i Ä‘a hÃ³a giao dá»‹ch hoáº·c xÃ¢y dá»±ng lÃ²ng tin vá»›i ngÆ°á»i dÃ¹ng, cÃ¡c á»©ng dá»¥ng xá»­ lÃ½ thÃ´ng tin giÃ¡ trá»‹ cao nhÆ° dá»¯ liá»‡u nháº­n dáº¡ng cÃ¡ nhÃ¢n (PII) hoáº·c sá»‘ tháº» tÃ­n dá»¥ng, hay cÃ¡c á»©ng dá»¥ng yÃªu cáº§u tuÃ¢n thá»§ tiÃªu chuáº©n cáº§n EV. EV hiá»‡n lÃ  chuáº©n máº·c Ä‘á»‹nh cho cÃ¡c doanh nghiá»‡p trá»±c tuyáº¿n nhÆ° ngÃ¢n hÃ ng, cá»­a hÃ ng, sÃ n giao dá»‹ch, cá»•ng khai thuáº¿, dá»‹ch vá»¥ y táº¿ vÃ  cÃ¡c tÃ i khoáº£n máº¡ng xÃ£ há»™i.
#### 3.2.2 Theo pháº¡m vi báº£o vá»‡
- Máº·c dÃ¹ má»—i tÃªn miá»n cá»¥ thá»ƒ cáº§n Ä‘Æ°á»£c báº£o vá»‡ báº±ng chá»©ng chá»‰ SSL Ä‘á»ƒ kÃ­ch hoáº¡t mÃ£ hÃ³a vÃ  cÃ¡c chá»‰ bÃ¡o tin cáº­y trÃªn trÃ¬nh duyá»‡t, nhÆ°ng váº«n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c loáº¡i chá»©ng chá»‰ cÃ³ thá»ƒ báº£o vá»‡ nhiá»u tÃªn miá»n cÃ¹ng lÃºc.
- XÃ©t vá» pháº¡m vi báº£o vá»‡ tÃªn miá»n, chá»©ng chá»‰ SSL Ä‘Æ°á»£c chia thÃ nh ba loáº¡i.
	- Basic SSL certificates
		- Chá»©ng chá»‰ SSL cÆ¡ báº£n chá»‰ báº£o vá»‡ má»™t tÃªn miá»n hoáº·c tÃªn miá»n phá»¥. Muá»‘n báº£o vá»‡ nhiá»u tÃªn miá»n, báº¡n cáº§n nhiá»u chá»©ng chá»‰ tÆ°Æ¡ng á»©ng. Tuy nhiÃªn, pháº§n lá»›n CA sáº½ cáº¥p chá»©ng chá»‰ cho cáº£ www.domain.com vÃ  domain.com trong cÃ¹ng má»™t chá»©ng chá»‰.
		- Chá»©ng chá»‰ cÆ¡ báº£n cÃ³ thá»ƒ Ã¡p dá»¥ng á»Ÿ cáº£ 3 má»©c xÃ¡c thá»±c: DV, OV, vÃ  EV. DÃ¹ báº£o máº­t tá»‘t, nhÆ°ng sá»­ dá»¥ng nhiá»u chá»©ng chá»‰ riÃªng láº» sáº½ tá»‘n cÃ´ng quáº£n lÃ½ hÆ¡n, Ä‘áº·c biá»‡t trong há»‡ thá»‘ng phá»©c táº¡p.
	- Wildcard SSL certificates 
		- Chá»©ng chá»‰ SSL Wildcard cÃ³ thá»ƒ báº£o vá»‡ nhiá»u tÃªn miá»n phá»¥ dÆ°á»›i má»™t tÃªn miá»n gá»‘c chÃ­nh. 
		- VÃ­ dá»¥, má»™t chá»©ng chá»‰ wildcard cho domain.com sáº½ báº£o vá»‡ Ä‘Æ°á»£c cÃ¡c tÃªn miá»n nhÆ°:
			- www.domain.com
			- login.domain.com
			- cart.domain.com
			- ftp.domain.com
		- vÃ  báº¥t ká»³ tÃªn miá»n phá»¥ nÃ o khÃ¡c cá»§a domain.com. Trong trÆ°á»ng há»£p nÃ y, tÃªn miá»n gá»‘c domain.com cÅ©ng sáº½ Ä‘Æ°á»£c báº£o vá»‡.
		- Wildcard cÅ©ng cÃ³ thá»ƒ Ã¡p dá»¥ng cho má»™t tÃªn miá»n phá»¥ cá»¥ thá»ƒ, tá»« Ä‘Ã³ báº£o vá»‡ cÃ¡c tÃªn miá»n con sÃ¢u hÆ¡n. VÃ­ dá»¥, má»™t chá»©ng chá»‰ wildcard cho shop.domain.com sáº½ Ã¡p dá»¥ng Ä‘Æ°á»£c cho:
			- a.shop.domain.com
			- b.shop.domain.com
		- Tuy nhiÃªn, má»™t wildcard khÃ´ng thá»ƒ Ã¡p dá»¥ng cho nhiá»u tÃªn miá»n gá»‘c khÃ¡c nhau. VÃ­ dá»¥, wildcard cá»§a domain.com sáº½ khÃ´ng thá»ƒ báº£o vá»‡ example.com hoáº·c báº¥t ká»³ tÃªn miá»n phá»¥ nÃ o cá»§a nÃ³. TÆ°Æ¡ng tá»±, wildcard cho shop.domain.com sáº½ khÃ´ng hoáº¡t Ä‘á»™ng vá»›i checkout.domain.com.
		- Wildcard thuáº­n tiá»‡n hÆ¡n Ä‘Ã¡ng ká»ƒ trong viá»‡c cáº¥p phÃ¡t vÃ  quáº£n lÃ½ náº¿u báº¡n cÃ³ nhiá»u tÃªn miá»n phá»¥. CÃ³ thá»ƒ táº¡o thÃªm cÃ¡c tÃªn miá»n phá»¥ má»›i sau khi chá»©ng chá»‰ Ä‘Æ°á»£c phÃ¡t hÃ nh mÃ  váº«n sá»­ dá»¥ng cÃ¹ng chá»©ng chá»‰ Ä‘Ã³.
		- Chá»©ng chá»‰ Wildcard cÃ³ thá»ƒ Ä‘Æ°á»£c cáº¥p á»Ÿ má»©c DV (Domain Validation) vÃ  OV (Organization Validation). Tuy nhiÃªn, theo tiÃªu chuáº©n hiá»‡n hÃ nh, khÃ´ng Ä‘Æ°á»£c phÃ©p cáº¥p chá»©ng chá»‰ Wildcard á»Ÿ má»©c EV (Extended Validation). VÃ¬ váº­y, vá»›i cÃ¡c website hÆ°á»›ng tá»›i cÃ´ng chÃºng yÃªu cáº§u Ä‘á»™ tin cáº­y cao (nhÆ° trang thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­ cÃ³ cÃ¡c tÃªn miá»n phá»¥ nhÆ° www., shop., checkout.), nÃªn cÃ¢n nháº¯c dÃ¹ng chá»©ng chá»‰ Ä‘a miá»n EV.
	- Multi-domain or SAN certificates 
		- Chá»©ng chá»‰ Ä‘a miá»n (Multi-domain) hoáº·c SAN cho phÃ©p má»™t chá»©ng chá»‰ duy nháº¥t báº£o vá»‡ tá»‘i Ä‘a 100 tÃªn miá»n cá»¥ thá»ƒ. KhÃ´ng giá»‘ng nhÆ° chá»©ng chá»‰ wildcard, chá»©ng chá»‰ Ä‘a miá»n cÃ³ thá»ƒ báº£o vá»‡ báº¥t ká»³ táº­p há»£p tÃªn miá»n nÃ o báº±ng cÃ¹ng má»™t chá»©ng chá»‰. VÃ­ dá»¥, má»™t chá»©ng chá»‰ Ä‘a miá»n cÃ³ thá»ƒ báº£o vá»‡:
			- www.domain.com
			- ftp.domain.net
			- shop.domain.com
			- a.shop.domain.mobi
			- www.example.com
			- login.example.com
		- Chá»©ng chá»‰ Ä‘a miá»n cÃ³ thá»ƒ Ä‘Æ°á»£c cáº¥p á»Ÿ cÃ¡c má»©c xÃ¡c thá»±c DV, OV vÃ  EV. Má»—i tÃªn miá»n bá»• sung Ä‘Æ°á»£c báº£o vá»‡ trong chá»©ng chá»‰ Ä‘a miá»n Ä‘Æ°á»£c gá»i lÃ  SAN (Subject Alternative Name). CÃ¡c chá»©ng chá»‰ cÃ³ SAN Ä‘Ã´i khi Ä‘Æ°á»£c gá»i lÃ  chá»©ng chá»‰ SAN thay vÃ¬ chá»©ng chá»‰ Ä‘a miá»n, nhÆ°ng cáº£ hai thuáº­t ngá»¯ Ä‘á»u mang cÃ¹ng má»™t Ã½ nghÄ©a.
		- Chá»©ng chá»‰ Ä‘a miá»n cÃ³ thá»ƒ thuáº­n tiá»‡n hÆ¡n so vá»›i chá»©ng chá»‰ cÆ¡ báº£n trong cÃ¡c mÃ´i trÆ°á»ng phá»©c táº¡p. Tuy nhiÃªn, vÃ¬ nhiá»u tÃªn miá»n Ä‘Æ°á»£c báº£o vá»‡ bá»Ÿi má»™t chá»©ng chá»‰ duy nháº¥t, nÃªn chÃºng khÃ´ng Ä‘Æ°á»£c khuyáº¿n nghá»‹ cho cÃ¡c mÃ´i trÆ°á»ng nháº¡y cáº£m Ä‘Ã²i há»i má»©c Ä‘á»™ báº£o máº­t cao nháº¥t. Do chá»©ng chá»‰ Ä‘a miá»n cÃ³ thá»ƒ Ä‘Æ°á»£c phÃ¡t hÃ nh á»Ÿ má»©c xÃ¡c thá»±c má»Ÿ rá»™ng (EV), chÃºng lÃ  lá»±a chá»n phÃ¹ há»£p cho cÃ¡c trang web doanh nghiá»‡p hÆ°á»›ng Ä‘áº¿n ngÆ°á»i dÃ¹ng cÃ³ nhiá»u tÃªn miá»n phá»¥, cháº³ng háº¡n nhÆ° cÃ¡c trang bÃ¡n láº» trá»±c tuyáº¿n.
#### 3.2.3 Theo nguá»“n cáº¥p 
- NgoÃ i viá»‡c phÃ¢n loáº¡i chá»©ng chá»‰ SSL theo pháº¡m vi báº£o vá»‡ tÃªn miá»n (cÆ¡ báº£n, wildcard, Ä‘a miá»n) vÃ  cáº¥p Ä‘á»™ xÃ¡c thá»±c (DV, OV, EV), chá»©ng chá»‰ SSL cÃ²n Ä‘Æ°á»£c phÃ¢n loáº¡i dá»±a trÃªn nguá»“n cáº¥p phÃ¡t
	- Chá»©ng chá»‰ tá»± kÃ½ (Self-Signed Certificates):
		- ÄÆ°á»£c táº¡o vÃ  kÃ½ bá»Ÿi chÃ­nh thá»±c thá»ƒ sá»­ dá»¥ng chá»©ng chá»‰ (vÃ­ dá»¥: chá»§ sá»Ÿ há»¯u website).
		- KhÃ´ng Ä‘Æ°á»£c cÃ¡c trÃ¬nh duyá»‡t hoáº·c há»‡ thá»‘ng tin tÆ°á»Ÿng máº·c Ä‘á»‹nh.
		- YÃªu cáº§u thiáº¿t láº­p tin cáº­y thá»§ cÃ´ng (vÃ­ dá»¥: thÃªm chá»©ng chá»‰ vÃ o danh sÃ¡ch tin cáº­y).
		- ThÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng cho kiá»ƒm thá»­ ná»™i bá»™, phÃ¡t triá»ƒn hoáº·c máº¡ng riÃªng â€” nÆ¡i má»©c Ä‘á»™ tin cáº­y khÃ´ng quÃ¡ quan trá»ng.
		- KhÃ´ng tráº£i qua quy trÃ¬nh xÃ¡c thá»±c cá»§a tá»• chá»©c cáº¥p chá»©ng chá»‰ (CA).
		- Tiá»m áº©n rá»§i ro báº£o máº­t do thiáº¿u xÃ¡c thá»±c tá»« bÃªn thá»© ba.
	- Chá»©ng chá»‰ do CA cáº¥p (CA-Signed Certificates):
		- ÄÆ°á»£c táº¡o vÃ  kÃ½ bá»Ÿi má»™t tá»• chá»©c cáº¥p chá»©ng chá»‰ Ä‘Ã¡ng tin cáº­y (CA).
		- ÄÆ°á»£c háº§u háº¿t cÃ¡c trÃ¬nh duyá»‡t vÃ  há»‡ thá»‘ng tin tÆ°á»Ÿng tá»± Ä‘á»™ng.
		- Tráº£i qua quy trÃ¬nh xÃ¡c thá»±c bá»Ÿi CA.
		- ÄÆ°á»£c Æ°u tiÃªn sá»­ dá»¥ng cho cÃ¡c website vÃ  á»©ng dá»¥ng hÆ°á»›ng ra cÃ´ng chÃºng nhá» má»©c Ä‘á»™ tin cáº­y cao.
		- Cung cáº¥p sá»± Ä‘áº£m báº£o vá» danh tÃ­nh cá»§a website.
		- CÃ³ thá»ƒ bá»‹ thu há»“i bá»Ÿi CA khi cáº§n thiáº¿t.


### 3.3 MÃ£ hÃ³a trong SSL/TLS:
- MÃ£ hÃ³a (Encryption) lÃ  quÃ¡ trÃ¬nh chuyá»ƒn Ä‘á»•i thÃ´ng tin tá»« dáº¡ng ban Ä‘áº§u thÃ nh dáº¡ng khÃ´ng Ä‘á»c Ä‘Æ°á»£c báº±ng cÃ¡ch sá»­ dá»¥ng thuáº­t toÃ¡n vÃ  khÃ³a máº­t mÃ£.
`Dá»¯ liá»‡u + KhÃ³a >>> Thuáº­t toÃ¡n mÃ£ hÃ³a >>> Dá»¯ liá»‡u Ä‘Æ°á»£c mÃ£ hÃ³a`
- Giáº£i mÃ£ (Decryption)lÃ  quÃ¡ trÃ¬nh chuyá»ƒn dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c mÃ£ hÃ³a trá»Ÿ láº¡i dÆ°á»›i dáº¡ng thÃ´ng tin cÃ³ thá»ƒ Ä‘á»c Ä‘Æ°á»£c
`Dá»¯ liá»‡u Ä‘Æ°á»£c mÃ£ hÃ³a + KhÃ³a >>> Thuáº­t toÃ¡n giáº£i mÃ£ >>> Dá»¯ liá»‡u`
- MÃ£ hÃ³a SSL/TLS thiáº¿t láº­p má»™t káº¿t ná»‘i an toÃ n vÃ  Ä‘Æ°á»£c mÃ£ hÃ³a giá»¯a mÃ¡y khÃ¡ch (nhÆ° trÃ¬nh duyá»‡t web) vÃ  mÃ¡y chá»§ (nhÆ° má»™t trang web) báº±ng cÃ¡ch sá»­ dá»¥ng káº¿t há»£p giá»¯a mÃ£ hÃ³a báº¥t Ä‘á»‘i xá»©ng vÃ  Ä‘á»‘i xá»©ng. Äiá»u nÃ y ngÄƒn cháº·n cÃ¡c bÃªn khÃ´ng Ä‘Æ°á»£c phÃ©p Ä‘á»c hoáº·c can thiá»‡p vÃ o dá»¯ liá»‡u Ä‘Æ°á»£c truyá»n trong suá»‘t phiÃªn lÃ m viá»‡c Ä‘Ã³.
	- BÆ°á»›c 1: MÃ£ hÃ³a báº¥t Ä‘á»‘i xá»©ng (Asymmetric Encryption):	Khi trÃ¬nh duyá»‡t (client) káº¿t ná»‘i Ä‘áº¿n mÃ¡y chá»§ (server), mÃ¡y chá»§ gá»­i chá»©ng chá»‰ sá»‘ chá»©a khÃ³a cÃ´ng khai. TrÃ¬nh duyá»‡t xÃ¡c minh chá»©ng chá»‰ nÃ y thÃ´ng qua má»™t Tá»• chá»©c cáº¥p chá»©ng chá»‰ (CA) trong há»‡ thá»‘ng PKI. Sau Ä‘Ã³, trÃ¬nh duyá»‡t sá»­ dá»¥ng khÃ³a cÃ´ng khai nÃ y Ä‘á»ƒ mÃ£ hÃ³a má»™t khÃ³a phiÃªn (session key) vÃ  gá»­i láº¡i cho mÃ¡y chá»§.
	- BÆ°á»›c 2: MÃ£ hÃ³a Ä‘á»‘i xá»©ng (Symmetric Encryption): MÃ¡y chá»§ sá»­ dá»¥ng khÃ³a riÃªng tÆ° Ä‘á»ƒ giáº£i mÃ£ khÃ³a phiÃªn. Tá»« thá»i Ä‘iá»ƒm Ä‘Ã³, cáº£ hai bÃªn sá»­ dá»¥ng khÃ³a phiÃªn Ä‘á»‘i xá»©ng nÃ y Ä‘á»ƒ mÃ£ hÃ³a vÃ  giáº£i mÃ£ dá»¯ liá»‡u truyá»n Ä‘i â€” vÃ¬ mÃ£ hÃ³a Ä‘á»‘i xá»©ng nhanh hÆ¡n vÃ  hiá»‡u quáº£ hÆ¡n cho truyá»n dá»¯ liá»‡u liÃªn tá»¥c.
- VÃ­ dá»¥ quy trÃ¬nh giao tiáº¿p giá»¯a client-server 
	- MÃ¡y khÃ¡ch liÃªn há»‡ vá»›i mÃ¡y chá»§ báº±ng má»™t URL báº£o máº­t (HTTPSâ€¦).
	- MÃ¡y chá»§ gá»­i cho mÃ¡y khÃ¡ch chá»©ng chá»‰ vÃ  khÃ³a cÃ´ng khai cá»§a mÃ¬nh.
	- MÃ¡y khÃ¡ch xÃ¡c minh chá»©ng chá»‰ nÃ y vá»›i má»™t Tá»• chá»©c chá»©ng thá»±c gá»‘c Ä‘Ã¡ng tin cáº­y Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh há»£p lá»‡.
	- MÃ¡y khÃ¡ch vÃ  mÃ¡y chá»§ Ä‘Ã m phÃ¡n loáº¡i mÃ£ hÃ³a máº¡nh nháº¥t mÃ  cáº£ hai bÃªn há»— trá»£.
	- MÃ¡y khÃ¡ch mÃ£ hÃ³a má»™t khÃ³a phiÃªn (bÃ­ máº­t) báº±ng khÃ³a cÃ´ng khai cá»§a mÃ¡y chá»§ vÃ  gá»­i láº¡i cho mÃ¡y chá»§.
	- MÃ¡y chá»§ sá»­ dá»¥ng khÃ³a riÃªng Ä‘á»ƒ giáº£i mÃ£ thÃ´ng tin tá»« mÃ¡y khÃ¡ch vÃ  thiáº¿t láº­p phiÃªn káº¿t ná»‘i.
	- KhÃ³a phiÃªn (mÃ£ hÃ³a Ä‘á»‘i xá»©ng) giá» Ä‘Ã¢y Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ£ hÃ³a vÃ  giáº£i mÃ£ dá»¯ liá»‡u truyá»n giá»¯a mÃ¡y khÃ¡ch vÃ  mÃ¡y chá»§.
#### 3.3.1 MÃ£ hÃ³a Ä‘á»‘i xá»©ng (Symmetric Encryption).
- MÃ£ hÃ³a Ä‘á»‘i xá»©ng (hay mÃ£ hÃ³a báº±ng khÃ³a chia sáº» trÆ°á»›c) sá»­ dá»¥ng má»™t khÃ³a duy nháº¥t Ä‘á»ƒ mÃ£ hÃ³a vÃ  giáº£i mÃ£ dá»¯ liá»‡u. Cáº£ ngÆ°á»i gá»­i vÃ  ngÆ°á»i nháº­n Ä‘á»u cáº§n cÃ³ cÃ¹ng má»™t khÃ³a Ä‘á»ƒ giao tiáº¿p.
- KÃ­ch thÆ°á»›c khÃ³a Ä‘á»‘i xá»©ng thÆ°á»ng lÃ  128 hoáº·c 256 bit â€” khÃ³a cÃ ng dÃ i thÃ¬ cÃ ng khÃ³ bá»‹ phÃ¡ vá»¡.
- Viá»‡c sá»­ dá»¥ng khÃ³a 128 hay 256 bit phá»¥ thuá»™c vÃ o kháº£ nÄƒng mÃ£ hÃ³a cá»§a cáº£ mÃ¡y chá»§ vÃ  pháº§n má»m phÃ­a mÃ¡y khÃ¡ch. Chá»©ng chá»‰ TLS/SSL khÃ´ng quyáº¿t Ä‘á»‹nh kÃ­ch thÆ°á»›c khÃ³a Ä‘Æ°á»£c sá»­ dá»¥ng.
- PhÆ°Æ¡ng phÃ¡p nÃ y cÃ³ tá»‘c Ä‘á»™ xá»­ lÃ½ nhanh vÃ  thÆ°á»ng dÃ¹ng Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u trong suá»‘t phiÃªn lÃ m viá»‡c sau khi khÃ³a Ä‘Æ°á»£c trao Ä‘á»•i an toÃ n. Tuy nhiÃªn, Ä‘iá»ƒm yáº¿u cá»§a nÃ³ lÃ  viá»‡c phÃ¢n phá»‘i khÃ³a â€” náº¿u khÃ³a bá»‹ lá»™, toÃ n bá»™ dá»¯ liá»‡u cÃ³ thá»ƒ bá»‹ giáº£i mÃ£.
- ![images](./images/symmetric-encryption.png)
#### 3.3.2 MÃ£ hÃ³a báº¥t Ä‘á»‘i xá»©ng (Asymmetric Encryption).
- MÃ£ hÃ³a báº¥t Ä‘á»‘i xá»©ng, cÃ²n Ä‘Æ°á»£c gá»i lÃ  Máº­t mÃ£ khÃ³a cÃ´ng khai sá»­ dá»¥ng hai khÃ³a riÃªng biá»‡t Ä‘á»ƒ mÃ£ hÃ³a vÃ  giáº£i mÃ£. Vá»›i mÃ£ hÃ³a báº¥t Ä‘á»‘i xá»©ng, báº¥t ká»³ ai cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng khÃ³a cÃ´ng khai Ä‘á»ƒ mÃ£ hÃ³a má»™t thÃ´ng Ä‘iá»‡p. Tuy nhiÃªn, khÃ³a giáº£i mÃ£ Ä‘Æ°á»£c giá»¯ bÃ­ máº­t. Nhá» Ä‘Ã³, chá»‰ ngÆ°á»i nháº­n dá»± kiáº¿n má»›i cÃ³ thá»ƒ giáº£i mÃ£ thÃ´ng Ä‘iá»‡p.
- Thuáº­t toÃ¡n mÃ£ hÃ³a báº¥t Ä‘á»‘i xá»©ng phá»• biáº¿n nháº¥t lÃ  RSA. RSA lÃ  viáº¿t táº¯t cá»§a Ron Rivest, Adi Shamir vÃ  Leonard Adleman â€” nhá»¯ng ngÆ°á»i Ä‘áº§u tiÃªn cÃ´ng bá»‘ thuáº­t toÃ¡n nÃ y vÃ o nÄƒm 1977. CÃ¡c khÃ³a báº¥t Ä‘á»‘i xá»©ng thÆ°á»ng cÃ³ Ä‘á»™ dÃ i 1024 hoáº·c 2048 bit. Tuy nhiÃªn, cÃ¡c khÃ³a nhá» hÆ¡n 2048 bit hiá»‡n khÃ´ng cÃ²n Ä‘Æ°á»£c xem lÃ  an toÃ n. KhÃ³a 2048 bit cÃ³ hÃ ng loáº¡t mÃ£ hÃ³a duy nháº¥t vá»›i Ä‘á»™ dÃ i lÃªn tá»›i 617 chá»¯ sá»‘.
- DÃ¹ cÃ³ thá»ƒ táº¡o ra cÃ¡c khÃ³a lá»›n hÆ¡n, nhÆ°ng gÃ¡nh náº·ng tÃ­nh toÃ¡n tÄƒng lÃªn Ä‘Ã¡ng ká»ƒ khiáº¿n cÃ¡c khÃ³a lá»›n hÆ¡n 2048 bit hiáº¿m khi Ä‘Æ°á»£c sá»­ dá»¥ng. Äá»ƒ dá»… hÃ¬nh dung, má»™t mÃ¡y tÃ­nh trung bÃ¬nh sáº½ máº¥t hÆ¡n 14 tá»· nÄƒm Ä‘á»ƒ phÃ¡ vá»¡ má»™t chá»©ng chá»‰ 2048 bit.
- ![images](./images/asymmetric-encryption.png)

| TiÃªu chÃ­                    | MÃ£ hÃ³a Ä‘á»‘i xá»©ng                         | MÃ£ hÃ³a báº¥t Ä‘á»‘i xá»©ng                           |
| --------------------------- | --------------------------------------- | --------------------------------------------- |
| **Sá»‘ lÆ°á»£ng khÃ³a sá»­ dá»¥ng**   | 1 khÃ³a (dÃ¹ng chung Ä‘á»ƒ mÃ£ hÃ³a & giáº£i mÃ£) | 2 khÃ³a (khÃ³a cÃ´ng khai & khÃ³a riÃªng tÆ°)       |
| **Tá»‘c Ä‘á»™ xá»­ lÃ½**            | Nhanh hÆ¡n                               | Cháº­m hÆ¡n do tÃ­nh toÃ¡n phá»©c táº¡p hÆ¡n            |
| **Báº£o máº­t khi truyá»n khÃ³a** | Cáº§n kÃªnh an toÃ n Ä‘á»ƒ chia sáº» khÃ³a        | KhÃ´ng cáº§n chia sáº» khÃ³a riÃªng tÆ°               |
| **á»¨ng dá»¥ng phá»• biáº¿n**       | MÃ£ hÃ³a dá»¯ liá»‡u trong phiÃªn lÃ m viá»‡c     | Trao Ä‘á»•i khÃ³a an toÃ n, xÃ¡c thá»±c danh tÃ­nh     |
| **Thuáº­t toÃ¡n tiÃªu biá»ƒu**    | AES, DES, RC4                           | RSA, ECC                                      |
| **Äá»™ dÃ i khÃ³a phá»• biáº¿n**    | 128 hoáº·c 256 bit                        | 2048 bit trá»Ÿ lÃªn                              |
| **Rá»§i ro báº£o máº­t**          | Náº¿u khÃ³a bá»‹ lá»™, toÃ n bá»™ dá»¯ liá»‡u bá»‹ nguy | KhÃ³ bá»‹ táº¥n cÃ´ng náº¿u giá»¯ khÃ³a riÃªng tÆ° an toÃ n |


#### 3.3.3 Thuáº­t toÃ¡n trao Ä‘á»•i khÃ³a (Diffie-Hellman, RSA, ECC).
##### DH (Diffie-Hellman)
- Trao Ä‘á»•i khÃ³a Diffieâ€“Hellman (D-H) lÃ  má»™t phÆ°Æ¡ng phÃ¡p trao Ä‘á»•i khÃ³a Ä‘Æ°á»£c phÃ¡t minh sá»›m nháº¥t trong máº­t mÃ£ há»c. PhÆ°Æ¡ng phÃ¡p trao Ä‘á»•i khÃ³a Diffieâ€“Hellman cho phÃ©p hai bÃªn (ngÆ°á»i, thá»±c thá»ƒ giao tiáº¿p) thiáº¿t láº­p má»™t khÃ³a bÃ­ máº­t chung Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u sá»­ dá»¥ng trÃªn kÃªnh truyá»n thÃ´ng khÃ´ng an toÃ n mÃ  khÃ´ng cáº§n cÃ³ sá»± thá»a thuáº­n trÆ°á»›c vá» khÃ³a bÃ­ máº­t giá»¯a hai bÃªn. KhÃ³a bÃ­ máº­t táº¡o ra sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u vá»›i phÆ°Æ¡ng phÃ¡p mÃ£ hÃ³a khÃ³a Ä‘á»‘i xá»©ng.
- Giao thá»©c nÃ y Ä‘Æ°á»£c cÃ´ng bá»‘ Ä‘áº§u tiÃªn bá»Ÿi Whitfield Diffie vÃ  Martin Hellman vÃ o nÄƒm 1976
- Giao thá»©c nÃ y táº­n dá»¥ng cÃ¡c Ä‘áº·c tÃ­nh toÃ¡n há»c cá»§a logarit rá»i ráº¡c vÃ  sá»‘ há»c mÃ´-Ä‘un Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng ngay cáº£ khi káº» thÃ¹ cháº·n Ä‘Æ°á»£c Ä‘Æ°á»ng truyá»n, chÃºng cÅ©ng khÃ´ng thá»ƒ láº¥y Ä‘Æ°á»£c khÃ³a bÃ­ máº­t chung.
- TÃ­nh báº£o máº­t cá»§a trao Ä‘á»•i khÃ³a Diffie-Hellman dá»±a trÃªn Ä‘á»™ khÃ³ cá»§a BÃ i toÃ¡n logarit rá»i ráº¡c (DLP). DLP tuyÃªn bá»‘ ráº±ng vá»›i má»™t sá»‘ nguyÃªn tá»‘ lá»›n nháº¥t Ä‘á»‹nh p, má»™t gá»‘c nguyÃªn thá»§y g hÃ¬nh thá»©c p, vÃ  má»™t sá»‘ y nhÆ° váº­y mÃ  y = g^x \mod p, vá» máº·t tÃ­nh toÃ¡n khÃ´ng thá»ƒ xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c x Ä‘Æ°á»£c y, gvÃ  p. TÃ­nh khÃ³ Ä‘iá»u chá»‰nh nÃ y lÃ  ná»n táº£ng cho tÃ­nh báº£o máº­t cá»§a giao thá»©c.
- CÃ¡c bÆ°á»›c giao thá»©c
1. Táº¡o tham sá»‘:
â€“ Alice vÃ  Bob Ä‘á»“ng Ã½ vá» má»™t sá»‘ nguyÃªn tá»‘ lá»›n p vÃ  má»™t gá»‘c nguyÃªn thá»§y g hÃ¬nh thá»©c p. Nhá»¯ng giÃ¡ trá»‹ nÃ y khÃ´ng cáº§n pháº£i giá»¯ bÃ­ máº­t vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c chia sáº» má»™t cÃ¡ch cÃ´ng khai. Sá»± lá»±a chá»n cá»§a p vÃ  g lÃ  ráº¥t quan trá»ng; p pháº£i Ä‘á»§ lá»›n Ä‘á»ƒ chá»‘ng láº¡i cÃ¡c cuá»™c táº¥n cÃ´ng, thÆ°á»ng Ã­t nháº¥t lÃ  2048 bit trong cÃ¡c triá»ƒn khai hiá»‡n Ä‘áº¡i.
2. Lá»±a chá»n khÃ³a riÃªng tÆ°:
â€“ Alice chá»n khÃ³a riÃªng a, lÃ  má»™t sá»‘ nguyÃªn ngáº«u nhiÃªn sao cho 1 < a < p-1.
â€“ Bob chá»n khÃ³a riÃªng b, tÆ°Æ¡ng tá»± nhÆ° váº­y lÃ  má»™t sá»‘ nguyÃªn ngáº«u nhiÃªn sao cho 1 < b < p-1.
3. TÃ­nh toÃ¡n khÃ³a cÃ´ng khai:
â€“ Alice tÃ­nh toÃ¡n khÃ³a cÃ´ng khai cá»§a mÃ¬nh A as A = g^a \mod p.
â€“ Bob tÃ­nh khÃ³a cÃ´ng khai cá»§a mÃ¬nh B as B = g^b \mod p.
4. Trao Ä‘á»•i khÃ³a cÃ´ng khai:
â€“ Alice gá»­i khÃ³a cÃ´ng khai cá»§a mÃ¬nh A gá»­i Bob.
â€“ Bob gá»­i khÃ³a cÃ´ng khai cá»§a mÃ¬nh B tá»›i Alice.
5. TÃ­nh toÃ¡n bÃ­ máº­t Ä‘Æ°á»£c chia sáº»:
â€“ Alice tÃ­nh toÃ¡n bÃ­ máº­t Ä‘Æ°á»£c chia sáº» S as S = B^a \mod p.
â€“ Bob tÃ­nh toÃ¡n bÃ­ máº­t Ä‘Æ°á»£c chia sáº» S as S = A^b \mod p.
- Do Ä‘áº·c tÃ­nh cá»§a sá»‘ há»c mÃ´-Ä‘un, cáº£ hai phÃ©p tÃ­nh Ä‘á»u dáº«n Ä‘áº¿n cÃ¹ng má»™t bÃ­ máº­t chung S
  \[ S = (g^b \mod p)^a \mod p = g^{ba} \mod p \]
  \[ S = (g^a \mod p)^b \mod p = g^{ab} \mod p \]
- VÃ¬ váº­y, Alice vÃ  Bob bÃ¢y giá» chia sáº» má»™t bÃ­ máº­t chung S cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ liÃªn láº¡c an toÃ n hÆ¡n.
- VÃ­ dá»¥ 
- ![images](./images/DiffieHellman.png)
- Æ¯u Ä‘iá»ƒm:
	- Há»— trá»£ trao Ä‘á»•i khÃ³a an toÃ n: Thuáº­t toÃ¡n Diffie-Hellman cho phÃ©p hai thá»±c thá»ƒ thiáº¿t láº­p má»™t khÃ³a chung bÃ­ máº­t qua kÃªnh truyá»n khÃ´ng báº£o máº­t, khÃ³a nÃ y sau Ä‘Ã³ Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c há»‡ thá»‘ng mÃ£ hÃ³a Ä‘á»‘i xá»©ng.
	- Perfect Forward Secrecy: Viá»‡c lá»™ khÃ³a riÃªng khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n tÃ­nh báº£o máº­t cá»§a cÃ¡c phiÃªn giao tiáº¿p trÆ°á»›c Ä‘Ã³, do má»—i phiÃªn sá»­ dá»¥ng khÃ³a táº¡m thá»i khÃ¡c nhau.
	- KhÃ´ng yÃªu cáº§u dá»¯ liá»‡u tiá»n chia sáº»: CÃ¡c bÃªn tham gia khÃ´ng cáº§n cÃ³ kiáº¿n thá»©c hay khÃ³a báº£o máº­t chung trÆ°á»›c Ä‘Ã³ Ä‘á»ƒ thiáº¿t láº­p phiÃªn lÃ m viá»‡c báº£o máº­t.
- NhÆ°á»£c Ä‘iá»ƒm: 
	- Dá»… bá»‹ táº¥n cÃ´ng kiá»ƒu Man-in-the-Middle: Náº¿u khÃ´ng Ã¡p dá»¥ng biá»‡n phÃ¡p xÃ¡c thá»±c bá»• sung, káº» táº¥n cÃ´ng cÃ³ thá»ƒ giáº£ máº¡o má»™t trong hai bÃªn, chÃ¨n vÃ o quÃ¡ trÃ¬nh trao Ä‘á»•i vÃ  kiá»ƒm soÃ¡t phiÃªn giao tiáº¿p.
	- Thiáº¿u cÆ¡ cháº¿ xÃ¡c thá»±c tÃ­ch há»£p: Giao thá»©c khÃ´ng bao gá»“m thÃ nh pháº§n xÃ¡c minh danh tÃ­nh, lÃ m tÄƒng rá»§i ro bá»‹ giáº£ máº¡o.
	- Tá»‘n tÃ i nguyÃªn khi sá»­ dá»¥ng khÃ³a kÃ­ch thÆ°á»›c lá»›n: Viá»‡c sá»­ dá»¥ng khÃ³a cÃ³ Ä‘á»™ dÃ i lá»›n Ä‘á»ƒ tÄƒng tÃ­nh báº£o máº­t sáº½ lÃ m gia tÄƒng chi phÃ­ tÃ­nh toÃ¡n.
	- KhÃ´ng thÃ­ch há»£p cho chá»¯ kÃ½ sá»‘: Diffie-Hellman khÃ´ng há»— trá»£ viá»‡c táº¡o vÃ  xÃ¡c minh chá»¯ kÃ½ Ä‘iá»‡n tá»­, do má»¥c Ä‘Ã­ch thiáº¿t káº¿ chá»‰ nháº±m trao Ä‘á»•i khÃ³a.
	- KhÃ´ng an toÃ n trÆ°á»›c táº¥n cÃ´ng lÆ°á»£ng tá»­: Thuáº­t toÃ¡n dá»±a trÃªn Ä‘á»™ khÃ³ cá»§a bÃ i toÃ¡n logarit rá»i ráº¡c, vá»‘n cÃ³ thá»ƒ bá»‹ giáº£i quyáº¿t hiá»‡u quáº£ báº±ng mÃ¡y tÃ­nh lÆ°á»£ng tá»­ thÃ´ng qua thuáº­t toÃ¡n Shor.

##### RSA (Rivestâ€“Shamirâ€“Adleman)
- RSA lÃ  má»™t thuáº­t toÃ¡n mÃ£ hÃ³a khÃ³a cÃ´ng khai, Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong nhiá»u á»©ng dá»¥ng báº£o máº­t, nhÆ° chá»¯ kÃ½ sá»‘, xÃ¡c thá»±c, mÃ£ hÃ³a Ä‘Æ°á»ng truyá»n, v.v. RSA Ä‘Æ°á»£c Ä‘áº·t theo tÃªn cá»§a ba nhÃ  khoa há»c Ä‘Ã£ phÃ¡t minh ra nÃ³: Ron Rivest, Adi Shamir vÃ  Leonard Adleman.
- RSA Ä‘Æ°á»£c phÃ¡t minh vÃ o nÄƒm 1977 bá»Ÿi ba nhÃ  khoa há»c lÃ m viá»‡c táº¡i Viá»‡n CÃ´ng nghá»‡ Massachusetts (MIT). 
- Trao Ä‘á»•i khÃ³a RSA lÃ  quÃ¡ trÃ¬nh hai bÃªn liÃªn láº¡c chia sáº» khÃ³a cÃ´ng khai cá»§a há» Ä‘á»ƒ cÃ³ thá»ƒ mÃ£ hÃ³a vÃ  giáº£i mÃ£ thÃ´ng tin má»™t cÃ¡ch an toÃ n. Äiá»u nÃ y cho phÃ©p há» trao Ä‘á»•i thÃ´ng tin máº­t mÃ  khÃ´ng cáº§n pháº£i chia sáº» khÃ³a riÃªng tÆ°, vá»‘n lÃ  bÃ­ máº­t vÃ  chá»‰ Ä‘Æ°á»£c giá»¯ bá»Ÿi chá»§ sá»Ÿ há»¯u.
- Thuáº­t toÃ¡n RSA dá»±a trÃªn viá»‡c phÃ¢n tÃ­ch sá»‘ nguyÃªn lá»›n thÃ nh thá»«a sá»‘ nguyÃªn tá»‘ vÃ  sá»­ dá»¥ng sá»‘ há»c modulo Ä‘á»ƒ mÃ£ hÃ³a vÃ  giáº£i mÃ£ dá»¯ liá»‡u. NÃ³ bao gá»“m ba giai Ä‘oáº¡n chÃ­nh:
- **Sinh khÃ³a**: Táº¡o ra KhÃ³a cÃ´ng khai vÃ  KhÃ³a riÃªng  
- **MÃ£ hÃ³a**: NgÆ°á»i gá»­i mÃ£ hÃ³a dá»¯ liá»‡u báº±ng KhÃ³a cÃ´ng khai Ä‘á»ƒ táº¡o ra báº£n mÃ£ (cipher text)  
- **Giáº£i mÃ£**: Giáº£i mÃ£ báº£n mÃ£ báº±ng KhÃ³a riÃªng Ä‘á»ƒ khÃ´i phá»¥c dá»¯ liá»‡u ban Ä‘áº§u
- ![images](./images/RSA-Encryption-Works.png)
- Cá»¥ thá»ƒ cÃ¡c quÃ¡ trÃ¬nh
	- Sinh khoÃ¡ 
		- Chá»n hai sá»‘ nguyÃªn tá»‘ lá»›n, gá»i lÃ  p vÃ  q. Hai sá»‘ nguyÃªn tá»‘ nÃ y cáº§n Ä‘Æ°á»£c giá»¯ bÃ­ máº­t.
		- TÃ­nh tÃ­ch cá»§a hai sá»‘ nguyÃªn tá»‘:â€¯n = p Ã— q. GiÃ¡ trá»‹ n lÃ  má»™t pháº§n cá»§a cáº£ khÃ³a cÃ´ng khai láº«n khÃ³a riÃªng.
		- TÃ­nh hÃ m phi Euler Î¦(n) theo cÃ´ng thá»©c:
		`Î¦(n) = Î¦(p Ã— q) = Î¦(p) Ã— Î¦(q) = (p âˆ’ 1) Ã— (q âˆ’ 1)`
		- Chá»n sá»‘ mÅ© mÃ£ hÃ³a e, sao cho:
		`1 < e < Î¦(n)` vÃ  `gcd(e, Î¦(n)) = 1`, nghÄ©a lÃ  e pháº£i nguyÃªn tá»‘ cÃ¹ng nhau vá»›i Î¦(n).
		- TÃ­nh sá»‘ mÅ© giáº£i mÃ£ d, sao cho:`(d Ã— e) â‰¡ 1 mod Î¦(n)`, tá»©c lÃ  d lÃ  nghá»‹ch Ä‘áº£o modular cá»§a e theo modulo Î¦(n).
		- Má»™t sá»‘ phÆ°Æ¡ng phÃ¡p phá»• biáº¿n Ä‘á»ƒ tÃ­nh nghá»‹ch Ä‘áº£o modular lÃ : Thuáº­t toÃ¡n Euclid má»Ÿ rá»™ng, Äá»‹nh lÃ½ Fermat nhá», v.v.
		- CÃ³ thá»ƒ tá»“n táº¡i nhiá»u giÃ¡ trá»‹ d thá»a mÃ£n (d Ã— e) â‰¡ 1 mod Î¦(n), nhÆ°ng khÃ´ng quan trá»ng chá»n giÃ¡ trá»‹ nÃ o, vÃ¬ táº¥t cáº£ Ä‘á»u lÃ  khÃ³a há»£p lá»‡ vÃ  sáº½ giáº£i mÃ£ ra cÃ¹ng má»™t thÃ´ng Ä‘iá»‡p.
		- Cuá»‘i cÃ¹ng:
			- KhÃ³a cÃ´ng khai = (n, e)
			- KhÃ³a riÃªng = (n, d)
	- MÃ£ hoÃ¡: Sá»­ dá»¥ng khÃ³a cÃ´ng khai (n, e) Ä‘á»ƒ mÃ£ hÃ³a thÃ´ng Ä‘iá»‡p vÃ  táº¡o báº£n mÃ£ (cipher text) theo cÃ´ng thá»©c: `C = Máµ‰ mod n`, trong Ä‘Ã³ C lÃ  báº£n mÃ£, cÃ²n e vÃ  n lÃ  cÃ¡c thÃ nh pháº§n cá»§a khÃ³a cÃ´ng khai.
	- Giáº£i mÃ£: Äá»ƒ giáº£i mÃ£ báº£n mÃ£ C, sá»­ dá»¥ng khÃ³a riÃªng (n, d) Ä‘á»ƒ khÃ´i phá»¥c dá»¯ liá»‡u ban Ä‘áº§u theo cÃ´ng thá»©c: `M = Cáµˆ mod n`, trong Ä‘Ã³ M lÃ  thÃ´ng Ä‘iá»‡p gá»‘c, cÃ²n d vÃ  n lÃ  cÃ¡c thÃ nh pháº§n cá»§a khÃ³a riÃªng.
- VÃ­ dá»¥ 
```
Chá»n p = 3 vÃ  q = 11  
TÃ­nh n = p Ã— q = 3 Ã— 11 = 33  
TÃ­nh Ï†(n) = (p âˆ’ 1) Ã— (q âˆ’ 1) = 2 Ã— 10 = 20  
Chá»n e sao cho 1 < e < Ï†(n) vÃ  e nguyÃªn tá»‘ cÃ¹ng nhau vá»›i Ï†(n). Chá»n e = 7  
TÃ­nh d sao cho (d Ã— e) % Ï†(n) = 1. Má»™t nghiá»‡m lÃ  d = 3 [(3 Ã— 7) % 20 = 1]  
KhÃ³a cÃ´ng khai lÃ  (e, n) => (7, 33)  
KhÃ³a riÃªng lÃ  (d, n) => (3, 33)  
MÃ£ hÃ³a m = 2 Ä‘Æ°á»£c: c = 2â· % 33 = 29  
Giáº£i mÃ£ c = 29 Ä‘Æ°á»£c: m = 29Â³ % 33 = 2
```
- Æ¯u Ä‘iá»ƒm
	- Báº£o máº­t cao: Thuáº­t toÃ¡n RSA Ä‘Æ°á»£c xem lÃ  ráº¥t an toÃ n vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong viá»‡c truyá»n dá»¯ liá»‡u báº£o máº­t.
	- Máº­t mÃ£ khÃ³a cÃ´ng khai: RSA lÃ  thuáº­t toÃ¡n máº­t mÃ£ báº¥t Ä‘á»‘i xá»©ng, sá»­ dá»¥ng hai khÃ³a khÃ¡c nhauâ€”khÃ³a cÃ´ng khai Ä‘á»ƒ mÃ£ hÃ³a vÃ  khÃ³a riÃªng Ä‘á»ƒ giáº£i mÃ£.
	- Trao Ä‘á»•i khÃ³a an toÃ n: Cho phÃ©p hai bÃªn thiáº¿t láº­p má»™t khÃ³a bÃ­ máº­t mÃ  khÃ´ng cáº§n truyá»n trá»±c tiáº¿p khÃ³a nÃ y qua máº¡ng.
	- Chá»¯ kÃ½ sá»‘: CÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ táº¡o chá»¯ kÃ½ sá»‘, trong Ä‘Ã³ ngÆ°á»i gá»­i kÃ½ báº±ng khÃ³a riÃªng vÃ  ngÆ°á»i nháº­n xÃ¡c minh báº±ng khÃ³a cÃ´ng khai cá»§a ngÆ°á»i gá»­i.
	- á»¨ng dá»¥ng rá»™ng rÃ£i: ÄÆ°á»£c triá»ƒn khai trong cÃ¡c lÄ©nh vá»±c nhÆ° ngÃ¢n hÃ ng trá»±c tuyáº¿n, thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­ vÃ  truyá»n thÃ´ng an toÃ n.
- NhÆ°á»£c Ä‘iá»ƒm
	- Tá»‘c Ä‘á»™ xá»­ lÃ½ cháº­m: Cháº­m hÆ¡n so vá»›i nhiá»u thuáº­t toÃ¡n mÃ£ hÃ³a khÃ¡c, Ä‘áº·c biá»‡t lÃ  khi xá»­ lÃ½ dá»¯ liá»‡u cÃ³ dung lÆ°á»£ng lá»›n.
	- KÃ­ch thÆ°á»›c khÃ³a lá»›n: ÄÃ²i há»i khÃ³a cÃ³ Ä‘á»™ dÃ i lá»›n Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n, dáº«n Ä‘áº¿n viá»‡c tiÃªu tá»‘n nhiá»u tÃ i nguyÃªn tÃ­nh toÃ¡n vÃ  khÃ´ng gian lÆ°u trá»¯.
	- Dá»… bá»‹ táº¥n cÃ´ng kÃªnh phá»¥: CÃ³ thá»ƒ bá»‹ táº¥n cÃ´ng thÃ´ng qua cÃ¡c kÃªnh rÃ² rá»‰ nhÆ° tiÃªu thá»¥ nÄƒng lÆ°á»£ng, bá»©c xáº¡ Ä‘iá»‡n tá»« hoáº·c phÃ¢n tÃ­ch thá»i gian thá»±c thi Ä‘á»ƒ láº¥y khÃ³a riÃªng.
	- Háº¡n cháº¿ trong má»™t sá»‘ á»©ng dá»¥ng: KhÃ´ng phÃ¹ há»£p vá»›i nhá»¯ng á»©ng dá»¥ng yÃªu cáº§u mÃ£ hÃ³a vÃ  giáº£i mÃ£ liÃªn tá»¥c vá»›i lÆ°á»£ng lá»›n dá»¯ liá»‡u do tá»‘c Ä‘á»™ tháº¥p.
	- Äá»™ phá»©c táº¡p cao: LÃ  má»™t thuáº­t toÃ¡n toÃ¡n há»c phá»©c táº¡p, cÃ³ thá»ƒ gÃ¢y khÃ³ khÄƒn trong viá»‡c hiá»ƒu vÃ  triá»ƒn khai.
	- Quáº£n lÃ½ khÃ³a khÃ³ khÄƒn: Viá»‡c báº£o máº­t khÃ³a riÃªng lÃ  Ä‘iá»u báº¯t buá»™c, nhÆ°ng Ä‘Ã´i khi cÃ³ thá»ƒ gáº·p nhiá»u khÃ³ khÄƒn trong quÃ¡ trÃ¬nh triá»ƒn khai thá»±c táº¿.
	- KhÃ´ng an toÃ n trÆ°á»›c mÃ¡y tÃ­nh lÆ°á»£ng tá»­: RSA cÃ³ thá»ƒ bá»‹ phÃ¡ vá»¡ bá»Ÿi mÃ¡y tÃ­nh lÆ°á»£ng tá»­, vÃ¬ cÃ¡c thuáº­t toÃ¡n nhÆ° Shor cÃ³ thá»ƒ giáº£i Ä‘Æ°á»£c bÃ i toÃ¡n phÃ¢n tÃ­ch thá»«a sá»‘ ráº¥t nhanh.

##### ECC (Elliptic Curve Cryptography)
- MÃ£ hoÃ¡ Ä‘Æ°á»ng cong elliptic (Elliptic Curve Cryptography â€“ ECC) lÃ  má»™t phÆ°Æ¡ng phÃ¡p máº¡nh máº½ vÃ  hiá»‡u quáº£ trong lÄ©nh vá»±c máº­t mÃ£ khÃ³a cÃ´ng khai, cung cáº¥p má»©c Ä‘á»™ báº£o máº­t cao vá»›i kÃ­ch thÆ°á»›c khÃ³a nhá» hÆ¡n so vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p truyá»n thá»‘ng. 
- ECC (Elliptic Curve Cryptography) lÃ  má»™t há»‡ thá»‘ng máº­t mÃ£ khÃ³a cÃ´ng khai dá»±a trÃªn cáº¥u trÃºc Ä‘áº¡i sá»‘ cá»§a cÃ¡c Ä‘Æ°á»ng cong elliptic trÃªn trÆ°á»ng há»¯u háº¡n.  
- NÃ³ cung cáº¥p má»©c Ä‘á»™ báº£o máº­t tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i RSA nhÆ°ng sá»­ dá»¥ng Ä‘á»™ dÃ i khÃ³a ngáº¯n hÆ¡n nhiá»u, tá»« Ä‘Ã³ giÃºp tÄƒng tá»‘c Ä‘á»™ xá»­ lÃ½ vÃ  giáº£m má»©c tiÃªu thá»¥ tÃ i nguyÃªn.  
- ECC Ä‘Æ°á»£c á»©ng dá»¥ng rá»™ng rÃ£i trong nhiá»u lÄ©nh vá»±c nhÆ° truyá»n thÃ´ng an toÃ n, chá»¯ kÃ½ sá»‘ vÃ  tiá»n mÃ£ hÃ³a.
- Elliptic Curve
	- ÄÆ°á»ng cong elliptic lÃ  má»™t Ä‘Æ°á»ng cong toÃ¡n há»c Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi phÆ°Æ¡ng trÃ¬nh:
	`yÂ² = xÂ³ + ax + b`
	- Trong Ä‘Ã³ a vÃ  b lÃ  cÃ¡c háº±ng sá»‘. Trong lÄ©nh vá»±c máº­t mÃ£, Ä‘Æ°á»ng cong elliptic Ä‘Æ°á»£c sá»­ dá»¥ng trÃªn cÃ¡c trÆ°á»ng há»¯u háº¡n, tá»©c lÃ  cÃ¡c tá»a Ä‘á»™ x vÃ  y bá»‹ giá»›i háº¡n trong má»™t pháº¡m vi giÃ¡ trá»‹ nguyÃªn nháº¥t Ä‘á»‹nh.
	- ![images](./images/Elliptic-Curve-Cryptography.png)
	- CÃ¡c tÃ­nh cháº¥t chÃ­nh cá»§a Ä‘Æ°á»ng cong elliptic:
		- Äá»‘i xá»©ng qua trá»¥c hoÃ nh (x-axis)
		- KhÃ´ng ká»³ dá»‹ (khÃ´ng cÃ³ Ä‘iá»ƒm nhá»n hoáº·c tá»± cáº¯t)
		- Má»—i Ä‘Æ°á»ng tháº³ng Ä‘á»©ng cáº¯t Ä‘Æ°á»ng cong táº¡i nhiá»u nháº¥t ba Ä‘iá»ƒm
- ECC táº­n dá»¥ng cÃ¡c tÃ­nh cháº¥t toÃ¡n há»c cá»§a Ä‘Æ°á»ng cong elliptic Ä‘á»ƒ xÃ¢y dá»±ng há»‡ thá»‘ng máº­t mÃ£ an toÃ n. MÃ´ táº£ Ä‘Æ¡n giáº£n hÃ³a vá» quy trÃ¬nh:
	- Chá»n má»™t Ä‘Æ°á»ng cong elliptic cÃ¹ng vá»›i má»™t Ä‘iá»ƒm trÃªn Ä‘Æ°á»ng cong Ä‘Ã³ lÃ m Ä‘iá»ƒm sinh (G).
	- Chá»n má»™t khÃ³a riÃªng, lÃ  má»™t sá»‘ nguyÃªn ngáº«u nhiÃªn.
	- NhÃ¢n Ä‘iá»ƒm sinh G vá»›i khÃ³a riÃªng Ä‘á»ƒ thu Ä‘Æ°á»£c khÃ³a cÃ´ng khai.
	- Sá»­ dá»¥ng khÃ³a cÃ´ng khai Ä‘á»ƒ mÃ£ hÃ³a hoáº·c xÃ¡c minh chá»¯ kÃ½.
- VÃ­ dá»¥: Giáº£ sá»­:
	- Chá»n má»™t Ä‘Æ°á»ng cong elliptic cÃ´ng khai vÃ  má»™t Ä‘iá»ƒm sinh G trÃªn Ä‘Æ°á»ng cong.
		- Alice chá»n khÃ³a riÃªng lÃ  a = 5, tÃ­nh khÃ³a cÃ´ng khai A = aG.
		- Bob chá»n khÃ³a riÃªng lÃ  b = 7, tÃ­nh khÃ³a cÃ´ng khai B = bG.
	- Trao Ä‘á»•i khÃ³a:
		- Alice nháº­n B tá»« Bob vÃ  tÃ­nh S = aB = a(bG) = abG.
		- Bob nháº­n A tá»« Alice vÃ  tÃ­nh S = bA = b(aG) = abG.
	- Cáº£ hai bÃªn Ä‘á»u tÃ­nh Ä‘Æ°á»£c cÃ¹ng má»™t Ä‘iá»ƒm S = abG, Ä‘Æ°á»£c dÃ¹ng lÃ m khÃ³a phiÃªn Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u.
- VÃ­ dá»¥ khÃ¡c vá» ECC á»©ng dá»¥ng vá»›i Diffie-Hellman -> ECDH: 
	- CÃ¡c bÆ°á»›c Ä‘á»ƒ Alice vÃ  Bob trao Ä‘á»•i khÃ³a má»™t cÃ¡ch an toÃ n (trong khi Cathy lÃ  káº» táº¥n cÃ´ng nghe lÃ©n), mÃ  khÃ´ng cáº§n chia sáº» khÃ³a trÆ°á»›c:
		- Alice, Bob vÃ  Cathy cÃ¹ng thá»‘ng nháº¥t vá» má»™t Ä‘Æ°á»ng cong elliptic cÃ´ng khai vÃ  má»™t Ä‘iá»ƒm cá»‘ Ä‘á»‹nh trÃªn Ä‘Æ°á»ng cong Ä‘Ã³, gá»i lÃ  G.
		- Alice chá»n má»™t sá»‘ nguyÃªn ngáº«u nhiÃªn Î± lÃ m khÃ³a riÃªng cá»§a mÃ¬nh.
		- Alice tÃ­nh khÃ³a cÃ´ng khai: A = Î±G (nhÃ¢n vÃ´ hÆ°á»›ng). CÃ´ cÃ´ng khai A.
		- Bob chá»n má»™t sá»‘ nguyÃªn ngáº«u nhiÃªn Î² lÃ m khÃ³a riÃªng cá»§a mÃ¬nh.
		- Bob tÃ­nh khÃ³a cÃ´ng khai: B = Î²G vÃ  cÃ´ng khai B.
		- Cathy cÅ©ng thá»±c hiá»‡n tÆ°Æ¡ng tá»± Ä‘á»ƒ táº¡o khÃ³a riÃªng vÃ  khÃ³a cÃ´ng khai cá»§a mÃ¬nh.
	- Giáº£ sá»­ Alice muá»‘n gá»­i thÃ´ng Ä‘iá»‡p cho Bob:
		- Alice tÃ­nh P = Î±B = Î±(Î²G) vÃ  dÃ¹ng P lÃ m khÃ³a riÃªng cá»§a phiÃªn liÃªn láº¡c.
		- Bob tÃ­nh P = Î²A = Î²(Î±G) vÃ  cÅ©ng dÃ¹ng P cho phiÃªn liÃªn láº¡c.
		- Do Î±B = Î±(Î²G) = Î²(Î±G) = Î²A, nÃªn chá»‰ cÃ³ Alice vÃ  Bob biáº¿t khÃ³a phiÃªn P.
	- CÃ²n náº¿u Cathy muá»‘n Ä‘á»c cuá»™c trÃ² chuyá»‡n giá»¯a Alice vÃ  Bob:
		- Cathy biáº¿t Ä‘Æ°á»ng cong elliptic, Ä‘iá»ƒm G, báº­c cá»§a G vÃ  khÃ³a cÃ´ng khai A vÃ  B cá»§a Alice vÃ  Bob.
		- Tuy nhiÃªn, Cathy khÃ´ng biáº¿t Î± vÃ  Î² (cÃ¡c khÃ³a riÃªng), vÃ  Ä‘á»ƒ tÃ­nh Ä‘Æ°á»£c P, cÃ´ ta cáº§n giáº£i Ä‘Æ°á»£c BÃ i toÃ¡n logarit rá»i ráº¡c trÃªn Ä‘Æ°á»ng cong ellipticâ€”Ä‘iá»u nÃ y Ä‘Æ°á»£c coi lÃ  cá»±c ká»³ khÃ³ trong thá»±c táº¿.
	- ![images](./images/ecdh.png)
- TÃ­nh báº£o máº­t cá»§a ECC dá»±a trÃªn Ä‘á»™ khÃ³ cá»§a BÃ i toÃ¡n Logarit rá»i ráº¡c trÃªn Ä‘Æ°á»ng cong elliptic (ECDLP)â€”tá»©c lÃ  bÃ i toÃ¡n tÃ¬m giÃ¡ trá»‹ vÃ´ hÆ°á»›ng (scalar) Ä‘Ã£ Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ nhÃ¢n má»™t Ä‘iá»ƒm trÃªn Ä‘Æ°á»ng cong.
- Æ¯u Ä‘iá»ƒm cá»§a ECC
	- KÃ­ch thÆ°á»›c khÃ³a nhá» hÆ¡n: ECC cung cáº¥p má»©c Ä‘á»™ báº£o máº­t tÆ°Æ¡ng Ä‘Æ°Æ¡ng RSA nhÆ°ng vá»›i Ä‘á»™ dÃ i khÃ³a ngáº¯n hÆ¡n Ä‘Ã¡ng ká»ƒ. VÃ­ dá»¥: má»™t khÃ³a ECC 256-bit cÃ³ má»©c báº£o máº­t tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i khÃ³a RSA 3072-bit.
	- Tá»‘c Ä‘á»™ tÃ­nh toÃ¡n nhanh hÆ¡n: KÃ­ch thÆ°á»›c khÃ³a nhá» hÆ¡n giÃºp giáº£m thá»i gian xá»­ lÃ½, lÃ m cho ECC hiá»‡u quáº£ hÆ¡n trÃªn cÃ¡c thiáº¿t bá»‹ cÃ³ tÃ i nguyÃªn háº¡n cháº¿.
	- Tá»‘n Ã­t tÃ i nguyÃªn hÆ¡n: ECC yÃªu cáº§u Ã­t bá»™ nhá»› vÃ  bÄƒng thÃ´ng hÆ¡n, lÃ½ tÆ°á»Ÿng cho cÃ¡c thiáº¿t bá»‹ di Ä‘á»™ng vÃ  á»©ng dá»¥ng IoT.
	- TÃ­nh thÃ­ch á»©ng trong tÆ°Æ¡ng lai: Khi nÄƒng lá»±c tÃ­nh toÃ¡n tÄƒng lÃªn, ECC má»Ÿ rá»™ng báº£o máº­t hiá»‡u quáº£ hÆ¡n so vá»›i RSA, chá»‰ cáº§n tÄƒng nháº¹ Ä‘á»™ dÃ i khÃ³a Ä‘á»ƒ duy trÃ¬ má»©c Ä‘á»™ an toÃ n.
- Má»™t sá»‘ háº¡n cháº¿ cá»§a ECC
	- Váº¥n Ä‘á» báº±ng sÃ¡ng cháº¿: Má»™t sá»‘ thuáº­t toÃ¡n ECC tá»«ng Ä‘Æ°á»£c cáº¥p báº±ng sÃ¡ng cháº¿, Ä‘iá»u nÃ y ban Ä‘áº§u Ä‘Ã£ lÃ m cháº­m quÃ¡ trÃ¬nh phá»• biáº¿n. Tuy nhiÃªn, nhiá»u báº±ng sÃ¡ng cháº¿ quan trá»ng hiá»‡n nay Ä‘Ã£ háº¿t hiá»‡u lá»±c.
	- Äá»™ phá»©c táº¡p khi triá»ƒn khai: Viá»‡c triá»ƒn khai chÃ­nh xÃ¡c ECC cÃ³ thá»ƒ phá»©c táº¡p hÆ¡n so vá»›i RSA, Ä‘Ã²i há»i sá»± cáº©n trá»ng trong tá»«ng chi tiáº¿t ká»¹ thuáº­t.
	- Má»‘i Ä‘e dá»a tá»« mÃ¡y tÃ­nh lÆ°á»£ng tá»­: TÆ°Æ¡ng tá»± nhÆ° cÃ¡c há»‡ máº­t mÃ£ khÃ³a cÃ´ng khai khÃ¡c, ECC cÅ©ng cÃ³ thá»ƒ bá»‹ táº¥n cÃ´ng bá»Ÿi cÃ¡c mÃ¡y tÃ­nh lÆ°á»£ng tá»­ quy mÃ´ lá»›n (máº·c dÃ¹ Ã­t chá»‹u áº£nh hÆ°á»Ÿng hÆ¡n so vá»›i RSA).
	- Háº¡n cháº¿ trong má»©c Ä‘á»™ triá»ƒn khai: DÃ¹ cÃ³ nhiá»u lá»£i tháº¿, ECC váº«n chÆ°a Ä‘Æ°á»£c Ã¡p dá»¥ng rá»™ng rÃ£i nhÆ° RSA trong má»™t sá»‘ lÄ©nh vá»±c, Ä‘iá»u nÃ y cÃ³ thá»ƒ dáº«n Ä‘áº¿n cÃ¡c váº¥n Ä‘á» vá» kháº£ nÄƒng tÆ°Æ¡ng thÃ­ch.
##### So sÃ¡nh 

| TiÃªu chÃ­                        | Diffie-Hellman (DH)                    | RSA                                            | Elliptic Curve Diffie-Hellman (ECDH)               |
| ------------------------------- | -------------------------------------- | ---------------------------------------------- | -------------------------------------------------- |
| **Loáº¡i thuáº­t toÃ¡n**             | Máº­t mÃ£ khÃ³a cÃ´ng khai (trao Ä‘á»•i khÃ³a)  | Máº­t mÃ£ khÃ³a cÃ´ng khai (mÃ£ hÃ³a & trao Ä‘á»•i khÃ³a) | Máº­t mÃ£ khÃ³a cÃ´ng khai dá»±a trÃªn Ä‘Æ°á»ng cong elliptic |
| **CÆ¡ sá»Ÿ toÃ¡n há»c**              | Logarit rá»i ráº¡c trong trÆ°á»ng sá»‘ nguyÃªn | PhÃ¢n tÃ­ch thá»«a sá»‘ nguyÃªn lá»›n                   | Logarit rá»i ráº¡c trÃªn Ä‘Æ°á»ng cong elliptic (ECDLP)   |
| **KÃ­ch thÆ°á»›c khÃ³a tÆ°Æ¡ng Ä‘Æ°Æ¡ng** | 2048 bit (an toÃ n hiá»‡n táº¡i)            | 3072 bit                                       | 256 bit ECC â‰ˆ 3072 bit RSA                         |
| **Hiá»‡u suáº¥t**                   | Trung bÃ¬nh                             | Cháº­m vá»›i khÃ³a lá»›n                              | Nhanh, hiá»‡u quáº£ trÃªn thiáº¿t bá»‹ háº¡n cháº¿ tÃ i nguyÃªn   |
| **TÃ­nh báº£o máº­t**                | Báº£o máº­t tá»‘t, nhÆ°ng khÃ´ng xÃ¡c thá»±c      | Báº£o máº­t tá»‘t, há»— trá»£ xÃ¡c thá»±c                   | Báº£o máº­t cao, cáº§n xÃ¡c thá»±c bá»• sung                  |
| **Chá»‘ng táº¥n cÃ´ng lÆ°á»£ng tá»­**     | KhÃ´ng an toÃ n                          | KhÃ´ng an toÃ n                                  | KhÃ´ng an toÃ n, nhÆ°ng tá»‘t hÆ¡n RSA                   |

#### 3.3.4 CÃ¡c thuáº­t toÃ¡n mÃ£ hÃ³a phá»• biáº¿n (AES, 3DES, ChaCha20).
##### AES
- Chuáº©n mÃ£ hÃ³a nÃ¢ng cao (Advanced Encryption Standard â€“ AES) lÃ  má»™t thuáº­t toÃ¡n mÃ£ hÃ³a ráº¥t Ä‘Ã¡ng tin cáº­y, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ báº£o vá»‡ dá»¯ liá»‡u báº±ng cÃ¡ch chuyá»ƒn Ä‘á»•i nÃ³ thÃ nh dáº¡ng khÃ´ng thá»ƒ Ä‘á»c Ä‘Æ°á»£c náº¿u khÃ´ng cÃ³ khÃ³a giáº£i mÃ£ phÃ¹ há»£p. Thuáº­t toÃ¡n nÃ y Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi Viá»‡n TiÃªu chuáº©n vÃ  CÃ´ng nghá»‡ Quá»‘c gia Hoa Ká»³ (NIST) vÃ o nÄƒm 2001.
- Hiá»‡n nay, AES Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i vÃ¬ máº¡nh hÆ¡n nhiá»u so vá»›i DES vÃ  Triple DES, dÃ¹ viá»‡c triá»ƒn khai cÃ³ pháº§n phá»©c táº¡p hÆ¡n. AES há»— trá»£ nhiá»u Ä‘á»™ dÃ i khÃ³a khÃ¡c nhau (128, 192 hoáº·c 256 bit), mang láº¡i kháº£ nÄƒng báº£o máº­t máº¡nh máº½ chá»‘ng láº¡i truy cáº­p trÃ¡i phÃ©p. Giáº£i phÃ¡p báº£o máº­t nÃ y hiá»‡u quáº£ vÃ  Ä‘Æ°á»£c Ã¡p dá»¥ng phá»• biáº¿n trong viá»‡c Ä‘áº£m báº£o an toÃ n truyá»n thÃ´ng trÃªn Internet, báº£o vá»‡ dá»¯ liá»‡u nháº¡y cáº£m vÃ  mÃ£ hÃ³a tá»‡p tin.
- Äáº·c Ä‘iá»ƒm cá»§a AES
	- AES lÃ  má»™t mÃ£ khá»‘i (Block Cipher).
	- KÃ­ch thÆ°á»›c khÃ³a cÃ³ thá»ƒ lÃ  128, 192 hoáº·c 256 bit.
	- AES mÃ£ hÃ³a dá»¯ liá»‡u theo cÃ¡c khá»‘i 128 bit.
- AES lÃ  má»™t thuáº­t toÃ¡n mÃ£ hÃ³a khá»‘i Ä‘á»‘i xá»©ng vá»›i Ä‘á»™ dÃ i khÃ³a lÃ  128 bÃ­t (má»™t chá»¯ sá»‘ nhá»‹ phÃ¢n cÃ³ giÃ¡ trá»‹ 0 hoáº·c 1), 192 bÃ­t vÃ  256 bÃ­t tÆ°Æ¡ng á»©ng dá»i lÃ  AES-128, AES-192 vÃ  AES-256. AES-128 sá»­ dá»¥ng 10 vÃ²ng (round), AES-192 sá»­ dá»¥ng 12 vÃ²ng vÃ  AES-256 sá»­ dá»¥ng 14 vÃ²ng.
- Quy trÃ¬nh mÃ£ hÃ³a AES: MÃ£ hÃ³a AES bao gá»“m má»™t chuá»—i bÆ°á»›c nháº±m biáº¿n plaintext thÃ nh ciphertext, vá»›i cÃ¡c giai Ä‘oáº¡n chÃ­nh nhÆ° sau:
	- Má»Ÿ rá»™ng khÃ³a (Key Expansion): KhÃ³a mÃ£ hÃ³a Ä‘Æ°á»£c má»Ÿ rá»™ng thÃ nh má»™t dÃ£y cÃ¡c khÃ³a vÃ²ng (round keys), má»—i vÃ²ng sáº½ sá»­ dá»¥ng má»™t khÃ³a riÃªng biá»‡t Ä‘Æ°á»£c suy ra tá»« khÃ³a ban Ä‘áº§u.
	- VÃ²ng khá»Ÿi Ä‘áº§u â€“ AddRoundKey: Khá»‘i plaintext Ä‘Æ°á»£c káº¿t há»£p vá»›i khÃ³a vÃ²ng Ä‘áº§u tiÃªn báº±ng phÃ©p XOR (loáº¡i trá»« theo bit), báº¯t Ä‘áº§u quÃ¡ trÃ¬nh trá»™n dá»¯ liá»‡u vá»›i khÃ³a mÃ£ hÃ³a.
	- CÃ¡c vÃ²ng biáº¿n Ä‘á»•i (Transformation Rounds)
	- Má»—i vÃ²ng (trá»« vÃ²ng cuá»‘i) thá»±c hiá»‡n cÃ¡c bÆ°á»›c sau:
		- SubBytes (Thay tháº¿): Má»—i byte trong khá»‘i Ä‘Æ°á»£c thay báº±ng má»™t byte khÃ¡c tá»« S-box â€“ má»™t báº£ng tra phi tuyáº¿n Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh trÆ°á»›c â€“ Ä‘á»ƒ tÄƒng má»©c Ä‘á»™ nhiá»…u giá»¯a plaintext vÃ  ciphertext.
		 - ShiftRows (HoÃ¡n vá»‹ hÃ ng): Ma tráº­n dá»¯ liá»‡u 4Ã—4 bá»‹ dá»‹ch theo hÃ ng:
			- HÃ ng 0: giá»¯ nguyÃªn
			- HÃ ng 1: dá»‹ch trÃ¡i 1 byte
			- HÃ ng 2: dá»‹ch trÃ¡i 2 byte
			- HÃ ng 3: dá»‹ch trÃ¡i 3 byte
			- Viá»‡c nÃ y lÃ m thay Ä‘á»•i vá»‹ trÃ­ byte, gia tÄƒng tÃ­nh phá»©c táº¡p cá»§a dá»¯ liá»‡u.
		- MixColumns (Trá»™n cá»™t): Má»—i cá»™t Ä‘Æ°á»£c biáº¿n Ä‘á»•i báº±ng toÃ¡n há»c trÃªn trÆ°á»ng Galois, lÃ m lan tá»a áº£nh hÆ°á»Ÿng cá»§a má»—i byte tá»›i toÃ n bá»™ khá»‘i.
		- AddRoundKey: XOR khá»‘i dá»¯ liá»‡u hiá»‡n táº¡i vá»›i khÃ³a vÃ²ng tÆ°Æ¡ng á»©ng, tiáº¿p tá»¥c Ä‘Æ°a yáº¿u tá»‘ khÃ³a vÃ o quÃ¡ trÃ¬nh mÃ£ hÃ³a.
	- VÃ²ng cuá»‘i cÃ¹ng (Final Round): VÃ²ng cuá»‘i khÃ´ng thá»±c hiá»‡n MixColumns, chá»‰ bao gá»“m:
		- SubBytes
		- ShiftRows
		- AddRoundKey
	- Káº¿t quáº£ táº¡o thÃ nh ciphertext hoÃ n chá»‰nh sau cÃ¹ng.
- Quy trÃ¬nh giáº£i mÃ£ AES: Giáº£i mÃ£ AES thá»±c hiá»‡n quÃ¡ trÃ¬nh ngÆ°á»£c láº¡i vá»›i mÃ£ hÃ³a, sá»­ dá»¥ng cÃ¹ng má»™t khÃ³a. CÃ¡c thao tÃ¡c Ä‘Æ°á»£c Ä‘áº£o ngÆ°á»£c theo thá»© tá»± ngÆ°á»£c láº¡i:
	- Inverse SubBytes: Äáº£o ngÆ°á»£c bÆ°á»›c thay tháº¿ byte.
	- Inverse ShiftRows: Äáº£o ngÆ°á»£c viá»‡c dá»‹ch chuyá»ƒn cÃ¡c hÃ ng.
	- Inverse MixColumns: Äáº£o ngÆ°á»£c quÃ¡ trÃ¬nh trá»™n cÃ¡c cá»™t.
	- AddRoundKey: Ãp dá»¥ng láº¡i phÃ©p XOR nhÆ° trong quÃ¡ trÃ¬nh mÃ£ hÃ³a.
	- QuÃ¡ trÃ¬nh giáº£i mÃ£ Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ hiá»‡u quáº£ tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i mÃ£ hÃ³a, Ä‘áº£m báº£o tÃ­nh Ä‘á»‘i xá»©ng cá»§a thuáº­t toÃ¡n.
- Æ¯u Ä‘iá»ƒm:
	- Báº£o máº­t máº¡nh máº½: AES lÃ  má»™t thuáº­t toÃ¡n mÃ£ hÃ³a máº¡nh máº½, Ä‘Æ°á»£c chÃ­nh phá»§ Hoa Ká»³ vÃ  nhiá»u quá»‘c gia khÃ¡c cÃ´ng nháº­n. MÃ£ hÃ³a AES 256 bit, Ä‘áº·c biá»‡t, gáº§n nhÆ° khÃ´ng thá»ƒ bá»‹ phÃ¡ vá»¡, lÃ  má»™t trong nhá»¯ng tiÃªu chuáº©n mÃ£ hÃ³a máº¡nh nháº¥t hiá»‡n nay.
	- TÃ­nh linh hoáº¡t: AES cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong nhiá»u á»©ng dá»¥ng khÃ¡c nhau, tá»« báº£o vá»‡ dá»¯ liá»‡u trÃªn cÃ¡c thiáº¿t bá»‹ lÆ°u trá»¯ Ä‘áº¿n báº£o máº­t cÃ¡c káº¿t ná»‘i máº¡ng.
	- Hiá»‡u suáº¥t tá»‘t: AES cÃ³ hiá»‡u suáº¥t tÆ°Æ¡ng Ä‘á»‘i tá»‘t, Ä‘áº·c biá»‡t lÃ  khi Ä‘Æ°á»£c triá»ƒn khai trÃªn pháº§n cá»©ng.
	- TiÃªu chuáº©n quá»‘c táº¿: AES lÃ  má»™t tiÃªu chuáº©n mÃ£ hÃ³a Ä‘Æ°á»£c cÃ´ng nháº­n trÃªn toÃ n cáº§u, giÃºp Ä‘áº£m báº£o kháº£ nÄƒng tÆ°Æ¡ng tÃ¡c vÃ  tÃ­nh báº£o máº­t nháº¥t quÃ¡n.
	- ÄÆ°á»£c nghiÃªn cá»©u ká»¹ lÆ°á»¡ng: AES Ä‘Ã£ Ä‘Æ°á»£c nghiÃªn cá»©u vÃ  kiá»ƒm tra ká»¹ lÆ°á»¡ng trong nhiá»u nÄƒm, giÃºp Ä‘áº£m báº£o tÃ­nh báº£o máº­t cá»§a nÃ³. 
- NhÆ°á»£c Ä‘iá»ƒm:
	- Äá»™ phá»©c táº¡p: Viá»‡c triá»ƒn khai vÃ  quáº£n lÃ½ AES cÃ³ thá»ƒ phá»©c táº¡p, Ä‘áº·c biá»‡t lÃ  Ä‘á»‘i vá»›i cÃ¡c há»‡ thá»‘ng lá»›n hoáº·c phá»©c táº¡p.
	- YÃªu cáº§u vá» pháº§n cá»©ng: Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t tá»‘i Æ°u, AES cÃ³ thá»ƒ yÃªu cáº§u pháº§n cá»©ng chuyÃªn dá»¥ng hoáº·c cÃ¡c bá»™ xá»­ lÃ½ há»— trá»£ mÃ£ hÃ³a AES.
	- Váº¥n Ä‘á» quáº£n lÃ½ khÃ³a: Quáº£n lÃ½ khÃ³a mÃ£ hÃ³a AES lÃ  má»™t yáº¿u tá»‘ quan trá»ng vÃ  cÃ³ thá»ƒ gÃ¢y ra cÃ¡c váº¥n Ä‘á» báº£o máº­t náº¿u khÃ´ng Ä‘Æ°á»£c thá»±c hiá»‡n Ä‘Ãºng cÃ¡ch.
	- Táº¥n cÃ´ng kÃªnh phá»¥: Máº·c dÃ¹ AES lÃ  máº¡nh máº½, nÃ³ váº«n cÃ³ thá»ƒ bá»‹ táº¥n cÃ´ng thÃ´ng qua cÃ¡c kÃªnh phá»¥ nhÆ° phÃ¢n tÃ­ch thá»i gian hoáº·c phÃ¢n tÃ­ch nÄƒng lÆ°á»£ng. 

##### 3DES
- Triple DES lÃ  má»™t thuáº­t toÃ¡n mÃ£ hÃ³a Ä‘Æ°á»£c phÃ¡t triá»ƒn dá»±a trÃªn TiÃªu chuáº©n MÃ£ hÃ³a Dá»¯ liá»‡u (DES) ban Ä‘áº§u. ÄÃ¢y lÃ  thuáº­t toÃ¡n mÃ£ hÃ³a Ä‘á»‘i xá»©ng sá»­ dá»¥ng nhiá»u vÃ²ng DES Ä‘á»ƒ tÄƒng cÆ°á»ng báº£o máº­t. NÃ³ cÃ³ tÃªn lÃ  "Triple DES" vÃ¬ sá»­ dá»¥ng cÆ¡ cháº¿ DES ba láº§n Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u. Vá» báº£n cháº¥t, Ä‘Ã¢y lÃ  má»™t thuáº­t toÃ¡n mÃ£ khá»‘i, hoáº¡t Ä‘á»™ng vá»›i khá»‘i dá»¯ liá»‡u 64 bit. Vá» máº·t báº£o máº­t, Triple DES vÆ°á»£t trá»™i hÆ¡n so vá»›i DES gá»‘c, nhÆ°ng hiá»‡u suáº¥t tháº¥p hÆ¡n vÃ  cháº­m hÆ¡n so vá»›i Chuáº©n MÃ£ hÃ³a NÃ¢ng cao (AES).
- Äáº·c Ä‘iá»ƒm cá»§a Triple DES
	- Ãp dá»¥ng mÃ£ hÃ³a ba lá»›p, nghÄ©a lÃ  sá»­ dá»¥ng ba khÃ³a khÃ¡c nhau Ä‘á»ƒ mÃ£ hÃ³a plaintext ba láº§n.
	- Há»— trá»£ kÃ­ch thÆ°á»›c khÃ³a linh hoáº¡t, tá»« 128 bit Ä‘áº¿n 192 bit.
	- Sá»­ dá»¥ng há»‡ mÃ£ hÃ³a Ä‘á»‘i xá»©ng, tá»©c lÃ  cÃ¹ng má»™t khÃ³a Ä‘Æ°á»£c dÃ¹ng cho cáº£ mÃ£ hÃ³a vÃ  giáº£i mÃ£.
	- LÃ  thuáº­t toÃ¡n mÃ£ khá»‘i hoáº¡t Ä‘á»™ng vá»›i cÃ¡c khá»‘i plaintext cÃ³ kÃ­ch thÆ°á»›c 64 bit.
	- PhÃ¹ há»£p vá»›i cÃ¡c há»‡ thá»‘ng cÅ© cáº§n mÃ£ hÃ³a báº£o máº­t nhÆ°ng chÆ°a thá»ƒ chuyá»ƒn sang cÃ´ng nghá»‡ má»›i hÆ¡n.
- Quy trÃ¬nh mÃ£ hÃ³a Triple DES
	- Táº¡o khÃ³a (Key Generation): ÄÃ¢y lÃ  bÆ°á»›c Ä‘áº§u tiÃªn trong quÃ¡ trÃ¬nh mÃ£ hÃ³a cá»§a Triple DES. Trong bÆ°á»›c nÃ y, ba khÃ³a riÃªng biá»‡t Ä‘Æ°á»£c táº¡o ra báº±ng thuáº­t toÃ¡n dáº«n xuáº¥t khÃ³a.
	- HoÃ¡n vá»‹ ban Ä‘áº§u (Initial Permutation): Sau khi táº¡o khÃ³a, cÃ¡c bit cá»§a plaintext sáº½ Ä‘Æ°á»£c sáº¯p xáº¿p láº¡i theo má»™t báº£ng hoÃ¡n vá»‹ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a sáºµn.
	- Ba vÃ²ng mÃ£ hÃ³a (Three Rounds of Encryption): ÄÃ¢y Ä‘Æ°á»£c xem lÃ  giai Ä‘oáº¡n quan trá»ng nháº¥t. ToÃ n bá»™ quÃ¡ trÃ¬nh thÆ°á»ng gá»“m 48 vÃ²ng biáº¿n Ä‘á»•i. Plaintext sáº½ Ä‘Æ°á»£c xá»­ lÃ½ ba láº§n, má»—i láº§n sá»­ dá»¥ng má»™t khÃ³a khÃ¡c nhau, táº¡o nÃªn ba lá»›p mÃ£ hÃ³a liÃªn tiáº¿p.
	- HoÃ¡n vá»‹ cuá»‘i cÃ¹ng (Final Permutation): Káº¿t thÃºc quÃ¡ trÃ¬nh mÃ£ hÃ³a Triple DES. Khá»‘i ciphertext cuá»‘i cÃ¹ng Ä‘Æ°á»£c xá»­ lÃ½ thÃ´ng qua bÆ°á»›c hoÃ¡n vá»‹ cuá»‘i â€“ lÃ  phÃ©p Ä‘áº£o ngÆ°á»£c cá»§a hoÃ¡n vá»‹ ban Ä‘áº§u â€“ nháº±m tráº£ cÃ¡c bit vá» Ä‘Ãºng tráº­t tá»± mong muá»‘n.
- 3DES tÄƒng cÆ°á»ng báº£o máº­t cá»§a DES báº±ng cÃ¡ch sá»­ dá»¥ng khÃ´ng pháº£i má»™t, khÃ´ng pháº£i hai, mÃ  lÃ  ba khÃ³a DES cÃ³ Ä‘á»™ dÃ i 56 bit. Thuáº­t toÃ¡n mÃ£ hÃ³a 3DES Ä‘Æ°á»£c mÃ´ táº£ nhÆ° sau, trong Ä‘Ã³ K1, K2 vÃ  K3 lÃ  ba khÃ³a 56-bit:
	- Thuáº­t toÃ¡n mÃ£ hÃ³a 3DES
		- MÃ£ hÃ³a plaintext báº±ng thuáº­t toÃ¡n DES vá»›i khÃ³a K1.
		- Giáº£i mÃ£ káº¿t quáº£ thu Ä‘Æ°á»£c báº±ng thuáº­t toÃ¡n DES vá»›i khÃ³a K2.
		- MÃ£ hÃ³a láº¡i káº¿t quáº£ báº±ng thuáº­t toÃ¡n DES vá»›i khÃ³a K3.
		â†’ Káº¿t quáº£ cuá»‘i cÃ¹ng lÃ  ciphertext cá»§a 3DES.
	- Thuáº­t toÃ¡n giáº£i mÃ£ 3DES
		- Giáº£i mÃ£ ciphertext báº±ng thuáº­t toÃ¡n DES vá»›i khÃ³a K3.
		- MÃ£ hÃ³a káº¿t quáº£ vá»«a giáº£i mÃ£ báº±ng DES vá»›i khÃ³a K2.
		- Giáº£i mÃ£ káº¿t quáº£ Ä‘Ã³ báº±ng DES vá»›i khÃ³a K1.
		â†’ Káº¿t quáº£ cuá»‘i cÃ¹ng lÃ  phá»¥c há»“i láº¡i plaintext ban Ä‘áº§u.
- Æ¯u Ä‘iá»ƒm:
	- Báº£o máº­t nÃ¢ng cao: 3DES cung cáº¥p má»©c Ä‘á»™ báº£o máº­t tá»‘t hÆ¡n so vá»›i thuáº­t toÃ¡n DES gá»‘c báº±ng cÃ¡ch Ã¡p dá»¥ng DES ba láº§n vá»›i cÃ¡c khÃ³a khÃ¡c nhau, giÃºp chá»‘ng láº¡i cÃ¡c cuá»™c táº¥n cÃ´ng vÃ©t cáº¡n (brute-force) hiá»‡u quáº£ hÆ¡n.
	- TÆ°Æ¡ng thÃ­ch vá»›i há»‡ thá»‘ng cÅ©: 3DES tá»«ng Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i vÃ  váº«n tÆ°Æ¡ng thÃ­ch vá»›i nhiá»u há»‡ thá»‘ng hoáº·c giao thá»©c cÅ©.
	- Chá»‘ng láº¡i má»™t sá»‘ hÃ¬nh thá»©c táº¥n cÃ´ng: Nhá» cáº¥u trÃºc ba lá»›p khÃ³a, 3DES cÃ³ kháº£ nÄƒng chá»‘ng láº¡i cÃ¡c phÆ°Æ¡ng phÃ¡p phÃ¢n tÃ­ch máº­t mÃ£ cá»• Ä‘iá»ƒn nhÆ° phÃ¢n tÃ­ch sai biá»‡t (differential) vÃ  tuyáº¿n tÃ­nh (linear).
- NhÆ°á»£c Ä‘iá»ƒm:
	- Hiá»‡u suáº¥t cháº­m: 3DES thá»±c hiá»‡n thuáº­t toÃ¡n DES ba láº§n trÃªn má»—i khá»‘i dá»¯ liá»‡u, khiáº¿n nÃ³ cháº­m hÆ¡n Ä‘Ã¡ng ká»ƒ so vá»›i cÃ¡c thuáº­t toÃ¡n hiá»‡n Ä‘áº¡i nhÆ° AES.
	- Háº¡n cháº¿ Ä‘á»™ dÃ i khÃ³a thá»±c táº¿: Máº·c dÃ¹ sá»­ dá»¥ng tá»•ng cá»™ng 168 bit (3 khÃ³a DES 56 bit), Ä‘á»™ dÃ i khÃ³a hiá»‡u dá»¥ng bá»‹ giáº£m xuá»‘ng cÃ²n khoáº£ng 112 bit do lá»— há»•ng meet-in-the-middle.
	- Dá»… bá»‹ táº¥n cÃ´ng lÆ°á»£ng tá»­: CÅ©ng giá»‘ng nhÆ° DES, 3DES dá»… bá»‹ tá»•n thÆ°Æ¡ng trÆ°á»›c cÃ¡c cuá»™c táº¥n cÃ´ng báº±ng mÃ¡y tÃ­nh lÆ°á»£ng tá»­.
	- Bá»‹ loáº¡i bá» bá»Ÿi NIST: Viá»‡n TiÃªu chuáº©n vÃ  CÃ´ng nghá»‡ Quá»‘c gia Hoa Ká»³ (NIST) Ä‘Ã£ chÃ­nh thá»©c ngá»«ng khuyáº¿n nghá»‹ sá»­ dá»¥ng 3DES vÃ  Ä‘á» xuáº¥t chuyá»ƒn sang cÃ¡c thuáº­t toÃ¡n máº¡nh hÆ¡n nhÆ° AES.
	- KhÃ´ng phÃ¹ há»£p cho á»©ng dá»¥ng má»›i: Do hiá»‡u suáº¥t tháº¥p vÃ  khÃ´ng Ä‘Ã¡p á»©ng Ä‘Æ°á»£c yÃªu cáº§u báº£o máº­t hiá»‡n Ä‘áº¡i, 3DES khÃ´ng cÃ²n Ä‘Æ°á»£c khuyáº¿n nghá»‹ cho cÃ¡c há»‡ thá»‘ng má»›i, vÃ  Ä‘ang dáº§n Ä‘Æ°á»£c thay tháº¿ bá»Ÿi cÃ¡c thuáº­t toÃ¡n mÃ£ hÃ³a hiá»‡n Ä‘áº¡i, hiá»‡u quáº£ hÆ¡n.

##### ChaCha20
- ChaCha20 lÃ  má»™t thuáº­t toÃ¡n mÃ£ hÃ³a dÃ²ng (stream cipher) 256-bit Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi Daniel J. Bernstein. NÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u trá»±c tuyáº¿n, nhÆ° email, tin nháº¯n, lÆ°u lÆ°á»£ng truy cáº­p web vÃ  cÃ¡c tá»‡p táº£i lÃªn Ä‘Ã¡m mÃ¢y. ChaCha20 Ä‘Æ°á»£c biáº¿t Ä‘áº¿n vá»›i hiá»‡u suáº¥t cao vÃ  kháº£ nÄƒng báº£o máº­t máº¡nh máº½, Ä‘áº·c biá»‡t lÃ  khi káº¿t há»£p vá»›i Poly1305 Ä‘á»ƒ táº¡o thÃ nh ChaCha20-Poly1305, má»™t há»‡ mÃ£ hÃ³a dÃ²ng cÃ³ xÃ¡c thá»±c. 
- Äáº·c Ä‘iá»ƒm ná»•i báº­t cá»§a ChaCha20
	- LÃ  má»™t thuáº­t toÃ¡n mÃ£ hÃ³a Ä‘á»‘i xá»©ng (symmetric key encryption).
	- Thiáº¿t káº¿ Ä‘Æ¡n giáº£n vÃ  dá»… triá»ƒn khai, giÃºp nhanh hÆ¡n AES trong nhiá»u trÆ°á»ng há»£p.
	- Ná»•i tiáº¿ng vá»›i tÃ­nh báº£o máº­t cao vÃ  tá»‘c Ä‘á»™ xá»­ lÃ½ nhanh.
	- Táº¡o ra má»™t chuá»—i bit giáº£ ngáº«u nhiÃªn gá»i lÃ  key-stream, sau Ä‘Ã³ XOR vá»›i plaintext Ä‘á»ƒ táº¡o ra ciphertext.
	- ÄÆ°á»£c há»— trá»£ rá»™ng rÃ£i trong nhiá»u ná»n táº£ng vÃ  giao thá»©c hiá»‡n Ä‘áº¡i.
- ChaCha20 lÃ  má»™t mÃ£ dÃ²ng (stream cipher). Äáº§u vÃ o cá»§a nÃ³ bao gá»“m: má»™t khÃ³a 256 bit, má»™t bá»™ Ä‘áº¿m 32 bit, má»™t nonce 96 bit vÃ  plaintext.
	- Tráº¡ng thÃ¡i khá»Ÿi táº¡o ban Ä‘áº§u lÃ  má»™t ma tráº­n 4Ã—4 gá»“m cÃ¡c tá»« 32 bit:
		- HÃ ng Ä‘áº§u tiÃªn lÃ  chuá»—i háº±ng sá»‘ "expand 32-byte k" Ä‘Æ°á»£c chia thÃ nh 4 tá»« 32 bit.
		- HÃ ng thá»© hai vÃ  thá»© ba chá»©a khÃ³a 256 bit (tá»©c lÃ  8 tá»« 32 bit).
		- HÃ ng cuá»‘i cÃ¹ng gá»“m: tá»« Ä‘áº§u lÃ  bá»™ Ä‘áº¿m 32 bit, ba tá»« cÃ²n láº¡i lÃ  nonce 96 bit.
	- ChaCha20 táº¡o ra má»™t keystream dÃ i 512 bit trong má»—i vÃ²ng láº·p Ä‘á»ƒ mÃ£ hÃ³a má»™t khá»‘i plaintext 512 bit.
	- Khi pháº§n cÃ²n láº¡i cá»§a plaintext nhá» hÆ¡n 512 bit sau nhiá»u láº§n mÃ£ hÃ³a, cáº§n Ä‘á»‡m thÃªm cÃ¡c bit 0 vÃ o bÃªn trÃ¡i (bit cÃ³ trá»ng sá»‘ cao â€“ MSB) trong dá»¯ liá»‡u Ä‘áº§u vÃ o cuá»‘i cÃ¹ng, vÃ  loáº¡i bá» sá»‘ bit tÆ°Æ¡ng á»©ng khÃ´ng cáº§n thiáº¿t khá»i dá»¯ liá»‡u Ä‘áº§u ra cuá»‘i cÃ¹ng.
	- QuÃ¡ trÃ¬nh mÃ£ hÃ³a vÃ  giáº£i mÃ£ lÃ  giá»‘ng nhau, miá»…n lÃ  sá»­ dá»¥ng cÃ¹ng má»™t khÃ³a, bá»™ Ä‘áº¿m vÃ  nonce ban Ä‘áº§u.
- Quy trÃ¬nh mÃ£ hÃ³a ChaCha20:
	- Táº¡o khÃ³a (Key Generation): Thuáº­t toÃ¡n ChaCha20 táº¡o ra má»™t khÃ³a 256 bit tá»« khÃ³a do ngÆ°á»i dÃ¹ng cung cáº¥p vÃ  má»™t nonce 96 bit Ä‘Æ°á»£c táº¡o ngáº«u nhiÃªn.
	- Khá»Ÿi táº¡o (Initialization): Thuáº­t toÃ¡n sá»­ dá»¥ng khÃ³a vÃ  nonce Ä‘á»ƒ khá»Ÿi táº¡o tráº¡ng thÃ¡i ná»™i bá»™ cá»§a bá»™ mÃ£ hÃ³a.
	- MÃ£ hÃ³a dá»¯ liá»‡u (Data Encryption): ChaCha20 mÃ£ hÃ³a tá»«ng khá»‘i dá»¯ liá»‡u báº±ng tráº¡ng thÃ¡i hiá»‡n táº¡i cá»§a bá»™ mÃ£, vÃ  tráº¡ng thÃ¡i nÃ y Ä‘Æ°á»£c cáº­p nháº­t sau má»—i khá»‘i.
	- Xuáº¥t káº¿t quáº£ (Output): Ciphertext Ä‘Æ°á»£c táº¡o ra báº±ng cÃ¡ch thá»±c hiá»‡n phÃ©p XOR giá»¯a plaintext vÃ  Ä‘áº§u ra cá»§a bÆ°á»›c mÃ£ hÃ³a dá»¯ liá»‡u.
- Káº¿t há»£p vá»›i Poly1305 táº¡o thÃ nh ChaCha20-Poly1305 lÃ  má»™t thuáº­t toÃ¡n mÃ£ hÃ³a xÃ¡c thá»±c dá»¯ liá»‡u liÃªn káº¿t (AEAD), káº¿t há»£p thuáº­t toÃ¡n mÃ£ dÃ²ng ChaCha20 vÃ  mÃ£ xÃ¡c thá»±c thÃ´ng bÃ¡o Poly1305. NÃ³ cung cáº¥p tÃ­nh báº£o máº­t vÃ  xÃ¡c thá»±c, thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c giao thá»©c báº£o máº­t nhÆ° TLS 1.3 vÃ  WireGuard. 
	- ChaCha20: Má»™t thuáº­t toÃ¡n mÃ£ dÃ²ng, táº¡o ra má»™t chuá»—i cÃ¡c byte ngáº«u nhiÃªn Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u. 
	- Poly1305: Má»™t thuáº­t toÃ¡n mÃ£ xÃ¡c thá»±c thÃ´ng bÃ¡o, táº¡o ra má»™t mÃ£ tag Ä‘á»ƒ xÃ¡c thá»±c tÃ­nh toÃ n váº¹n cá»§a dá»¯ liá»‡u. 
- AEAD: ChaCha20-Poly1305 lÃ  má»™t thuáº­t toÃ¡n AEAD, cÃ³ nghÄ©a lÃ  nÃ³ khÃ´ng chá»‰ mÃ£ hÃ³a dá»¯ liá»‡u mÃ  cÃ²n táº¡o ra má»™t mÃ£ tag Ä‘á»ƒ xÃ¡c minh ráº±ng dá»¯ liá»‡u khÃ´ng bá»‹ thay Ä‘á»•i trong quÃ¡ trÃ¬nh truyá»n. 
- CÃ¡ch hoáº¡t Ä‘á»™ng: Thuáº­t toÃ¡n nÃ y sá»­ dá»¥ng má»™t khÃ³a 256-bit vÃ  má»™t sá»‘ ngáº«u nhiÃªn (nonce) 96-bit. Dá»¯ liá»‡u liÃªn káº¿t (náº¿u cÃ³) vÃ  dá»¯ liá»‡u cáº§n mÃ£ hÃ³a Ä‘Æ°á»£c Ä‘Æ°a vÃ o thuáº­t toÃ¡n ChaCha20 Ä‘á»ƒ táº¡o ra dá»¯ liá»‡u Ä‘Ã£ mÃ£ hÃ³a. Sau Ä‘Ã³, dá»¯ liá»‡u Ä‘Ã£ mÃ£ hÃ³a vÃ  dá»¯ liá»‡u liÃªn káº¿t (náº¿u cÃ³) Ä‘Æ°á»£c Ä‘Æ°a vÃ o thuáº­t toÃ¡n Poly1305 Ä‘á»ƒ táº¡o ra mÃ£ tag xÃ¡c thá»±c. 
- á»¨ng dá»¥ng: ChaCha20-Poly1305 Ä‘Æ°á»£c sá»­ dá»¥ng trong nhiá»u giao thá»©c báº£o máº­t nhÆ° TLS 1.3, WireGuard, S/MIME v4. NÃ³ thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng trong mÃ´i trÆ°á»ng mÃ  viá»‡c tÄƒng tá»‘c pháº§n cá»©ng cho AES khÃ´ng cÃ³ sáºµn, vÃ¬ nÃ³ cÃ³ thá»ƒ nhanh hÆ¡n AES-GCM trong cÃ¡c trÆ°á»ng há»£p nhÆ° váº­y. 
- Báº£o máº­t: ChaCha20-Poly1305 Ä‘Æ°á»£c coi lÃ  má»™t thuáº­t toÃ¡n an toÃ n, tuy nhiÃªn, viá»‡c sá»­ dá»¥ng Ä‘Ãºng cÃ¡ch lÃ  ráº¥t quan trá»ng, Ä‘áº·c biá»‡t lÃ  viá»‡c sá»­ dá»¥ng nonce khÃ´ng Ä‘Æ°á»£c láº·p láº¡i cho cÃ¹ng má»™t khÃ³a. 
### 3.4 Cáº¥u trÃºc cá»§a chá»©ng chá»‰ SSL (Common Name, SAN, Issuer, Validity Period).
- Chá»©ng chá»‰ SSL vá» báº£n cháº¥t lÃ  má»™t chá»©ng chá»‰ X.509. X.509 lÃ  má»™t tiÃªu chuáº©n xÃ¡c Ä‘á»‹nh cáº¥u trÃºc cá»§a chá»©ng chá»‰, bao gá»“m cÃ¡c trÆ°á»ng dá»¯ liá»‡u cáº§n cÃ³ trong chá»©ng chá»‰ SSL. X.509 sá»­ dá»¥ng má»™t ngÃ´n ngá»¯ hÃ¬nh thá»©c gá»i lÃ  Abstract Syntax Notation One (ASN.1) Ä‘á»ƒ biá»ƒu diá»…n cáº¥u trÃºc dá»¯ liá»‡u cá»§a chá»©ng chá»‰.
- CÃ³ nhiá»u Ä‘á»‹nh dáº¡ng khÃ¡c nhau cá»§a chá»©ng chá»‰ X.509 nhÆ° PEM, DER, PKCS#7 vÃ  PKCS#12. CÃ¡c Ä‘á»‹nh dáº¡ng PEM vÃ  PKCS#7 sá»­ dá»¥ng mÃ£ hÃ³a ASCII dáº¡ng Base64, trong khi DER vÃ  PKCS#12 sá»­ dá»¥ng mÃ£ hÃ³a nhá»‹ phÃ¢n. CÃ¡c tá»‡p chá»©ng chá»‰ cÃ³ pháº§n má»Ÿ rá»™ng khÃ¡c nhau tÃ¹y theo Ä‘á»‹nh dáº¡ng vÃ  kiá»ƒu mÃ£ hÃ³a Ä‘Æ°á»£c sá»­ dá»¥ng.
- `X.509` lÃ  má»™t Ä‘á»‹nh dáº¡ng chuáº©n cho chá»©ng chá»‰ khÃ³a cÃ´ng khai, cÃ¡c tÃ i liá»‡u ká»¹ thuáº­t sá»‘ liÃªn káº¿t an toÃ n cÃ¡c cáº·p khÃ³a máº­t mÃ£ vá»›i cÃ¡c danh tÃ­nh nhÆ° trang web, cÃ¡ nhÃ¢n hoáº·c tá»• chá»©c.
- ÄÆ°á»£c giá»›i thiá»‡u láº§n Ä‘áº§u tiÃªn vÃ o nÄƒm 1988 cÃ¹ng vá»›i tiÃªu chuáº©n X.500 cho cÃ¡c dá»‹ch vá»¥ thÆ° má»¥c Ä‘iá»‡n tá»­, X.509 Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh Ä‘á»ƒ sá»­ dá»¥ng internet bá»Ÿi CÆ¡ sá»Ÿ háº¡ táº§ng khÃ³a cÃ´ng khai cá»§a IETF (X.509) (PKIX) nhÃ³m lÃ m viá»‡c. RFC 5280 cáº¥u hÃ¬nh chá»©ng chá»‰ X.509 v3, danh sÃ¡ch thu há»“i chá»©ng chá»‰ X.509 v2 (CRL) vÃ  mÃ´ táº£ thuáº­t toÃ¡n Ä‘á»ƒ xÃ¡c thá»±c Ä‘Æ°á»ng dáº«n chá»©ng chá»‰ X.509.
- CÃ¡c thÃ nh pháº§n cá»§a chá»©ng chá»‰ X.509:
	- Version â€“ PhiÃªn báº£n cá»§a tiÃªu chuáº©n X.509 (thÆ°á»ng lÃ  v3).
	- Serial Number â€“ Sá»‘ Ä‘á»‹nh danh duy nháº¥t cá»§a chá»©ng chá»‰.
	- Signature Algorithm â€“ Thuáº­t toÃ¡n dÃ¹ng Ä‘á»ƒ kÃ½ chá»©ng chá»‰ (vÃ­ dá»¥: SHA256withRSA).
	- Issuer â€“ Tá»• chá»©c phÃ¡t hÃ nh chá»©ng chá»‰ (CA).
	- Validity Period
	- Not Before: NgÃ y báº¯t Ä‘áº§u hiá»‡u lá»±c
	- Not After: NgÃ y háº¿t háº¡n
	- Subject â€“ ThÃ´ng tin cá»§a thá»±c thá»ƒ sá»Ÿ há»¯u chá»©ng chá»‰ (tÃªn miá»n, tá»• chá»©c, v.v.)
	- Subject Public Key Info
	- Thuáº­t toÃ¡n khÃ³a cÃ´ng khai
	- GiÃ¡ trá»‹ khÃ³a cÃ´ng khai
	- Extensions (chá»‰ cÃ³ á»Ÿ v3)
	- Subject Alternative Name (SAN)
	- Key Usage
	- Extended Key Usage
	- Basic Constraints
	- VÃ  nhiá»u má»¥c khÃ¡c tÃ¹y theo má»¥c Ä‘Ã­ch sá»­ dá»¥ng
	- Signature â€“ Chá»¯ kÃ½ sá»‘ cá»§a CA Ä‘á»ƒ xÃ¡c thá»±c chá»©ng chá»‰.
- Cá»¥ thá»ƒ cáº§n chÃº Ã½ tá»›i 
- Common Name (CN) náº±m bÃªn trong pháº§n Subject â€” pháº§n mÃ´ táº£ danh tÃ­nh cá»§a thá»±c thá»ƒ sá»Ÿ há»¯u chá»©ng chá»‰: LÃ  tÃªn miá»n chÃ­nh mÃ  chá»©ng chá»‰ báº£o vá»‡. VÃ­ dá»¥: www.example.com. TrÃ¬nh duyá»‡t sáº½ kiá»ƒm tra tÃªn miá»n truy cáº­p cÃ³ khá»›p vá»›i CN khÃ´ng (hoáº·c vá»›i SAN náº¿u cÃ³). Trong cÃ¡c chá»©ng chá»‰ hiá»‡n Ä‘áº¡i, CN thÆ°á»ng chá»‰ mang tÃ­nh tham kháº£o vÃ¬ trÃ¬nh duyá»‡t Æ°u tiÃªn kiá»ƒm tra SAN.
- Subject Alternative Name (SAN): LÃ  pháº§n má»Ÿ rá»™ng cho phÃ©p chá»©ng chá»‰ báº£o vá»‡ nhiá»u tÃªn miá»n hoáº·c Ä‘á»‹a chá»‰ IP cÃ¹ng lÃºc. VÃ­ dá»¥: example.com, www.example.com, mail.example.com. ÄÃ¢y lÃ  trÆ°á»ng Ä‘Æ°á»£c Æ°u tiÃªn kiá»ƒm tra trong xÃ¡c thá»±c tÃªn miá»n hiá»‡n nay.
- Issuer: LÃ  tá»• chá»©c phÃ¡t hÃ nh chá»©ng chá»‰ (Certificate Authority â€“ CA), vÃ­ dá»¥: DigiCert, Let's Encrypt, GlobalSign. TrÆ°á»ng nÃ y xÃ¡c Ä‘á»‹nh ai lÃ  ngÆ°á»i cáº¥p chá»©ng chá»‰ vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ xÃ¡c minh Ä‘á»™ tin cáº­y cá»§a chá»©ng chá»‰.
- Validity Period: Khoáº£ng thá»i gian chá»©ng chá»‰ cÃ³ hiá»‡u lá»±c, bao gá»“m:
	- Not Before: ngÃ y báº¯t Ä‘áº§u cÃ³ hiá»‡u lá»±c
	- Not After: ngÃ y háº¿t háº¡n
	- ThÃ´ng thÆ°á»ng, chá»©ng chá»‰ SSL cÃ³ thá»i háº¡n tá»« vÃ i thÃ¡ng Ä‘áº¿n tá»‘i Ä‘a 13 thÃ¡ng (theo quy Ä‘á»‹nh má»›i cá»§a CA/B Forum).
- ![images](./images/s-2.png)

### 3.5 CÃ¡c phÆ°Æ¡ng phÃ¡p xÃ¡c minh chá»©ng chá»‰ SSL
- Chá»©ng chá»‰ SSL/TLS Ä‘Æ°á»£c xÃ¡c minh thÃ´ng qua má»™t quy trÃ¬nh nhiá»u bÆ°á»›c nháº±m Ä‘áº£m báº£o danh tÃ­nh cá»§a website vÃ  mÃ£ hÃ³a dá»¯ liá»‡u trao Ä‘á»•i giá»¯a trÃ¬nh duyá»‡t vÃ  mÃ¡y chá»§. CÃ¡c bÆ°á»›c chÃ­nh bao gá»“m xÃ¡c thá»±c chá»©ng chá»‰, kiá»ƒm tra chuá»—i chá»©ng chá»‰, xÃ¡c minh tÃªn miá»n vÃ  (tÃ¹y chá»n) kiá»ƒm tra tráº¡ng thÃ¡i thu há»“i. Cá»¥ thá»ƒ:
	- XÃ¡c thá»±c chá»©ng chá»‰:
		- Máº­t mÃ£ khÃ³a cÃ´ng khai: TrÃ¬nh duyá»‡t táº£i chá»©ng chá»‰ tá»« mÃ¡y chá»§, trong Ä‘Ã³ chá»©a khÃ³a cÃ´ng khai.
		- XÃ¡c minh chá»¯ kÃ½: TrÃ¬nh duyá»‡t sá»­ dá»¥ng khÃ³a cÃ´ng khai cá»§a CA Ä‘á»ƒ giáº£i mÃ£ chá»¯ kÃ½ sá»‘ trÃªn chá»©ng chá»‰ vÃ  so sÃ¡nh vá»›i ná»™i dung chá»©ng chá»‰.
		- CA gá»‘c Ä‘Ã¡ng tin cáº­y: TrÃ¬nh duyá»‡t kiá»ƒm tra xem CA phÃ¡t hÃ nh chá»©ng chá»‰ cÃ³ náº±m trong danh sÃ¡ch CA tin cáº­y Ä‘Æ°á»£c cÃ i sáºµn hay khÃ´ng.
	- Kiá»ƒm tra chuá»—i chá»©ng chá»‰:
		- Chuá»—i tin cáº­y: Chá»©ng chá»‰ mÃ¡y chá»§ thÆ°á»ng lÃ  má»™t pháº§n cá»§a chuá»—i gá»“m chá»©ng chá»‰ trung gian vÃ  chá»©ng chá»‰ gá»‘c.
		- XÃ¡c minh chuá»—i: TrÃ¬nh duyá»‡t xÃ¡c thá»±c tá»«ng chá»©ng chá»‰ trong chuá»—i cho Ä‘áº¿n khi Ä‘áº¡t Ä‘áº¿n CA gá»‘c Ä‘Ã¡ng tin cáº­y.
	- XÃ¡c minh tÃªn miá»n:
		- So khá»›p tÃªn miá»n: TrÃ¬nh duyá»‡t so sÃ¡nh tÃªn miá»n truy cáº­p vá»›i Common Name (CN) hoáº·c Subject Alternative Name (SAN) trong chá»©ng chá»‰.
		- XÃ¡c minh quyá»n sá»Ÿ há»¯u: Äáº£m báº£o chá»©ng chá»‰ thá»±c sá»± Ä‘Æ°á»£c cáº¥p cho website mÃ  ngÆ°á»i dÃ¹ng Ä‘ang truy cáº­p.
	- Kiá»ƒm tra tráº¡ng thÃ¡i thu há»“i (tÃ¹y chá»n): TrÃ¬nh duyá»‡t cÃ³ thá»ƒ kiá»ƒm tra xem chá»©ng chá»‰ cÃ³ bá»‹ thu há»“i trÆ°á»›c thá»i háº¡n hay khÃ´ng thÃ´ng qua OCSP hoáº·c CRL.
	- Thiáº¿t láº­p káº¿t ná»‘i an toÃ n:
		- MÃ£ hÃ³a: Náº¿u táº¥t cáº£ bÆ°á»›c trÃªn há»£p lá»‡, trÃ¬nh duyá»‡t vÃ  mÃ¡y chá»§ thiáº¿t láº­p káº¿t ná»‘i Ä‘Æ°á»£c mÃ£ hÃ³a.
		- Táº£i trang an toÃ n: TrÃ¬nh duyá»‡t hiá»ƒn thá»‹ biá»ƒu tÆ°á»£ng á»• khÃ³a Ä‘á»ƒ bÃ¡o hiá»‡u káº¿t ná»‘i báº£o máº­t.

## 4. NhÃ  cung cáº¥p chá»©ng chá»‰ (CA â€“ Certificate Authority)
### 4.1 CÃ¡c CA uy tÃ­n:
- CÃ¡c CA Ä‘Ã³ng vai trÃ² trung tÃ¢m trong háº¡ táº§ng khÃ³a cÃ´ng khai (PKI) báº±ng cÃ¡ch phÃ¡t hÃ nh vÃ  quáº£n lÃ½ chá»©ng chá»‰ sá»‘. 
- Sectigo
	- Tiá»n thÃ¢n lÃ  Comodo CA, Ä‘á»•i tÃªn thÃ nh Sectigo vÃ o nÄƒm 2018.
	- PhÃ¡t hÃ nh nhiá»u chá»©ng chá»‰ SSL cho cÃ¡ nhÃ¢n, doanh nghiá»‡p vÃ  tá»• chá»©c chÃ­nh phá»§.
	- Há»— trá»£ Ä‘áº§y Ä‘á»§ cÃ¡c loáº¡i chá»©ng chá»‰: DV, OV, EV, Wildcard, Multi-Domain.
	- ÄÆ°á»£c cÃ¡c ná»n táº£ng hosting vÃ  control panel tÃ­ch há»£p rá»™ng rÃ£i.
- DigiCert
	- CA thÆ°Æ¡ng máº¡i lá»›n, cÃ³ Ä‘á»™ tin cáº­y cao trong lÄ©nh vá»±c báº£o máº­t sá»‘.
	- LÃ  nhÃ  cung cáº¥p cá»§a cÃ¡c thÆ°Æ¡ng hiá»‡u chá»©ng chá»‰ nhÆ° GeoTrust, Thawte vÃ  RapidSSL.
	- ÄÆ°á»£c sá»­ dá»¥ng phá»• biáº¿n trong cÃ¡c há»‡ thá»‘ng doanh nghiá»‡p, ngÃ¢n hÃ ng, vÃ  chÃ­nh phá»§.
	- Cung cáº¥p cÃ´ng cá»¥ quáº£n lÃ½ vÃ²ng Ä‘á»i chá»©ng chá»‰ chuyÃªn nghiá»‡p.
- GlobalSign
	- CA lÃ¢u Ä‘á»i cÃ³ nguá»“n gá»‘c tá»« Nháº­t Báº£n, Ä‘Æ°á»£c cÃ´ng nháº­n quá»‘c táº¿.
	- Táº­p trung vÃ o khÃ¡ch hÃ ng doanh nghiá»‡p vÃ  dá»‹ch vá»¥ PKI quy mÃ´ lá»›n.
	- Há»— trá»£ cáº¥p chá»©ng chá»‰ tá»± Ä‘á»™ng qua API, quáº£n lÃ½ táº­p trung vÃ  triá»ƒn khai linh hoáº¡t.
- Let's Encrypt
	- CA phi lá»£i nhuáº­n do Internet Security Research Group (ISRG) váº­n hÃ nh.
	- PhÃ¡t hÃ nh chá»©ng chá»‰ miá»…n phÃ­, tá»± Ä‘á»™ng, chá»§ yáº¿u dÃ nh cho má»¥c Ä‘Ã­ch phá»• thÃ´ng.
	- Chá»‰ há»— trá»£ chá»©ng chá»‰ DV, khÃ´ng há»— trá»£ OV hoáº·c EV.
	- Sá»­ dá»¥ng giao thá»©c ACME Ä‘á»ƒ tá»± Ä‘á»™ng cÃ i Ä‘áº·t vÃ  gia háº¡n chá»©ng chá»‰.

### 4.2 CÆ¡ cháº¿ xÃ¡c minh chá»©ng chá»‰: 
- Domain Control Validation (DCV) lÃ  quÃ¡ trÃ¬nh xÃ¡c minh quyá»n sá»Ÿ há»¯u tÃªn miá»n trÆ°á»›c khi cáº¥p chá»©ng chá»‰ SSL/TLS, nháº±m Ä‘áº£m báº£o tÃ­nh tin cáº­y vÃ  an toÃ n.
- CÃ¡c phÆ°Æ¡ng phÃ¡p DCV phá»• biáº¿n bao gá»“m:
	- Email: Gá»­i mÃ£ xÃ¡c minh Ä‘áº¿n Ä‘á»‹a chá»‰ email quáº£n trá»‹ tÃªn miá»n.
	- DNS: ThÃªm báº£n ghi DNS (TXT hoáº·c CNAME) vÃ o cáº¥u hÃ¬nh tÃªn miá»n.
	- HTTP: Táº£i tá»‡p xÃ¡c minh lÃªn mÃ¡y chá»§ web táº¡i Ä‘Æ°á»ng dáº«n cá»¥ thá»ƒ.
	- ThÃ´ng qua báº£n ghi CAA record
	- WHOIS: (Ã­t dÃ¹ng hiá»‡n nay) Kiá»ƒm tra thÃ´ng tin liÃªn há»‡ trong cÆ¡ sá»Ÿ dá»¯ liá»‡u WHOIS.
- XÃ¡c minh qua email
- Tá»• chá»©c cáº¥p chá»©ng chá»‰ (CA) sáº½ gá»­i má»™t email Ä‘áº¿n Ä‘á»‹a chá»‰ email máº·c Ä‘á»‹nh liÃªn káº¿t vá»›i tÃªn miá»n Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ táº¡o yÃªu cáº§u kÃ½ chá»©ng chá»‰ (CSR). CÃ¡c Ä‘á»‹a chá»‰ email nÃ y thÆ°á»ng lÃ  cÃ¡c Ä‘á»‹a chá»‰ quáº£n trá»‹ chung nhÆ° postmaster@domain.com, hostmaster@example.com, hoáº·c webmaster@domain.com. NgÆ°á»i Ä‘Äƒng kÃ½ chá»©ng chá»‰ sáº½ Ä‘Äƒng nháº­p vÃ o tÃ i khoáº£n email Ä‘Ã³ vÃ  lÃ m theo hÆ°á»›ng dáº«n trong email, vÃ­ dá»¥ nhÆ° nháº­p mÃ£ xÃ¡c minh hoáº·c nháº¥p vÃ o liÃªn káº¿t trong email DCV Ä‘á»ƒ xÃ¡c nháº­n quyá»n sá»Ÿ há»¯u tÃªn miá»n.
- PhÆ°Æ¡ng phÃ¡p xÃ¡c minh qua email Ã¡p dá»¥ng Ä‘Æ°á»£c cho táº¥t cáº£ cÃ¡c loáº¡i chá»©ng chá»‰ SSL/TLS, bao gá»“m Domain Validation (DV), Organization Validation (OV) vÃ  Extended Validation (EV). Tuy nhiÃªn, cÃ¡c tÃªn miá»n sá»­ dá»¥ng dá»‹ch vá»¥ áº©n thÃ´ng tin WHOIS cÃ³ thá»ƒ cáº§n dÃ¹ng phÆ°Æ¡ng phÃ¡p xÃ¡c minh khÃ¡c.
- ![images](./images/s-3.png)

- XÃ¡c minh qua DNS
- PhÆ°Æ¡ng phÃ¡p nÃ y yÃªu cáº§u ngÆ°á»i Ä‘Äƒng kÃ½ chá»©ng chá»‰ táº¡o má»™t báº£n ghi TXT trong vÃ¹ng DNS cá»§a tÃªn miá»n, vá»›i ná»™i dung cá»¥ thá»ƒ do CA cung cáº¥p. Sau Ä‘Ã³, há»‡ thá»‘ng xÃ¡c minh cá»§a CA sáº½ kiá»ƒm tra báº£n ghi DNS Ä‘á»ƒ xÃ¡c nháº­n quyá»n kiá»ƒm soÃ¡t tÃªn miá»n. DNS validation thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng cho chá»©ng chá»‰ DV vÃ  OV. PhÆ°Æ¡ng phÃ¡p nÃ y khÃ´ng phá»• biáº¿n vá»›i chá»©ng chá»‰ EV, nhÆ°ng láº¡i lÃ  lá»±a chá»n Æ°u tiÃªn khi xÃ¡c minh chá»©ng chá»‰ Wildcard TLS.
- ![images](./images/s-4.png)

- XÃ¡c minh qua HTTP
- NgÆ°á»i Ä‘Äƒng kÃ½ chá»©ng chá»‰ sáº½ táº£i lÃªn má»™t tá»‡p vÄƒn báº£n chá»©a ná»™i dung Ä‘áº·c biá»‡t do CA cung cáº¥p vÃ o thÆ° má»¥c gá»‘c cá»§a mÃ¡y chá»§ web, hoáº·c vÃ o vá»‹ trÃ­ Ä‘Æ°á»£c CA chá»‰ Ä‘á»‹nh. Sau Ä‘Ã³, há»‡ thá»‘ng xÃ¡c minh cá»§a CA sáº½ gá»­i yÃªu cáº§u HTTP Ä‘áº¿n URL tÆ°Æ¡ng á»©ng Ä‘á»ƒ kiá»ƒm tra sá»± tá»“n táº¡i cá»§a tá»‡p. PhÆ°Æ¡ng phÃ¡p nÃ y thÆ°á»ng khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng cho chá»©ng chá»‰ Wildcard TLS vÃ¬ nÃ³ khÃ´ng Ä‘á»§ báº±ng chá»©ng xÃ¡c minh quyá»n kiá»ƒm soÃ¡t táº¥t cáº£ cÃ¡c tÃªn miá»n con, dáº«n Ä‘áº¿n rá»§i ro báº£o máº­t tiá»m áº©n.
- XÃ¡c minh dá»±a trÃªn WHOIS (WHOIS-based validation)
- Khi Ä‘Äƒng kÃ½ chá»©ng chá»‰ SSL/TLS, ngÆ°á»i Ä‘Äƒng kÃ½ cung cáº¥p thÃ´ng tin liÃªn quan Ä‘áº¿n tÃªn miá»n (vÃ­ dá»¥: tÃªn chá»§ sá»Ÿ há»¯u vÃ  thÃ´ng tin liÃªn há»‡). Tá»• chá»©c cáº¥p chá»©ng chá»‰ (CA) sáº½ truy váº¥n cÆ¡ sá»Ÿ dá»¯ liá»‡u WHOIS vÃ  so sÃ¡nh thÃ´ng tin Ä‘Ã³ vá»›i dá»¯ liá»‡u trong Ä‘Æ¡n Ä‘Äƒng kÃ½ chá»©ng chá»‰. Náº¿u thÃ´ng tin trÃ¹ng khá»›p, CA sáº½ coi quÃ¡ trÃ¬nh xÃ¡c minh lÃ  thÃ nh cÃ´ng.
- PhÆ°Æ¡ng phÃ¡p xÃ¡c minh nÃ y thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng cho chá»©ng chá»‰ DV (Domain Validation). Tuy nhiÃªn, nÃ³ Ã­t phá»• biáº¿n hÆ¡n Ä‘á»‘i vá»›i OV (Organization Validation) vÃ  háº§u nhÆ° khÃ´ng Ä‘Æ°á»£c dÃ¹ng cho EV (Extended Validation) do cÃ¡c yÃªu cáº§u xÃ¡c minh nghiÃªm ngáº·t hÆ¡n. Náº¿u tÃªn miá»n cá»§a báº¡n sá»­ dá»¥ng dá»‹ch vá»¥ áº©n thÃ´ng tin WHOIS (WHOIS privacy), báº¡n cÃ³ thá»ƒ khÃ´ng sá»­ dá»¥ng Ä‘Æ°á»£c phÆ°Æ¡ng phÃ¡p DCV nÃ y.
- ![images](./images/s-5.png)

- XÃ¡c minh báº±ng báº£n ghi CAA (CAA-based validation)
- PhÆ°Æ¡ng phÃ¡p nÃ y sá»­ dá»¥ng báº£n ghi CAA trong há»‡ thá»‘ng DNS Ä‘á»ƒ kiá»ƒm soÃ¡t viá»‡c cáº¥p phÃ¡t chá»©ng chá»‰ SSL/TLS cho tÃªn miá»n. Chá»§ sá»Ÿ há»¯u tÃªn miá»n táº¡o má»™t báº£n ghi CAA Ä‘á»ƒ chá»‰ Ä‘á»‹nh rÃµ tá»• chá»©c cáº¥p chá»©ng chá»‰ (CA) nÃ o Ä‘Æ°á»£c phÃ©p phÃ¡t hÃ nh chá»©ng chá»‰ cho tÃªn miá»n Ä‘Ã³.
- Khi cÃ³ yÃªu cáº§u cáº¥p chá»©ng chá»‰, CA sáº½ truy váº¥n DNS Ä‘á»ƒ kiá»ƒm tra báº£n ghi CAA. Náº¿u CA Ä‘Æ°á»£c liá»‡t kÃª trong báº£n ghi, quÃ¡ trÃ¬nh xÃ¡c minh Ä‘Æ°á»£c coi lÃ  há»£p lá»‡. Náº¿u khÃ´ng, CA sáº½ tá»« chá»‘i cáº¥p chá»©ng chá»‰.
- Cáº¥u trÃºc báº£n ghi CAA:
`example.com.  CAA  0 issue "letsencrypt.org"`
â†’ Chá»‰ cho phÃ©p Letâ€™s Encrypt cáº¥p chá»©ng chá»‰ cho example.com.
- Äáº·c Ä‘iá»ƒm:
	- Ãp dá»¥ng: Cho táº¥t cáº£ cÃ¡c loáº¡i chá»©ng chá»‰ (DV, OV, EV), nhÆ°ng thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng nhÆ° má»™t lá»›p kiá»ƒm soÃ¡t bá»• sung chá»© khÃ´ng pháº£i lÃ  phÆ°Æ¡ng phÃ¡p xÃ¡c minh duy nháº¥t.
	- TÃ­nh nÄƒng: CÃ³ thá»ƒ chá»‰ Ä‘á»‹nh nhiá»u CA, hoáº·c ngÄƒn cháº·n hoÃ n toÃ n viá»‡c cáº¥p chá»©ng chá»‰ báº±ng cÃ¡ch khÃ´ng cho phÃ©p CA nÃ o (issue ";").
	- TÃ­nh káº¿ thá»«a: CA sáº½ kiá»ƒm tra báº£n ghi CAA tá»« tÃªn miá»n con Ä‘áº¿n tÃªn miá»n gá»‘c, dá»«ng láº¡i á»Ÿ báº£n ghi Ä‘áº§u tiÃªn tÃ¬m tháº¥y.
	- Tá»± Ä‘á»™ng hÃ³a: CÃ³ thá»ƒ cáº¥u hÃ¬nh dá»… dÃ ng trong há»‡ thá»‘ng DNS cá»§a nhÃ  cung cáº¥p tÃªn miá»n.
- LÆ°u Ã½: Náº¿u khÃ´ng cÃ³ báº£n ghi CAA, CA Ä‘Æ°á»£c phÃ©p cáº¥p chá»©ng chá»‰ theo máº·c Ä‘á»‹nh. Tuy nhiÃªn, náº¿u cÃ³ báº£n ghi, CA báº¯t buá»™c pháº£i tuÃ¢n thá»§ theo quy Ä‘á»‹nh trong Ä‘Ã³

### 4.3 So sÃ¡nh Æ°u/nhÆ°á»£c Ä‘iá»ƒm

| TiÃªu chÃ­                | Sectigo                            | DigiCert                                     | GlobalSign                         | Let's Encrypt                       |
| ----------------------- | ---------------------------------- | -------------------------------------------- | ---------------------------------- | ----------------------------------- |
| Loáº¡i chá»©ng chá»‰ há»— trá»£   | DV, OV, EV, Wildcard, Multi-Domain | DV, OV, EV, Wildcard, Multi-Domain           | DV, OV, EV, Wildcard, Multi-Domain | DV (chá»‰ há»— trá»£ Domain Validation)   |
| Chi phÃ­                 | Tháº¥p Ä‘áº¿n trung bÃ¬nh                | Cao                                          | Trung bÃ¬nh Ä‘áº¿n cao                 | Miá»…n phÃ­                            |
| Tá»‘c Ä‘á»™ cáº¥p phÃ¡t         | Nhanh (DV: vÃ i phÃºt)               | Ráº¥t nhanh (DV/OV: vÃ i phÃºt Ä‘áº¿n giá»)          | Nhanh (DV: vÃ i phÃºt)               | Tá»± Ä‘á»™ng, gáº§n nhÆ° tá»©c thÃ¬            |
| Tá»± Ä‘á»™ng hÃ³a (ACME)      | CÃ³ (qua API riÃªng)                 | CÃ³ (API doanh nghiá»‡p)                        | CÃ³ (API doanh nghiá»‡p)              | CÃ³ (chuáº©n ACME)                     |
| Thá»i háº¡n chá»©ng chá»‰      | Tá»‘i Ä‘a 13 thÃ¡ng                    | Tá»‘i Ä‘a 13 thÃ¡ng                              | Tá»‘i Ä‘a 13 thÃ¡ng                    | 90 ngÃ y (tá»± Ä‘á»™ng gia háº¡n)           |
| Há»— trá»£ doanh nghiá»‡p lá»›n | CÃ³                                 | Ráº¥t máº¡nh                                     | Ráº¥t máº¡nh                           | KhÃ´ng                               |
| TÃ­nh nÄƒng quáº£n lÃ½       | CÃ³ báº£ng Ä‘iá»u khiá»ƒn quáº£n lÃ½         | CÃ³ há»‡ thá»‘ng quáº£n lÃ½ vÃ²ng Ä‘á»i (CertCentral)   | CÃ³ há»‡ thá»‘ng quáº£n lÃ½ táº­p trung      | KhÃ´ng cÃ³ giao diá»‡n quáº£n lÃ½          |
| Má»©c Ä‘á»™ tin cáº­y          | Cao                                | Ráº¥t cao (Ä‘Æ°á»£c dÃ¹ng bá»Ÿi chÃ­nh phá»§, ngÃ¢n hÃ ng) | Cao                                | Cao (dÃ¹ miá»…n phÃ­, váº«n Ä‘Æ°á»£c tin cáº­y) |
| Há»— trá»£ ká»¹ thuáº­t         | CÃ³ (24/7, nhiá»u cáº¥p Ä‘á»™)            | CÃ³ (24/7, chuyÃªn sÃ¢u)                        | CÃ³ (Ä‘a ngÃ´n ngá»¯, chuyÃªn nghiá»‡p)    | KhÃ´ng há»— trá»£ trá»±c tiáº¿p              |


## 5. ThÃ nh pháº§n ká»¹ thuáº­t cáº§n lÃ m rÃµ hÆ¡n
### 5.1 Public key â€“ Private key 
- Trong máº­t mÃ£ khÃ³a cÃ´ng khai â€“ khÃ³a riÃªng (public-private key cryptography), khÃ³a cÃ´ng khai vÃ  khÃ³a riÃªng hoáº¡t Ä‘á»™ng cÃ¹ng nhau Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n cho dá»¯ liá»‡u Ä‘Æ°á»£c trao Ä‘á»•i. Má»™t thÃ´ng Ä‘iá»‡p sáº½ Ä‘Æ°á»£c mÃ£ hÃ³a báº±ng khÃ³a cÃ´ng khai, vá»‘n cÃ³ thá»ƒ Ä‘Æ°á»£c chia sáº» rá»™ng rÃ£i, vÃ  chá»‰ cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i mÃ£ báº±ng khÃ³a riÃªng tÆ°Æ¡ng á»©ng, vá»‘n chá»‰ thuá»™c vá» chá»§ sá»Ÿ há»¯u.
- KhÃ³a cÃ´ng khai thÆ°á»ng Ä‘Æ°á»£c vÃ­ nhÆ° Ä‘á»‹a chá»‰ cÃ´ng ty â€“ ai cÅ©ng cÃ³ thá»ƒ tra cá»©u vÃ  chia sáº». Trong mÃ£ hÃ³a báº¥t Ä‘á»‘i xá»©ng, khÃ³a cÃ´ng khai cÃ³ thá»ƒ Ä‘Æ°á»£c phÃ¢n phá»‘i cho báº¥t ká»³ ai trong há»‡ thá»‘ng. Khi ngÆ°á»i gá»­i cÃ³ khÃ³a cÃ´ng khai, há» sá»­ dá»¥ng nÃ³ Ä‘á»ƒ mÃ£ hÃ³a thÃ´ng Ä‘iá»‡p.
- Má»—i khÃ³a cÃ´ng khai luÃ´n Ä‘i kÃ¨m vá»›i má»™t khÃ³a riÃªng duy nháº¥t. CÃ³ thá»ƒ hÃ¬nh dung khÃ³a riÃªng giá»‘ng nhÆ° chÃ¬a khÃ³a cá»­a chÃ­nh cá»§a má»™t doanh nghiá»‡p â€“ chá»‰ báº¡n má»›i cÃ³ báº£n sao. ÄÃ¢y chÃ­nh lÃ  Ä‘iá»ƒm khÃ¡c biá»‡t cá»‘t lÃµi giá»¯a hai loáº¡i khÃ³a: khÃ³a cÃ´ng khai Ä‘á»ƒ mÃ£ hÃ³a, khÃ³a riÃªng Ä‘á»ƒ giáº£i mÃ£. Trong trÆ°á»ng há»£p thÃ´ng Ä‘iá»‡p Ä‘Æ°á»£c mÃ£ hÃ³a, báº¡n sáº½ sá»­ dá»¥ng khÃ³a riÃªng Ä‘á»ƒ giáº£i mÃ£ vÃ  Ä‘á»c ná»™i dung.
- VÃ­ dá»¥ sá»­ dá»¥ng cáº·p khoÃ¡ 
	- Bob muá»‘n gá»­i cho Alice má»™t email Ä‘Æ°á»£c mÃ£ hÃ³a. Äá»ƒ lÃ m Ä‘iá»u nÃ y, Bob sá»­ dá»¥ng khÃ³a cÃ´ng khai cá»§a Alice Ä‘á»ƒ mÃ£ hÃ³a thÃ´ng Ä‘iá»‡p cá»§a mÃ¬nh. Khi Alice nháº­n Ä‘Æ°á»£c thÃ´ng Ä‘iá»‡p, cÃ´ áº¥y sáº½ sá»­ dá»¥ng khÃ³a riÃªng tÆ°Æ¡ng á»©ng (chá»‰ mÃ¬nh cÃ´ áº¥y biáº¿t) Ä‘á»ƒ giáº£i mÃ£ thÃ´ng Ä‘iá»‡p tá»« Bob.
	- Káº» táº¥n cÃ´ng cÃ³ thá»ƒ cá»‘ gáº¯ng xÃ¢m nháº­p vÃ o mÃ¡y chá»§ Ä‘á»ƒ truy cáº­p thÃ´ng tin Ä‘Ã£ mÃ£ hÃ³a, nhÆ°ng sáº½ khÃ´ng thá»ƒ giáº£i mÃ£ Ä‘Æ°á»£c vÃ¬ khÃ´ng cÃ³ khÃ³a riÃªng. Alice lÃ  ngÆ°á»i duy nháº¥t sá»Ÿ há»¯u khÃ³a riÃªng, do Ä‘Ã³ cÅ©ng lÃ  ngÆ°á»i duy nháº¥t cÃ³ thá»ƒ giáº£i mÃ£ vÃ  Ä‘á»c Ä‘Æ°á»£c ná»™i dung thÃ´ng Ä‘iá»‡p.
	- Khi Alice muá»‘n tráº£ lá»i Bob, cÃ´ áº¥y chá»‰ cáº§n láº·p láº¡i quy trÃ¬nh: sá»­ dá»¥ng khÃ³a cÃ´ng khai cá»§a Bob Ä‘á»ƒ mÃ£ hÃ³a thÃ´ng Ä‘iá»‡p gá»­i láº¡i cho anh áº¥y.
- ![images](./images/s-6.webp)
- Sá»± khÃ¡c biá»‡t giá»¯a **khÃ³a cÃ´ng khai** vÃ  **khÃ³a riÃªng**:

| **KhÃ³a cÃ´ng khai (Public Key)**                  | **KhÃ³a riÃªng (Private Key)**                         |
|--------------------------------------------------|------------------------------------------------------|
| DÃ¹ng Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u                           | DÃ¹ng Ä‘á»ƒ giáº£i mÃ£ dá»¯ liá»‡u                              |
| ÄÆ°á»£c chia sáº» cÃ´ng khai                           | Chá»‰ chá»§ sá»Ÿ há»¯u má»›i cÃ³ quyá»n truy cáº­p                 |
| CÃ³ thá»ƒ dÃ¹ng Ä‘á»ƒ mÃ£ hÃ³a hoáº·c kÃ½                    | DÃ¹ng Ä‘á»ƒ giáº£i mÃ£ hoáº·c xÃ¡c minh chá»¯ kÃ½                 |
| KhÃ´ng thá»ƒ dÃ¹ng Ä‘á»ƒ suy ra khÃ³a riÃªng              | KhÃ´ng thá»ƒ dÃ¹ng Ä‘á»ƒ suy ra khÃ³a cÃ´ng khai              |

- Sá»­ dá»¥ng cáº·p khÃ³a cÃ´ng khai vÃ  khÃ³a riÃªng giÃºp báº£o vá»‡ dá»¯ liá»‡u khi truyá»n thÃ´ng tin qua máº¡ng, Ä‘áº£m báº£o ba yáº¿u tá»‘:
	- BÃ­ máº­t: Dá»¯ liá»‡u Ä‘Æ°á»£c mÃ£ hÃ³a báº±ng khÃ³a cÃ´ng khai chá»‰ ngÆ°á»i sá»Ÿ há»¯u khÃ³a riÃªng má»›i giáº£i mÃ£ Ä‘Æ°á»£c.
	- ToÃ n váº¹n: QuÃ¡ trÃ¬nh giáº£i mÃ£ cho phÃ©p kiá»ƒm tra dá»¯ liá»‡u cÃ³ bá»‹ thay Ä‘á»•i hay khÃ´ng.
	- XÃ¡c thá»±c: Chá»¯ kÃ½ sá»‘ báº±ng khÃ³a riÃªng cho phÃ©p ngÆ°á»i nháº­n xÃ¡c minh Ä‘Ãºng ngÆ°á»i gá»­i báº±ng khÃ³a cÃ´ng khai.

### 5.2 CSR (Certificate Signing Request)
- CSR (Certificate Signing Request) lÃ  má»™t trong nhá»¯ng bÆ°á»›c Ä‘áº§u tiÃªn Ä‘á»ƒ láº¥y chá»©ng chá»‰ SSL/TLS. Tá»‡p nÃ y Ä‘Æ°á»£c táº¡o trÃªn chÃ­nh mÃ¡y chá»§ nÆ¡i chá»©ng chá»‰ sáº½ Ä‘Æ°á»£c cÃ i Ä‘áº·t, vÃ  chá»©a cÃ¡c thÃ´ng tin (vÃ­ dá»¥: common name, organization, country) mÃ  Tá»• chá»©c cáº¥p chá»©ng chá»‰ (CA) sáº½ sá»­ dá»¥ng Ä‘á»ƒ táº¡o chá»©ng chá»‰. CSR cÅ©ng bao gá»“m khÃ³a cÃ´ng khai sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o chá»©ng chá»‰ vÃ  Ä‘Æ°á»£c kÃ½ báº±ng khÃ³a riÃªng tÆ°Æ¡ng á»©ng. \
- Tá»• chá»©c cáº¥p chá»©ng chá»‰ (CA) sáº½ sá»­ dá»¥ng dá»¯ liá»‡u tá»« CSR Ä‘á»ƒ táº¡o chá»©ng chá»‰ SSL. CÃ¡c thÃ´ng tin chÃ­nh bao gá»“m:
	- ThÃ´ng tin vá» doanh nghiá»‡p vÃ  website cáº§n cÃ i Ä‘áº·t SSL, bao gá»“m:
		- Common Name (CN):
			- VÃ­ dá»¥: *.example.com, www.example.com, mail.example.com
			- ÄÃ¢y lÃ  tÃªn miá»n Ä‘áº§y Ä‘á»§ (FQDN) cá»§a mÃ¡y chá»§.
		- Organization (O):
			- TÃªn phÃ¡p lÃ½ Ä‘áº§y Ä‘á»§ cá»§a tá»• chá»©c. KhÃ´ng viáº¿t táº¯t vÃ  cáº§n bao gá»“m háº­u tá»‘ nhÆ° Inc., Corp., hoáº·c LLC náº¿u cÃ³.
			- Äá»‘i vá»›i chá»©ng chá»‰ SSL loáº¡i EV vÃ  OV, thÃ´ng tin nÃ y sáº½ Ä‘Æ°á»£c CA xÃ¡c minh vÃ  Ä‘Æ°a vÃ o chá»©ng chá»‰.
		- City/Locality (L): ThÃ nh phá»‘ nÆ¡i tá»• chá»©c Ä‘áº·t trá»¥ sá»Ÿ. KhÃ´ng viáº¿t táº¯t.
		- State/County/Region (S): Bang hoáº·c khu vá»±c nÆ¡i tá»• chá»©c Ä‘áº·t trá»¥ sá»Ÿ. KhÃ´ng viáº¿t táº¯t.
		- Country (C): MÃ£ quá»‘c gia gá»“m hai chá»¯ cÃ¡i theo chuáº©n ISO (vÃ­ dá»¥: VN cho Viá»‡t Nam).
		- Email Address: Äá»‹a chá»‰ email dÃ¹ng Ä‘á»ƒ liÃªn há»‡ vá»›i tá»• chá»©c.
	- KhÃ³a cÃ´ng khai sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o chá»©ng chá»‰. SSL sá»­ dá»¥ng mÃ£ hÃ³a báº¥t Ä‘á»‘i xá»©ng (public-key cryptography) Ä‘á»ƒ báº£o vá»‡ dá»¯ liá»‡u truyá»n táº£i. KhÃ³a cÃ´ng khai dÃ¹ng Ä‘á»ƒ mÃ£ hÃ³a, cÃ²n khÃ³a riÃªng tÆ°Æ¡ng á»©ng dÃ¹ng Ä‘á»ƒ giáº£i mÃ£.
	- ThÃ´ng tin vá» loáº¡i vÃ  Ä‘á»™ dÃ i khÃ³a: KÃ­ch thÆ°á»›c khÃ³a phá»• biáº¿n nháº¥t lÃ  RSA 2048 bit. Má»™t sá»‘ CA (nhÆ° GlobalSign) há»— trá»£ khÃ³a lá»›n hÆ¡n (vÃ­ dá»¥: RSA 4096+) hoáº·c khÃ³a dáº¡ng ECC.
- CSR thÆ°á»ng Ä‘Æ°á»£c táº¡o á»Ÿ Ä‘á»‹nh dáº¡ng PEM dá»±a trÃªn mÃ£ hÃ³a Base-64.
```
-----BEGIN NEW CERTIFICATE REQUEST-----MIIDVDCCAr0CAQAweTEeMBwGA1UEAxMVd3d3Lmpvc2VwaGNoYXBtYW4uY29tMQ8w DQYDVQQLEwZEZXNpZ24xFjAUBgNVBAoTDUpvc2VwaENoYXBtYW4xEjAQBgNVBAcT CU1haWRzdG9uZTENMAsGA1UECBMES2VudDELMAkGA1UEBhMCR0IwgZ8wDQYJKoZI hvcNAQEBBQADgY0AMIGJAoGBAOEFDpnOKRabQhDa5asDxYPnG0c/neW18e8apjOk 1yuGRk+3GD7YQvuhBVS1x6wkw1D2RnmnZgN1nNUK0cRK7sIvOyCh1+jgD7u46mLk 81j+b4YSEmYZGPLIuclyocPDm0hXayjCUqWt7z6LMIKpLym8gayEZzz9Gn97PsbP kVFBAgMBAAGgggGZMBoGCisGAQQBgjcNAgMxDBYKNS4xLjI2MDAuMjB7BgorBgEE AYI3AgEOMW0wazAOBgNVHQ8BAf8EBAMCBPAwRAYJKoZIhvcNAQkPBDcwNTAOBggq hkiG9w0DAgICAIAwDgYIKoZIhvcNAwQCAgCAMAcGBSsOAwIHMAoGCCqGSIb3DQMH MBMGA1UdJQQMMAoGCCsGAQUFBwMBMIH9BgorBgEEAYI3DQICMYHuMIHrAgEBHloA TQBpAGMAcgBvAHMAbwBmAHQAIABSAFMAQQAgAFMAQwBoAGEAbgBuAGUAbAAgAEMA cgB5AHAAdABvAGcAcgBhAHAAaABpAGMAIABQAHIAbwB2AGkAZABlAHIDgYkAk0kf HSkr4jsEVya3mgUoyaYMO456ECNZr4Cb+WhPgexfjOO5qwOG1oDOTaKycrkc5pG+ IPBQnq+4cotT8hWJQwpc+qGb8xUETpxCokhrhN5079vFXq/5dsHkmtOTwkSqSnz9 yruVoxYeDQ8jI3KG3HTgxwFto8oZnm+E+Y4oshUAAAAAAAAAADANBgkqhkiG9w0B AQUFAAOBgQAuAxetLzgfjBdWpjpixeVYZXuPZ+6jvZNL/9hOw7Fk5pVVXWdr8csJ 6JUW8QdH9KB6ZlM4yg8Df+vat1/DG6GuD2hiIR7fQ0NtPFBQmbrSm+TTBo95lwP+ ZSZTusPFTLKaqValdnS9Uw+6Vq7/I4ouDA8QBIuaTFtPOp+8wEGBHQ==
-----END NEW CERTIFICATE REQUEST-----
```
- Quy trÃ¬nh láº¥y chá»©ng chá»‰ CSR
	- Táº¡o cáº·p khÃ³a trÃªn mÃ¡y chá»§ (khÃ³a cÃ´ng khai vÃ  khÃ³a riÃªng).
	- Äiá»n thÃ´ng tin CSR: tÃªn miá»n, tá»• chá»©c, Ä‘á»‹a chá»‰, khÃ³a cÃ´ng khai...
	- Äáº£m báº£o thÃ´ng tin khá»›p vá»›i tÃªn miá»n Ä‘Ã£ Ä‘Äƒng kÃ½ Ä‘á»ƒ trÃ¡nh bá»‹ tá»« chá»‘i.
	- Gá»­i CSR Ä‘áº¿n CA Ä‘á»ƒ Ä‘Æ°á»£c xÃ¡c minh vÃ  phÃ¡t hÃ nh chá»©ng chá»‰.

### 5.3 CÃ¡c Ä‘á»‹nh dáº¡ng file chá»©ng chá»‰ X.509
- Táº¥t cáº£ chá»©ng chá»‰ SSL Ä‘á»u lÃ  chá»©ng chá»‰ x.509 â€” Ä‘Ã¢y lÃ  Ä‘á»‹nh dáº¡ng tiÃªu chuáº©n cho chá»©ng chá»‰ khÃ³a cÃ´ng khai, Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng má»™t ngÃ´n ngá»¯ hÃ¬nh thá»©c gá»i lÃ  Abstract Syntax Notation One (ASN.1). 
- Má»™t cÃ¡ch Ä‘Æ¡n giáº£n Ä‘á»ƒ phÃ¢n biá»‡t cÃ¡c Ä‘á»‹nh dáº¡ng nÃ y lÃ  dá»±a vÃ o kiá»ƒu mÃ£ hÃ³a:
	- PEM vÃ  PKCS#7 sá»­ dá»¥ng mÃ£ hÃ³a ASCII dáº¡ng Base64, phá»• biáº¿n cho cÃ¡c tá»‡p vÄƒn báº£n.
	- DER vÃ  PKCS#12 sá»­ dá»¥ng mÃ£ hÃ³a nhá»‹ phÃ¢n (binary), tá»©c lÃ  há»‡ nhá»‹ phÃ¢n chá»‰ gá»“m cÃ¡c sá»‘ 0 vÃ  1.
- Do sá»± khÃ¡c biá»‡t vá» Ä‘á»‹nh dáº¡ng vÃ  mÃ£ hÃ³a, chá»©ng chá»‰ SSL cÃ³ thá»ƒ cÃ³ nhiá»u pháº§n má»Ÿ rá»™ng tá»‡p (file extension) khÃ¡c nhau.
- CÃ¡c Ä‘á»‹nh dáº¡ng chá»©ng chá»‰ SSL bao gá»“m PEM, DER, PFX vÃ  PKCS#7, má»—i Ä‘á»‹nh dáº¡ng phÃ¹ há»£p vá»›i cÃ¡c má»¥c Ä‘Ã­ch sá»­ dá»¥ng khÃ¡c nhau. Má»™t sá»‘ pháº§n má»Ÿ rá»™ng tá»‡p phá»• biáº¿n lÃ :

| **Format**      | **Extension**            | **Description**                                                |
|-----------------|--------------------------|----------------------------------------------------------------|
| PEM             | .pem, .crt, .cer         | Base64 encoded, used in Unix/Linux systems                     |
| DER             | .der, .cer               | Binary format, used in Windows                                 |
| PFX / PKCS#12   | .pfx, .p12               | Stores certificate and private key, used in Windows            |
| PKCS#7          | .p7b, .p7c               | Certificate chain, used in Java environments                   |

- Äá»‹nh dáº¡ng DER: DER lÃ  viáº¿t táº¯t cá»§a Distinguished Encoding Rules, má»™t Ä‘á»‹nh dáº¡ng mÃ£ hÃ³a nhá»‹ phÃ¢n, hiáº¿m khi Ä‘Æ°á»£c sá»­ dá»¥ng ngoÃ i mÃ´i trÆ°á»ng Windows. CÃ¡c tá»‡p DER thÆ°á»ng cÃ³ pháº§n má»Ÿ rá»™ng lÃ  .der hoáº·c .cer.
- Äá»‹nh dáº¡ng PEM: 
	- PEM lÃ  Ä‘á»‹nh dáº¡ng chá»©ng chá»‰ SSL phá»• biáº¿n nháº¥t vÃ  thÆ°á»ng gáº·p nháº¥t. Pháº§n lá»›n cÃ¡c tá»• chá»©c cáº¥p chá»©ng chá»‰ (CA) cung cáº¥p chá»©ng chá»‰ SSL á»Ÿ Ä‘á»‹nh dáº¡ng PEM vá»›i cÃ¡c pháº§n má»Ÿ rá»™ng tá»‡p nhÆ° .pem, .crt, .cer hoáº·c .key.
	- PEM lÃ  viáº¿t táº¯t cá»§a Privacy-Enhanced Email, máº·c dÃ¹ má»¥c Ä‘Ã­ch ban Ä‘áº§u liÃªn quan Ä‘áº¿n email khÃ´ng thÃ nh cÃ´ng, nhÆ°ng Ä‘á»‹nh dáº¡ng nÃ y láº¡i Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i nhÆ° má»™t Ä‘á»‹nh dáº¡ng chá»©a dá»¯ liá»‡u.
	- Vá» báº£n cháº¥t, tá»‡p PEM lÃ  tá»‡p DER Ä‘Æ°á»£c mÃ£ hÃ³a theo chuáº©n Base64, trong Ä‘Ã³ cÃ¡c bit nhá»‹ phÃ¢n Ä‘Æ°á»£c chuyá»ƒn thÃ nh chuá»—i kÃ½ tá»± cÃ³ thá»ƒ Ä‘á»c Ä‘Æ°á»£c. Nhá» Ä‘Ã³, cÃ³ thá»ƒ má»Ÿ tá»‡p PEM báº±ng báº¥t ká»³ trÃ¬nh soáº¡n tháº£o vÄƒn báº£n nÃ o, ká»ƒ cáº£ Notepad.
	- Má»™t tá»‡p .pem cÃ³ thá»ƒ chá»©a chá»©ng chá»‰ mÃ¡y chá»§, chá»©ng chá»‰ trung gian vÃ  cáº£ khÃ³a riÃªng. NgoÃ i ra, cÅ©ng cÃ³ thá»ƒ nháº­n chá»©ng chá»‰ mÃ¡y chá»§ vÃ  trung gian dÆ°á»›i dáº¡ng tá»‡p .crt hoáº·c .cer, cÃ²n khÃ³a riÃªng náº±m trong tá»‡p .key.
- Äá»‹nh dáº¡ng PKCS#7
	- PKCS lÃ  viáº¿t táº¯t cá»§a Public Key Cryptography Standards.
	- PKCS#7 lÃ  Ä‘á»‹nh dáº¡ng chá»©ng chá»‰ SSL Ä‘a nÄƒng dÃ¹ng Ä‘á»ƒ phÃ¢n phá»‘i dá»¯ liá»‡u Ä‘Æ°á»£c mÃ£ hÃ³a. NÃ³ chá»§ yáº¿u Ä‘Æ°á»£c sá»­ dá»¥ng trÃªn ná»n táº£ng Windows vÃ  mÃ¡y chá»§ Java Tomcat.
	- Hiá»‡n nay, Ä‘á»‹nh dáº¡ng káº¿ nhiá»‡m cá»§a nÃ³ lÃ  CMS (Cryptographic Message Syntax) Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng, nhÆ°ng tÃªn gá»i PKCS#7 váº«n phá»• biáº¿n nhÆ° cÃ¡ch gá»i SSL thay vÃ¬ TLS.
	- PKCS#7 cÃ³ hai pháº§n má»Ÿ rá»™ng tá»‡p: .p7b hoáº·c .p7c. KhÃ¡c vá»›i PEM, PKCS#7 khÃ´ng thá»ƒ chá»©a khÃ³a riÃªng, mÃ  chá»‰ chá»©a chá»©ng chá»‰ chÃ­nh vÃ  chá»©ng chá»‰ trung gian.
- Äá»‹nh dáº¡ng PKCS#12
	- PKCS#12 lÃ  má»™t tiÃªu chuáº©n mÃ£ hÃ³a cÃ´ng khai khÃ¡c vá»›i tÃ­nh báº£o máº­t cao hÆ¡n. Giá»‘ng nhÆ° PEM, nÃ³ cÃ³ thá»ƒ chá»©a toÃ n bá»™ chuá»—i chá»©ng chá»‰ SSL vÃ  cáº·p khÃ³a trong má»™t tá»‡p .pfx.
	- Äiá»ƒm khÃ¡c biá»‡t chÃ­nh lÃ  PKCS#12 lÃ  má»™t container Ä‘Æ°á»£c báº£o vá»‡ báº±ng máº­t kháº©u.
	- Má»™t sá»‘ há»‡ thá»‘ng mÃ¡y chá»§ sáº½ yÃªu cáº§u nháº­p máº­t kháº©u trong quÃ¡ trÃ¬nh táº¡o CSR, vÃ  máº­t kháº©u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ má»Ÿ tá»‡p .pfx.

### 5.4 Intermediate CA, Root CA vÃ  Chuá»—i chá»©ng chá»‰ (Certificate Chain)
- Certificate Chain
	- Chuá»—i chá»©ng chá»‰ (Certificate Chain) lÃ  má»™t danh sÃ¡ch cÃ³ thá»© tá»± cÃ¡c chá»©ng chá»‰, bao gá»“m chá»©ng chá»‰ SSL/TLS vÃ  cÃ¡c chá»©ng chá»‰ cá»§a Tá»• chá»©c cáº¥p chá»©ng chá»‰ (CA), cho phÃ©p bÃªn nháº­n xÃ¡c minh ráº±ng ngÆ°á»i gá»­i vÃ  táº¥t cáº£ cÃ¡c CA trong chuá»—i Ä‘á»u Ä‘Ã¡ng tin cáº­y.
	- Chuá»—i nÃ y báº¯t Ä‘áº§u tá»« chá»©ng chá»‰ SSL/TLS cá»§a mÃ¡y chá»§, vÃ  má»—i chá»©ng chá»‰ trong chuá»—i Ä‘Æ°á»£c kÃ½ bá»Ÿi tá»• chá»©c Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh trong chá»©ng chá»‰ káº¿ tiáº¿p.
- Intermediate CA
	- Chuá»—i tin cáº­y: Intermediate CA Ä‘Æ°á»£c liÃªn káº¿t vá»›i Root CA thÃ´ng qua viá»‡c chá»©ng chá»‰ cá»§a nÃ³ Ä‘Æ°á»£c kÃ½ bá»Ÿi Root CA hoáº·c má»™t Intermediate CA khÃ¡c.
	- KÃ½ chÃ©o (Cross-Signed): Chá»©ng chá»‰ cá»§a Intermediate CA cÃ³ thá»ƒ Ä‘Æ°á»£c kÃ½ chÃ©o bá»Ÿi Root CA hoáº·c Intermediate CA khÃ¡c Ä‘á»ƒ chá»©ng minh Ä‘á»™ tin cáº­y.
	- Hoáº¡t Ä‘á»™ng trá»±c tuyáº¿n: Intermediate CA Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c hoáº¡t Ä‘á»™ng trá»±c tuyáº¿n nhÆ° cáº¥p chá»©ng chá»‰ cho website hoáº·c ngÆ°á»i dÃ¹ng.
	- Báº£o máº­t: Intermediate CA Ä‘Ã³ng vai trÃ² nhÆ° má»™t lá»›p báº£o vá»‡; náº¿u khÃ³a riÃªng cá»§a nÃ³ bá»‹ lá»™, Root CA váº«n khÃ´ng bá»‹ áº£nh hÆ°á»Ÿng trá»±c tiáº¿p.
	- Thá»i háº¡n ngáº¯n hÆ¡n: Chá»©ng chá»‰ trung gian thÆ°á»ng cÃ³ thá»i háº¡n hiá»‡u lá»±c ngáº¯n hÆ¡n (vÃ­ dá»¥: 1â€“2 nÄƒm) so vá»›i chá»©ng chá»‰ gá»‘c.
	- Báº¥t ká»³ chá»©ng chá»‰ nÃ o náº±m giá»¯a chá»©ng chá»‰ SSL/TLS vÃ  chá»©ng chá»‰ gá»‘c (Root Certificate) Ä‘á»u Ä‘Æ°á»£c gá»i lÃ  chá»©ng chá»‰ trung gian (Intermediate Certificate) hoáº·c chuá»—i chá»©ng chá»‰ (chain certificate).
		- Chá»©ng chá»‰ trung gian lÃ  bÃªn kÃ½/phÃ¡t hÃ nh chá»©ng chá»‰ SSL/TLS.
		- Chá»©ng chá»‰ gá»‘c (Root CA Certificate) lÃ  bÃªn kÃ½/phÃ¡t hÃ nh chá»©ng chá»‰ trung gian.
	- Náº¿u chá»©ng chá»‰ trung gian khÃ´ng Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn mÃ¡y chá»§ (nÆ¡i chá»©ng chá»‰ SSL/TLS Ä‘Æ°á»£c triá»ƒn khai), má»™t sá»‘ trÃ¬nh duyá»‡t, thiáº¿t bá»‹ di Ä‘á»™ng hoáº·c á»©ng dá»¥ng cÃ³ thá»ƒ khÃ´ng tin tÆ°á»Ÿng chá»©ng chá»‰ SSL/TLS Ä‘Ã³.
	- Äá»ƒ Ä‘áº£m báº£o chá»©ng chá»‰ SSL/TLS tÆ°Æ¡ng thÃ­ch vá»›i táº¥t cáº£ cÃ¡c mÃ¡y khÃ¡ch, viá»‡c cÃ i Ä‘áº·t Ä‘áº§y Ä‘á»§ chá»©ng chá»‰ trung gian lÃ  báº¯t buá»™c.
- Root CA
	- Trust Anchor: Root CA lÃ  ná»n táº£ng cá»§a sá»± tin cáº­y trong háº¡ táº§ng khÃ³a cÃ´ng khai (PKI), vá»›i chá»©ng chá»‰ Ä‘Æ°á»£c cÃ i sáºµn trong pháº§n má»m hoáº·c phÃ¢n phá»‘i qua cÃ¡c kÃªnh báº£o máº­t.
	- Tá»± kÃ½ (Self-Signed): Root CA tá»± kÃ½ chá»©ng chá»‰ cá»§a chÃ­nh mÃ¬nh, thiáº¿t láº­p gá»‘c cá»§a chuá»—i tin cáº­y.
	- Báº£o máº­t: Root CA thÆ°á»ng Ä‘Æ°á»£c lÆ°u trá»¯ ngoáº¡i tuyáº¿n trong cÃ¡c mÃ´-Ä‘un báº£o máº­t pháº§n cá»©ng (HSM) Ä‘á»ƒ báº£o vá»‡ khÃ³a riÃªng vÃ  giáº£m thiá»ƒu rá»§i ro bá»‹ xÃ¢m pháº¡m.
	- Giá»›i háº¡n cáº¥p phÃ¡t: Root CA chá»‰ cáº¥p chá»©ng chá»‰ cho cÃ¡c Intermediate CA, khÃ´ng cáº¥p trá»±c tiáº¿p cho ngÆ°á»i dÃ¹ng cuá»‘i (nhÆ° website hoáº·c ngÆ°á»i dÃ¹ng).
	- Thá»i háº¡n dÃ i: Chá»©ng chá»‰ gá»‘c cÃ³ thá»i háº¡n hiá»‡u lá»±c dÃ i hÆ¡n (vÃ­ dá»¥: 10â€“20 nÄƒm).
	- Chuá»—i chá»©ng chá»‰ káº¿t thÃºc báº±ng chá»©ng chá»‰ gá»‘c (Root CA Certificate). CA Ä‘Ã³ng vai trÃ² lÃ  Ä‘iá»ƒm khá»Ÿi Ä‘áº§u cá»§a chuá»—i tin cáº­y.
	- Táº¥t cáº£ cÃ¡c chá»©ng chá»‰ trong chuá»—i â€” tá»« chá»©ng chá»‰ SSL/TLS Ä‘áº¿n cÃ¡c chá»©ng chá»‰ trung gian â€” Ä‘á»u pháº£i Ä‘Æ°á»£c xÃ¡c minh chá»¯ kÃ½ sá»‘ liÃªn tiáº¿p cho Ä‘áº¿n khi Ä‘áº¡t Ä‘áº¿n chá»©ng chá»‰ gá»‘c. Viá»‡c xÃ¡c minh nÃ y Ä‘áº£m báº£o ráº±ng má»—i chá»©ng chá»‰ Ä‘á»u Ä‘Æ°á»£c phÃ¡t hÃ nh bá»Ÿi má»™t CA há»£p lá»‡ trong há»‡ thá»‘ng háº¡ táº§ng khÃ³a cÃ´ng khai (PKI).
- ![images](./images/figure-chain.jpg)

## 6. CÃ i Ä‘áº·t SSL trÃªn mÃ¡y chá»§
- ThÃ´ng thÆ°á»ng, sau khi Ä‘Æ°á»£c CA cáº¥p chá»©ng chá»‰, sáº½ cÃ³ cÃ¡c tá»‡p sau:
	- your_domain.crt: Chá»©ng chá»‰ SSL cho domain .
	- your_domain.key: KhÃ³a riÃªng (private key) â€“ Ä‘Æ°á»£c táº¡o cÃ¹ng lÃºc vá»›i CSR.
	- intermediate.crt hoáº·c ca_bundle.crt: Chá»©ng chá»‰ trung gian tá»« CA.
	- (TÃ¹y chá»n): CÃ³ thá»ƒ Ä‘Æ°á»£c há»£p nháº¥t thÃ nh má»™t chuá»—i chá»©ng chá»‰ fullchain.crt

### 6.1 TrÃªn cÃ¡c Webserver 
#### Apache
- Táº¡o Private key vÃ  CSR 
```
openssl req -new -newkey rsa:2048 -nodes -keyout server.key -out server.csr
```
	- Lá»‡nh trÃªn táº¡o ra hai tá»‡p sau:
		- Tá»‡p Private Key: DÃ¹ng Ä‘á»ƒ táº¡o CSR vÃ  sau Ä‘Ã³ dÃ¹ng Ä‘á»ƒ báº£o máº­t vÃ  xÃ¡c minh cÃ¡c káº¿t ná»‘i thÃ´ng qua chá»©ng chá»‰ SSL.
		- Tá»‡p Certificate Signing Request (CSR): DÃ¹ng Ä‘á»ƒ yÃªu cáº§u cáº¥p chá»©ng chá»‰ SSL vÃ  sau nÃ y Ä‘á»ƒ mÃ£ hÃ³a cÃ¡c thÃ´ng Ä‘iá»‡p mÃ  chá»‰ khÃ³a riÃªng tÆ°Æ¡ng á»©ng má»›i giáº£i mÃ£ Ä‘Æ°á»£c.
	- Cáº¥u hÃ¬nh domain cáº§n báº£o vá»‡, cÃ¡c thÃ´ng tin Ä‘á»‹a lÃ½ liÃªn quan. 
- Thá»±c hiá»‡n gá»­i CSR tá»›i CA xin cáº¥p chá»©ng chá»‰, thá»±c hiá»‡n quÃ¡ trÃ¬nh xÃ¡c minh domain hoáº·c cÃ¡c trÆ°á»ng há»£p xÃ¡c minh sÃ¢u hÆ¡n tuá»³ theo loáº¡i SSL cert DV, EV hay OV.
- Sau khi quÃ¡ trÃ¬nh xÃ¡c minh xong, CA cáº¥p chá»©ng chá»‰ thu Ä‘Æ°á»£c cÃ¡c file domain cert, intermediate CA cert. Tiáº¿n hÃ nh cÃ i Ä‘áº·t:
- Chá»‰nh sá»­a file `virtualhost` tÆ°Æ¡ng á»©ng cá»§a website trong apache thÆ°á»ng náº±m trong `/etc/apache2/sites-enabled/`
	- TrÆ°á»ng há»£p website cháº¡y trÃªn cáº£ 80 vÃ  443 thÃ¬ cáº§n 2 file riÃªng biá»‡t, cáº¥u hÃ¬nh ssl trÃªn virtual host sá»­ dá»¥ng port 443 
	- VÃ­ dá»¥ file virtual host máº«u 
	```
	<VirtualHost 192.168.0.1:443>
	DocumentRoot /var/www/
	SSLEngine on
	SSLCertificateFile /path/to/your_domain_name.crt
	SSLCertificateKeyFile /path/to/your_private.key
	SSLCertificateChainFile /path/to/intermediate.crt
	</VirtualHost>
	```
	- CÃ¡c tham sá»‘ cáº§n cáº¥u hÃ¬nh: 
		- SSLCertificateFile lÃ  tá»‡p chá»©ng chá»‰ cho domain Ä‘Æ°á»£c cáº¥p (vÃ­ dá»¥: your_domain_name.crt).
		- SSLCertificateKeyFile lÃ  tá»‡p .key Ä‘Æ°á»£c táº¡o ra khi táº¡o CSR (vÃ­ dá»¥: your_private.key).
		- SSLCertificateChainFile lÃ  tá»‡p chá»©ng chá»‰ trung gian cá»§a CA cáº¥p (vÃ­ dá»¥: intermediate.crt).
	- Sau khi cáº¥u hÃ¬nh thá»±c hiá»‡n kiá»ƒm tra 
	```
	apachectl configtest
	```
	- Enable module SSL 
	```
	sudo a2enmod ssl
	```
	- Restart Apache2
	```
	systemctl restart apache2 
	```
#### Nginx
- QÃºa trÃ¬nh sinh CSR vÃ  thá»±c hiá»‡n xÃ¡c minh tÆ°Æ¡ng tá»± Apache2 
- CÃ i Ä‘áº·t SSL trÃªn Nginx 
- Khi triá»ƒn khai SSL trÃªn mÃ¡y chá»§ Nginx, cáº§n Ä‘áº£m báº£o ráº±ng chuá»—i chá»©ng chá»‰ Ä‘Æ°á»£c cung cáº¥p Ä‘áº§y Ä‘á»§ vÃ  theo Ä‘Ãºng thá»© tá»±. Äiá»u nÃ y thÆ°á»ng yÃªu cáº§u káº¿t há»£p (concatenate) chá»©ng chá»‰ chÃ­nh vÃ  cÃ¡c chá»©ng chá»‰ trung gian vÃ o má»™t tá»‡p duy nháº¥t.
- ThÃ nh pháº§n chá»©ng chá»‰
	- Chá»©ng chá»‰ chÃ­nh (server certificate): ÄÆ°á»£c cáº¥p cho tÃªn miá»n cá»¥ thá»ƒ.
	- Chá»©ng chá»‰ trung gian (intermediate certificate): ÄÆ°á»£c dÃ¹ng Ä‘á»ƒ liÃªn káº¿t chá»©ng chá»‰ chÃ­nh vá»›i chá»©ng chá»‰ gá»‘c.
	- Chá»©ng chá»‰ gá»‘c (root certificate): ThÆ°á»ng Ä‘Ã£ Ä‘Æ°á»£c trÃ¬nh duyá»‡t vÃ  há»‡ Ä‘iá»u hÃ nh tin cáº­y sáºµn, khÃ´ng báº¯t buá»™c pháº£i cung cáº¥p.
- Táº¡o tá»‡p chá»©ng chá»‰ há»£p nháº¥t: 
	- TrÃªn há»‡ thá»‘ng Linux hoáº·c macOS, sá»­ dá»¥ng lá»‡nh sau Ä‘á»ƒ ná»‘i cÃ¡c tá»‡p chá»©ng chá»‰:
	`cat server.crt intermediate.crt > fullchain.pem`
		- Trong Ä‘Ã³:
			- server.crt lÃ  chá»©ng chá»‰ chÃ­nh.
			- intermediate.crt lÃ  chá»©ng chá»‰ trung gian.
			- fullchain.pem lÃ  tá»‡p káº¿t quáº£ chá»©a chuá»—i chá»©ng chá»‰ Ä‘áº§y Ä‘á»§.
	- Náº¿u cÃ³ thÃªm chá»©ng chá»‰ gá»‘c, cÃ³ thá»ƒ ná»‘i thÃªm vÃ o cuá»‘i:
	`cat server.crt intermediate.crt root.crt > fullchain.pem`
	- LÆ°u Ã½: Thá»© tá»± cÃ¡c chá»©ng chá»‰ trong tá»‡p há»£p nháº¥t pháº£i lÃ : chá»©ng chá»‰ chÃ­nh â†’ trung gian â†’ gá»‘c.

- Táº¡o file cáº¥u hÃ¬nh VirtualHost tÆ°Æ¡ng á»©ng vá»›i domain thÆ°á»ng náº±m trong `/etc/nginx/conf.d/`
	- Thá»±c hiá»‡n sao chÃ©p virtual host khÃ´ng sá»­ dá»¥ng ssl vÃ  cáº¥u hÃ¬nh thÃªm ssl trÃªn Ä‘Ã³. 
	- Cáº¥u hÃ¬nh máº«u: 
	```
	server {
		listen   443;
		
		ssl    on;
		ssl_certificate    /etc/ssl/your_domain_name.pem; (or bundle.crt)
		ssl_certificate_key    /etc/ssl/your_domain_name.key;
		
		server_name your.domain.com;
		access_log /var/log/nginx/nginx.vhost.access.log;
		error_log /var/log/nginx/nginx.vhost.error.log;
		location / {
		root   /home/www/public_html/your.domain.com/public/;
		index  index.html;
		}
	}
	```
	- Cáº§n chÃº Ã½ cÃ¡c cáº¥u hÃ¬nh 
		- ssl on; KÃ­ch hoáº¡t cháº¿ Ä‘á»™ SSL cho mÃ¡y chá»§. 
		- ssl_certificate /etc/ssl/your_domain_name.pem; Chá»‰ Ä‘á»‹nh Ä‘Æ°á»ng dáº«n Ä‘áº¿n chá»©ng chá»‰ SSL cÃ´ng khai cá»§a mÃ¡y chá»§. Tá»‡p .pem hoáº·c .crt nÃ y cÃ³ thá»ƒ bao gá»“m cáº£ chá»©ng chá»‰ trung gian (intermediate certificate) náº¿u cáº§n thiáº¿t.
		- ssl_certificate_key /etc/ssl/your_domain_name.key; Chá»‰ Ä‘á»‹nh Ä‘Æ°á»ng dáº«n Ä‘áº¿n khÃ³a riÃªng tÆ° (private key) tÆ°Æ¡ng á»©ng vá»›i chá»©ng chá»‰ á»Ÿ trÃªn. Tá»‡p .key nÃ y Ä‘Æ°á»£c táº¡o khi táº¡o CSR (Certificate Signing Request)
- Sau khi cáº¥u hÃ¬nh thá»±c hiá»‡n kiá»ƒm tra 
```
nginx -t
```
- Restart Nginx
```
systemctl restart nginx 
```
#### IIS
- Táº¡o yÃªu cáº§u cáº¥p chá»©ng chá»‰ (CSR) báº±ng IIS 10:
	- Má»Ÿ menu Start cá»§a Windows, nháº­p Internet Information Services (IIS) Manager vÃ  khá»Ÿi cháº¡y cÃ´ng cá»¥.
	- Trong cá»­a sá»• IIS Manager, á»Ÿ cÃ¢y thÆ° má»¥c Connections (bÃªn trÃ¡i), chá»n tÃªn mÃ¡y chá»§.
	- á» trang chÃ­nh (center pane) cá»§a tÃªn mÃ¡y chá»§, trong má»¥c IIS, nháº¥p Ä‘Ãºp Server Certificates.
	- Táº¡i trang Server Certificates, trong menu Actions (bÃªn pháº£i), nháº¥p vÃ o liÃªn káº¿t Create Certificate Request.
	- TrÃ¬nh hÆ°á»›ng dáº«n Request Certificate sáº½ má»Ÿ ra. á» trang Distinguished Name Properties, nháº­p cÃ¡c thÃ´ng tin sau vÃ  nháº¥n Next:
		- Common Name: Nháº­p tÃªn miá»n Ä‘áº§y Ä‘á»§ (FQDN), vÃ­ dá»¥ www.example.com
		- Organization: Nháº­p tÃªn phÃ¡p lÃ½ Ä‘áº§y Ä‘á»§ cá»§a tá»• chá»©c
		- Organizational Unit: Nháº­p tÃªn phÃ²ng ban (vÃ­ dá»¥: IT, Web Security); trÆ°á»ng nÃ y cÃ³ thá»ƒ Ä‘á»ƒ trá»‘ng
		- City/Locality: ThÃ nh phá»‘ nÆ¡i tá»• chá»©c Ä‘Æ°á»£c Ä‘Äƒng kÃ½ há»£p phÃ¡p
		- State/Province: Tá»‰nh hoáº·c bang nÆ¡i tá»• chá»©c Ä‘Æ°á»£c Ä‘Äƒng kÃ½ há»£p phÃ¡p
		- Country: Chá»n quá»‘c gia tá»« danh sÃ¡ch
	- á» trang Cryptographic Service Provider Properties, nháº­p cÃ¡c lá»±a chá»n:
		- Cryptographic service provider: Chá»n Microsoft RSA SChannel Cryptographic Provider (trá»« khi cÃ³ nhu cáº§u khÃ¡c)
		- Bit length: Chá»n 2048 (trá»« khi cÃ³ yÃªu cáº§u Ä‘áº·c biá»‡t)
	- Táº¡i trang File Name, dÆ°á»›i má»¥c Specify a file name for the certificate request, nháº¥p nÃºt [â€¦] Ä‘á»ƒ duyá»‡t Ä‘áº¿n vá»‹ trÃ­ lÆ°u tá»‡p CSR.
		- LÆ°u Ã½: Náº¿u chá»‰ nháº­p tÃªn tá»‡p mÃ  khÃ´ng chá»‰ Ä‘á»‹nh Ä‘Æ°á»ng dáº«n, tá»‡p CSR (csr.txt) sáº½ Ä‘Æ°á»£c lÆ°u á»Ÿ C:\Windows\System32.
	- Nháº¥n Finish Ä‘á»ƒ hoÃ n táº¥t quÃ¡ trÃ¬nh táº¡o CSR.
- Sá»­ dá»¥ng CSR gá»­i tá»›i CA xin cáº¥p cert, thá»±c hiá»‡n quÃ¡ trÃ¬nh xÃ¡c minh vÃ  cáº¥p chá»©ng chá»‰.
- CÃ i Ä‘áº·t chá»©ng chá»‰ SSL
	- TrÃªn mÃ¡y chá»§ Ä‘Ã£ táº¡o CSR, lÆ°u tá»‡p chá»©ng chá»‰ .cer (vÃ­ dá»¥: your_domain_com.cer) Ä‘Æ°á»£c cáº¥p bá»Ÿi CA.
	- Má»Ÿ Internet Information Services (IIS) Manager tá»« menu Start cá»§a Windows. Trong cá»­a sá»• IIS Manager, táº¡i cÃ¢y thÆ° má»¥c Connections (bÃªn trÃ¡i), chá»n tÃªn mÃ¡y chá»§.
	- Táº¡i trang chÃ­nh cá»§a mÃ¡y chá»§ (center pane), trong má»¥c IIS, nháº¥p Ä‘Ãºp vÃ o Server Certificates. Trong trang Server Certificates, táº¡i menu Actions (bÃªn pháº£i), chá»n Complete Certificate Request.
	- Trong trÃ¬nh hÆ°á»›ng dáº«n Complete Certificate Request, táº¡i trang Specify Certificate Authority Response:
		- File name containing the certificate authority's response: Nháº¥p nÃºt [â€¦] Ä‘á»ƒ duyá»‡t vÃ  chá»n tá»‡p .cer Ä‘Ã£ nháº­n tá»« CA.
		- Friendly name: Nháº­p tÃªn Ä‘á»‹nh danh dá»… nhá»› cho chá»©ng chá»‰. NÃªn thÃªm tÃªn CA vÃ  ngÃ y háº¿t háº¡n, vÃ­ dá»¥: yoursite-2026, Ä‘á»ƒ dá»… phÃ¢n biá»‡t vÃ  quáº£n lÃ½.
		- Certificate store: Chá»n Web Hosting tá»« danh sÃ¡ch.
	- Nháº¥n OK Ä‘á»ƒ hoÃ n táº¥t cÃ i Ä‘áº·t chá»©ng chá»‰.
- GÃ¡n chá»©ng chá»‰ SSL cho website
	- Trong IIS Manager, táº¡i cÃ¢y thÆ° má»¥c Connections, má»Ÿ rá»™ng tÃªn mÃ¡y chá»§ Ä‘Ã£ cÃ i chá»©ng chá»‰. Má»Ÿ rá»™ng má»¥c Sites vÃ  chá»n website cáº§n báº£o máº­t.
	- Táº¡i trang chÃ­nh cá»§a website, trong menu Actions (bÃªn pháº£i), chá»n Bindings. Trong cá»­a sá»• Site Bindings, nháº¥n Add.
	- Trong cá»­a sá»• Add Site Binding:
		- Type: Chá»n https.
		- IP address: Chá»n Ä‘á»‹a chá»‰ IP cá»¥ thá»ƒ hoáº·c All Unassigned.
		- Port: Nháº­p 443.
		- SSL certificate: Chá»n chá»©ng chá»‰ SSL vá»«a cÃ i Ä‘áº·t (vÃ­ dá»¥: yourdomain.com).
	- Nháº¥n OK Ä‘á»ƒ lÆ°u cáº¥u hÃ¬nh. Website hiá»‡n Ä‘Ã£ Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘á»ƒ cháº¥p nháº­n káº¿t ná»‘i HTTPS an toÃ n.
- ChÃº Ã½ trong trÆ°á»ng há»£p gÃ¡n cert vá»›i server IIS host nhiá»u website, tá»« website thá»© hai Ä‘Æ°á»£c thÃªm SSL trong cá»­a sá»• Add Site Binding, pháº§n Hostname cáº§n tÃ­ch chá»n `Require Server Name Indication` 

#### Tomcat 
- Táº¡o keystore vÃ  CSR cho Tomcat
	- BÆ°á»›c 1: Táº¡o keystore má»›i báº±ng Keytool
		- Táº¡o má»™t keystore má»›i Ä‘Æ°á»£c khuyáº¿n nghá»‹ Ä‘á»ƒ trÃ¡nh lá»—i khi cÃ i Ä‘áº·t chá»©ng chá»‰ hoáº·c khiáº¿n chá»©ng chá»‰ khÃ´ng hoáº¡t Ä‘á»™ng Ä‘Ãºng.
		- TrÆ°á»›c khi thá»±c hiá»‡n, cáº§n sao lÆ°u vÃ  xÃ³a cÃ¡c keystore cÅ©.
		- Di chuyá»ƒn Ä‘áº¿n thÆ° má»¥c dá»± kiáº¿n quáº£n lÃ½ keystore vÃ  chá»©ng chá»‰ SSL/TLS.
		- Thá»±c thi lá»‡nh:
		```
		keytool -genkey -alias server -keyalg RSA -keysize 2048 -keystore your_site_name.jks
		```
			- Trong Ä‘Ã³ your_site_name lÃ  tÃªn miá»n cáº§n báº£o máº­t. KhÃ´ng dÃ¹ng dáº¥u * náº¿u lÃ  chá»©ng chá»‰ Wildcard.
		- Khi Ä‘Æ°á»£c nháº¯c, táº¡o máº­t kháº©u cho keystore: Máº­t kháº©u nÃ y sáº½ Ä‘Æ°á»£c khai bÃ¡o trong cáº¥u hÃ¬nh Tomcat, dÃ¹ng Ä‘á»ƒ táº¡o CSR vÃ  cÃ i Ä‘áº·t chá»©ng chá»‰.
		- Khi Ä‘Æ°á»£c yÃªu cáº§u nháº­p tÃªn (first and last name), nháº­p Ä‘áº§y Ä‘á»§ tÃªn miá»n (FQDN), vÃ­ dá»¥: www.domain.com hoáº·c *.domain.com náº¿u lÃ  chá»©ng chá»‰ Wildcard.
		- Nháº­p thÃ´ng tin tá»• chá»©c theo yÃªu cáº§u.
		- XÃ¡c nháº­n thÃ´ng tin báº±ng cÃ¡ch nháº­p y hoáº·c yes.
		- Khi Ä‘Æ°á»£c há»i "key password for <server>", nháº¥n Enter Ä‘á»ƒ dÃ¹ng láº¡i máº­t kháº©u keystore.
		- Keystore your_site_name.jks sáº½ Ä‘Æ°á»£c táº¡o trong thÆ° má»¥c hiá»‡n táº¡i.

	- BÆ°á»›c 2: Táº¡o CSR tá»« keystore vá»«a táº¡o
		- Thá»±c thi lá»‡nh:
		```
		keytool -certreq -alias server -file csr.txt -keystore your_site_name.jks
		```
		- Thay tháº¿ your_site_name báº±ng tÃªn cá»§a keystore Ä‘Ã£ táº¡o.
		- Nháº­p láº¡i máº­t kháº©u keystore khi Ä‘Æ°á»£c yÃªu cáº§u.
		- Tá»‡p csr.txt (hoáº·c your_site_domain.txt) chá»©a CSR sáº½ Ä‘Æ°á»£c táº¡o trong thÆ° má»¥c hiá»‡n táº¡i.

- Sá»­ dá»¥ng CSR trÃªn xin CA cáº¥p , xÃ¡c minh Domain.
- Convert Ä‘á»‹nh dáº¡ng chá»©ng chá»‰ 
	- Chuyá»ƒn Ä‘á»•i tá»‡p chá»©ng chá»‰ tá»« Ä‘á»‹nh dáº¡ng PEM (.cer hoáº·c .crt) sang Ä‘á»‹nh dáº¡ng PKCS#7 (.p7b). CÃ³ thá»ƒ thá»±c hiá»‡n trá»±c tiáº¿p trÃªn há»‡ thá»‘ng báº±ng cÃ¡ch sá»­ dá»¥ng lá»‡nh OpenSSL sau:
	```
	openssl crl2pkcs7 -nocrl -certfile certificate.cer -out certificate.p7b -certfile CACert.cer
	```
	- Trong Ä‘Ã³:
		- certificate.cer: lÃ  tá»‡p chá»©ng chá»‰ chÃ­nh cáº§n chuyá»ƒn Ä‘á»•i.
		- CACert.cer: lÃ  chá»©ng chá»‰ cá»§a Tá»• chá»©c phÃ¡t hÃ nh (CA).
		- certificate.p7b: lÃ  tá»‡p Ä‘áº§u ra á»Ÿ Ä‘á»‹nh dáº¡ng PKCS#7.
	- Lá»‡nh nÃ y káº¿t há»£p chá»©ng chá»‰ chÃ­nh vÃ  chuá»—i chá»©ng chá»‰ trung gian, táº¡o ra tá»‡p .p7b dÃ¹ng Ä‘á»ƒ cÃ i Ä‘áº·t trÃªn má»™t sá»‘ mÃ¡y chá»§ vÃ  ná»n táº£ng yÃªu cáº§u Ä‘á»‹nh dáº¡ng PKCS#7.
- LÆ°u tá»‡p chá»©ng chá»‰ Ä‘Æ°á»£c cáº¥p vÃ­ dá»¥ `your_domain_com.p7b` vÃ o cÃ¹ng thÆ° má»¥c vá»›i keystore Java.
- CÃ i Ä‘áº·t tá»‡p chá»©ng chá»‰ vÃ o keystore
- LÆ°u Ã½: Pháº£i cÃ i Ä‘áº·t tá»‡p chá»©ng chá»‰ SSL/TLS vÃ o Ä‘Ãºng keystore vÃ  sá»­ dá»¥ng Ä‘Ãºng alias (vÃ­ dá»¥: -alias server) Ä‘Ã£ dÃ¹ng khi táº¡o CSR. Náº¿u cÃ i vÃ o keystore khÃ¡c hoáº·c dÃ¹ng alias khÃ¡c, lá»‡nh import sáº½ khÃ´ng hoáº¡t Ä‘á»™ng.
- Thá»±c hiá»‡n lá»‡nh sau Ä‘á»ƒ import chá»©ng chá»‰ vÃ o keystore:
	```
	keytool -import -alias server -file your_site_name.p7b -keystore your_site_name.jks
	```
	- Trong Ä‘Ã³:
		- your_site_name.p7b: tá»‡p chá»©ng chá»‰ Ä‘Ã£ táº£i vá».
		- your_site_name.jks: keystore Ä‘Ã£ táº¡o tá»« BÆ°á»›c 1 .
		- server: tÃªn alias Ä‘Ã£ dÃ¹ng khi táº¡o CSR.
	- Náº¿u thá»±c hiá»‡n thÃ nh cÃ´ng, xuáº¥t hiá»‡n thÃ´ng bÃ¡o "Certificate reply was installed in keystore".
	- Náº¿u Ä‘Æ°á»£c há»i cÃ³ tin tÆ°á»Ÿng chá»©ng chá»‰ khÃ´ng, nháº­p y hoáº·c yes.
	- Viá»‡c cÃ i Ä‘áº·t nÃ y sáº½ náº¡p toÃ n bá»™ chuá»—i chá»©ng chá»‰ cáº§n thiáº¿t vÃ o keystore.
	- Tá»‡p your_site_name.jks hiá»‡n Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y chá»§ Tomcat.
- Cáº¥u hÃ¬nh SSL/TLS Connector
- TrÆ°á»›c khi Tomcat cÃ³ thá»ƒ cháº¥p nháº­n káº¿t ná»‘i an toÃ n, cáº§n cáº¥u hÃ¬nh SSL Connector.
- Má»Ÿ tá»‡p server.xml thÃ´ng thÆ°á»ng, tá»‡p server.xml náº±m trong thÆ° má»¥c conf cá»§a thÆ° má»¥c cÃ i Ä‘áº·t Tomcat.
- TÃ¬m Ä‘oáº¡n cáº¥u hÃ¬nh connector mÃ  keystore má»›i sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng.
- ThÃ´ng thÆ°á»ng sá»­ dá»¥ng cá»•ng 443 hoáº·c 8443. CÃ³ thá»ƒ cáº§n bá» dáº¥u chÃº thÃ­ch (<!-- -->) Ä‘á»ƒ kÃ­ch hoáº¡t connector.
- Cáº¥u hÃ¬nh láº¡i Ä‘oáº¡n connector, khai bÃ¡o Ä‘áº§y Ä‘á»§ Ä‘Æ°á»ng dáº«n keystore vÃ  máº­t kháº©u.Cáº¥u hÃ¬nh máº«u nhÆ° sau:
```
<Connector port="443"
           maxHttpHeaderSize="8192"
           maxThreads="100"
           minSpareThreads="25"
           maxSpareThreads="75"
           enableLookups="false"
           disableUploadTimeout="true"
           acceptCount="100"
           scheme="https"
           secure="true"
           SSLEnabled="true"
           clientAuth="false"
           sslProtocol="TLS"
           keyAlias="server"
           keystoreFile="/home/user_name/your_site_name.jks"
           keystorePass="your_keystore_password" />
```
- Trong Ä‘Ã³:
	- keystoreFile: Ä‘Æ°á»ng dáº«n Ä‘áº§y Ä‘á»§ tá»›i keystore.
	- keystorePass: máº­t kháº©u Ä‘Ã£ Ä‘áº·t khi táº¡o keystore.
	- keyAlias: tÃªn alias Ä‘Ã£ dÃ¹ng khi táº¡o CSR (vÃ­ dá»¥: "server").
	Ghi chÃº: Náº¿u sá»­ dá»¥ng Tomcat phiÃªn báº£n cÅ© hÆ¡n Tomcat 7, cáº§n thay keystorePass báº±ng keypass.
- LÆ°u láº¡i tá»‡p server.xml.
- Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥ Tomcat.
```
sudo systemctl restart tomcat
```

### 6.2 TrÃªn cÃ¡c Web hosting control panel 
#### CPanel
- CPanel há»— trá»£ cÃ i Ä‘áº·t vÃ  gia háº¡n chá»©ng chá»‰ SSL tá»± Ä‘á»™ng cho cÃ¡c tÃªn miá»n trÃªn mÃ¡y chá»§ thÃ´ng qua giao diá»‡n Manage AutoSSL trong WHM (WHM Â» Home Â» SSL/TLS Â» Manage AutoSSL). Theo máº·c Ä‘á»‹nh, há»‡ thá»‘ng sá»­ dá»¥ng nhÃ  cung cáº¥p Letâ€™s Encryptâ„¢. GÃ³i báº£n quyá»n cPanel Ä‘Ã£ bao gá»“m dá»‹ch vá»¥ miá»…n phÃ­ nÃ y.
- ![images](./images/autossl_8.png)
- Sinh CSR sá»­ dá»¥ng CPanel 
	- ÄÄƒng nháº­p vÃ o tÃ i khoáº£n cPanel.
	- Trong má»¥c Security, chá»n SSL/TLS Manager.
	- ![images](./images/cpanel_csr_1.png)
	- Trong pháº§n Certificate Signing Requests (CSR), nháº¥p vÃ o Generate, view, or delete SSL certificate signing requests.
	- ![images](./images/cpanel_csr_2.png)
	- TrÃªn mÃ n hÃ¬nh tiáº¿p theo, Ä‘iá»n cÃ¡c thÃ´ng tin chá»©ng chá»‰ nhÆ° sau:
		- Äá»ƒ nguyÃªn tÃ¹y chá»n â€œGenerate a New 2048 bit keyâ€ trong trÆ°á»ng Key*.
		- Trong trÆ°á»ng Domains*, nháº­p tÃªn miá»n (hoáº·c tÃªn miá»n con) sáº½ sá»­ dá»¥ng chá»©ng chá»‰.
			- LÆ°u Ã½: Pháº£i sá»­ dá»¥ng tÃªn miá»n Ä‘áº§y Ä‘á»§ (FQDN).
			- LÆ°u Ã½: Náº¿u sá»­ dá»¥ng chá»©ng chá»‰ Wildcard, khai bÃ¡o tÃªn miá»n cÃ³ dáº¥u hoa thá»‹ á»Ÿ Ä‘áº§u, vÃ­ dá»¥: *.testcert.us. Chá»©ng chá»‰ dáº¡ng nÃ y sáº½ Ã¡p dá»¥ng cho testcert.us vÃ  táº¥t cáº£ cÃ¡c tÃªn miá»n con.
		- Nháº­p thÃ´ng tin vá»‹ trÃ­ tá»• chá»©c táº¡i cÃ¡c trÆ°á»ng City*, State* vÃ  Country*.
		- Nháº­p tÃªn cÃ´ng ty vÃ o trÆ°á»ng Company*. Náº¿u khÃ´ng cÃ³ tá»• chá»©c chÃ­nh thá»©c, cÃ³ thá»ƒ nháº­p â€œNAâ€.
		- TrÆ°á»ng Company Division lÃ  khÃ´ng báº¯t buá»™c, cÃ³ thá»ƒ Ä‘á»ƒ trá»‘ng hoáº·c nháº­p â€œNAâ€.
		- Trong trÆ°á»ng Email, nháº­p báº¥t ká»³ Ä‘á»‹a chá»‰ email há»£p lá»‡ nÃ o.
			- LÆ°u Ã½: TrÆ°á»ng nÃ y khÃ´ng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ xÃ¡c thá»±c quyá»n sá»Ÿ há»¯u miá»n hoáº·c nháº­n chá»©ng chá»‰.
		- Äá»ƒ trá»‘ng cÃ¡c trÆ°á»ng Passphrase vÃ  Description.
		- ![images](./images/cpanel_csr_3.png)
	- Sau khi Ä‘iá»n Ä‘áº§y Ä‘á»§ thÃ´ng tin, nháº¥p Generate. CSR Ä‘Ã£ Ä‘Æ°á»£c táº¡o thÃ nh cÃ´ng.
	- ![images](./images/cpanel_csr_4.png)
- Sá»­ dá»¥ng CSR Ä‘Ã£ táº¡o xin CA cáº¥p chá»©ng chá»‰, xÃ¡c minh. 
- CÃ i Ä‘áº·t chá»©ng chá»‰ SSL 
	- ÄÄƒng nháº­p vÃ o tÃ i khoáº£n cPanel >> má»¥c Security >> menu SSL/TLS Manager.
	- ![images](./images/cpanel_csr_1 (1).png)
	- Táº¡i pháº§n Install and Manage SSL for your site (HTTPS), nháº¥n vÃ o Manage SSL Sites.
	- ![images](./images/cpanel_inst.png)
		- LÆ°u Ã½: Náº¿u khÃ´ng tháº¥y tÃ¹y chá»n nÃ y, cÃ³ thá»ƒ tÃ i khoáº£n khÃ´ng cÃ³ Ä‘á»§ quyá»n quáº£n trá»‹ Ä‘á»ƒ cÃ i Ä‘áº·t SSL. Cáº§n liÃªn há»‡ nhÃ  cung cáº¥p dá»‹ch vá»¥ lÆ°u trá»¯ Ä‘á»ƒ Ä‘Æ°á»£c há»— trá»£.
		- Má»Ÿ tá»‡p chá»©ng chá»‰ báº±ng trÃ¬nh soáº¡n tháº£o vÄƒn báº£n nhÆ° Notepad.
		- Sao chÃ©p toÃ n bá»™ ná»™i dung bao gá»“m cáº£ pháº§n Ä‘áº§u vÃ  pháº§n cuá»‘i:
		```
		-----BEGIN CERTIFICATE-----
		...
		-----END CERTIFICATE-----
		```
		- DÃ¡n ná»™i dung nÃ y vÃ o Ã´ Certificate: (CRT) trong giao diá»‡n cPanel.
		- Nháº¥n vÃ o "Autofill by Certificate" Ä‘á»ƒ há»‡ thá»‘ng tá»± Ä‘á»™ng tÃ¬m vÃ  Ä‘iá»n khÃ³a riÃªng tÆ°Æ¡ng á»©ng (Private Key).
		- KhÃ³a riÃªng nÃ y pháº£i Ä‘Æ°á»£c lÆ°u trÃªn cÃ¹ng mÃ¡y chá»§ nÆ¡i Ä‘Ã£ táº¡o CSR.
		- Náº¿u CSR vÃ  Private Key khÃ´ng Ä‘Æ°á»£c táº¡o trÃªn cÃ¹ng mÃ¡y chá»§ Ä‘ang dÃ¹ng Ä‘á»ƒ cÃ i Ä‘áº·t chá»©ng chá»‰ SSL, cáº§n xuáº¥t Private Key tá»« mÃ¡y chá»§ Ä‘Ã£ táº¡o, rá»“i dÃ¡n thá»§ cÃ´ng vÃ o Ã´ Private Key: (KEY).
	- CÃ i Ä‘áº·t tá»‡p CA-Bundle do Tá»• chá»©c phÃ¡t hÃ nh chá»©ng chá»‰ (CA) gá»­i kÃ¨m vá»›i chá»©ng chá»‰ SSL chÃ­nh.
		- Tá»‡p CA-Bundle chá»©a chá»©ng chá»‰ gá»‘c vÃ  chá»©ng chá»‰ trung gian, cáº§n thiáº¿t Ä‘á»ƒ hoÃ n chá»‰nh chuá»—i xÃ¡c thá»±c SSL.
		- DÃ¹ lÃ  tÃ¹y chá»n, váº«n nÃªn cÃ i Ä‘áº·t CA-Bundle Ä‘á»ƒ trÃ¡nh cáº£nh bÃ¡o báº£o máº­t trÃªn thiáº¿t bá»‹ di Ä‘á»™ng vÃ  trÃ¬nh duyá»‡t cÅ©.
		- Táº¥t cáº£ chá»©ng chá»‰ (gá»‘c vÃ  trung gian) trong CA-Bundle cáº§n Ä‘Æ°á»£c dÃ¡n vÃ o Ã´ Certificate Authority Bundle: (CABUNDLE) trong quÃ¡ trÃ¬nh cÃ i Ä‘áº·t SSL qua cPanel.
	- ![images](./images/cpanel_inst_2.png)
	- Nháº¥n "Install Certificate" Ä‘á»ƒ hoÃ n táº¥t
	- ![images](./images/cpanel_inst_3.png)

#### Plesk
- Let's Encrypt dÃ¹ng Ä‘á»ƒ táº¡o chá»©ng chá»‰ SSL miá»…n phÃ­ thÆ°á»ng Ä‘Æ°á»£c kÃ­ch hoáº¡t tá»± Ä‘á»™ng theo máº·c Ä‘á»‹nh. Tuy nhiÃªn, náº¿u chÆ°a Ä‘Æ°á»£c báº­t, cÃ³ thá»ƒ thá»±c hiá»‡n kÃ­ch hoáº¡t thá»§ cÃ´ng tá»« giao diá»‡n Plesk.
	- BÆ°á»›c 1: ÄÄƒng nháº­p vÃ o Plesk vÃ  nháº¥p vÃ o má»¥c Let's Encrypt.
	- ![images](./images/LetsEncrypt.png)
	- BÆ°á»›c 2: Nháº¥n Install (trong trÆ°á»ng há»£p Ä‘Ã£ cÃ i Let's Encrypt, nÃºt nÃ y sáº½ lÃ  Renew náº¿u muá»‘n gia háº¡n chá»©ng chá»‰).
	- ![images](./images/InstallLetsEncrypt.png)
- Sinh CSR
	- ÄÄƒng nháº­p vÃ o Plesk Panel.
	- ![images](./images/ples_k_1.png)
	- TÃ¬m Ä‘áº¿n tÃªn miá»n cáº§n cÃ i Ä‘áº·t chá»©ng chá»‰ SSL trong tab Websites & Domains. Má»Ÿ trÃ¬nh Ä‘Æ¡n tháº£ xuá»‘ng bÃªn dÆ°á»›i tÃªn website.
	- ![images](./images/ples_k_2.png)
	- Táº¡i tab Dashboard, truy cáº­p má»¥c Security vÃ  nháº¥p vÃ o SSL/TLS Certificates.
		- Nháº¥p vÃ o "Advanced Settings" á»Ÿ bÃªn pháº£i mÃ n hÃ¬nh Ä‘á»ƒ má»Ÿ báº£ng thiáº¿t láº­p SSL má»›i.
		- ![images](./images/ples_k_3.png)
		- Chá»n tÃ¹y chá»n Add SSL/TLS Certificate Ä‘á»ƒ thÃªm má»™t má»¥c chá»©ng chá»‰ má»›i.
		- ![images](./images/ples_k_4.png)
		- Trong trang má»›i:
			- Nháº­p Certificate Name Ä‘á»ƒ Ä‘áº·t tÃªn cho chá»©ng chá»‰ SSL má»›i, giÃºp dá»… phÃ¢n biá»‡t vá»›i cÃ¡c chá»©ng chá»‰ khÃ¡c trÃªn mÃ¡y chá»§.
			- Äiá»n cÃ¡c thÃ´ng tin yÃªu cáº§u Ä‘á»ƒ táº¡o mÃ£ CSR:
			- Country: chá»n quá»‘c gia tá»« danh sÃ¡ch.
			- State or province: nháº­p bang hoáº·c tá»‰nh.
			- Location (city): nháº­p thÃ nh phá»‘ hoáº·c khu vá»±c.
			- Organization name (company): nháº­p tÃªn cÃ´ng ty. Náº¿u dÃ¹ng chá»©ng chá»‰ loáº¡i Organization hoáº·c EV SSL, nhÃ  cung cáº¥p chá»©ng chá»‰ sáº½ xÃ¡c minh thÃ´ng tin nÃ y. Náº¿u lÃ  Domain Validation (DV) SSL vÃ  khÃ´ng cÃ³ cÃ´ng ty, cÃ³ thá»ƒ nháº­p â€œN/Aâ€.
			- Organization department or division name: nháº­p tÃªn bá»™ pháº­n hoáº·c phÃ²ng ban, cÃ³ thá»ƒ nháº­p â€œN/Aâ€ náº¿u khÃ´ng cÃ³.
			- Domain name: nháº­p tÃªn miá»n cáº§n báº£o vá»‡.
				- LÆ°u Ã½: Náº¿u dÃ¹ng chá»©ng chá»‰ Wildcard, khai bÃ¡o tÃªn miá»n vá»›i dáº¥u hoa thá»‹, vÃ­ dá»¥: *.example.com.
			- Email: nháº­p Ä‘á»‹a chá»‰ email há»£p lá»‡.
	- Sau khi Ä‘iá»n Ä‘áº§y Ä‘á»§ thÃ´ng tin, nháº¥p Request.
	- ![images](./images/ples_k_5.png)
		- Káº¿t quáº£:
			- MÃ£ CSR sáº½ Ä‘Æ°á»£c táº¡o vÃ  há»‡ thá»‘ng chuyá»ƒn vá» trang danh sÃ¡ch chá»©ng chá»‰ SSL hiá»‡n cÃ³ trÃªn tÃªn miá»n.
			- CÃ¹ng vá»›i mÃ£ CSR, khÃ³a riÃªng (RSA Private Key) cÅ©ng Ä‘Æ°á»£c táº¡o. KhÃ³a nÃ y sáº½ cáº§n sá»­ dá»¥ng trong quÃ¡ trÃ¬nh cÃ i Ä‘áº·t chá»©ng chá»‰.
			- Äá»ƒ xem cáº£ hai mÃ£, nháº¥p vÃ o má»¥c chá»©ng chá»‰ trong danh sÃ¡ch. CSR vÃ  Private Key sáº½ hiá»ƒn thá»‹ á»Ÿ cuá»‘i trang.
		- ![images](./images/ples_k_7.png)
- Sá»­ dá»¥ng CSR Ä‘á»ƒ thá»±c hiá»‡n xin cáº¥p chá»©ng chá»‰, xÃ¡c minh.
- CÃ i Ä‘áº·t SSL
	- ÄÄƒng nháº­p vÃ o Plesk Panel.
	- ![images](./images/ples_k_1.png)
	- TÃ¬m Ä‘áº¿n tÃªn miá»n cáº§n cÃ i Ä‘áº·t chá»©ng chá»‰ SSL trong tab Websites & Domains. Má»Ÿ trÃ¬nh Ä‘Æ¡n tháº£ xuá»‘ng bÃªn dÆ°á»›i tÃªn website.
	- ![images](./images/ples_k_2.png)
	- Táº¡i tab Dashboard, truy cáº­p má»¥c Security vÃ  nháº¥p vÃ o SSL/TLS Certificates.
		- Nháº¥p vÃ o "Advanced Settings" á»Ÿ bÃªn pháº£i mÃ n hÃ¬nh Ä‘á»ƒ má»Ÿ báº£ng thiáº¿t láº­p SSL má»›i.
		- ![images](./images/ples_k_3.png)
	- Chá»n má»¥c chá»©ng chá»‰ SSL Ä‘Ã£ táº¡o khi táº¡o mÃ£ CSR Ä‘á»ƒ kÃ­ch hoáº¡t SSL.
	- ![images](./images/ples_k_8.png)
		- Táº£i cÃ¡c tá»‡p chá»©ng chá»‰ lÃªn táº¡i trang nÃ y.
		- Äáº§u tiÃªn, táº£i lÃªn chá»©ng chá»‰ chÃ­nh (end-entity certificate) Ä‘Æ°á»£c cáº¥p cho tÃªn miá»n táº¡i pháº§n Certificate á»Ÿ Ä‘áº§u trang. Nháº¥p Choose File Ä‘á»ƒ tÃ¬m vÃ  chá»n tá»‡p trÃªn mÃ¡y tÃ­nh.
		- Tiáº¿p theo, nháº¥p Choose File bÃªn cáº¡nh má»¥c CA Certificate Ä‘á»ƒ chá»n chuá»—i chá»©ng chá»‰ trung gian (CA Bundle) dÃ¹ng Ä‘á»ƒ xÃ¡c thá»±c chá»©ng chá»‰ tÃªn miá»n.
		- Sau khi chá»n cáº£ hai tá»‡p, nháº¥n Upload Certificate.
		- ![images](./images/ples_k_9.png)
	- Quay láº¡i menu Websites & Domains, nháº¥p vÃ o Hosting Settings dÆ°á»›i tÃªn miá»n cáº§n Ã¡p dá»¥ng chá»©ng chá»‰.
	- ![images](./images/ples_k_10.png)
	- Táº¡i trang tiáº¿p theo, Ä‘áº¿n má»¥c Security, chá»n chá»©ng chá»‰ muá»‘n sá»­ dá»¥ng tá»« danh sÃ¡ch tháº£ xuá»‘ng, sau Ä‘Ã³ nháº¥p Apply á»Ÿ cuá»‘i trang.
	- Äáº£m báº£o Ã´ SSL Support Ä‘Æ°á»£c chá»n.
	- ![images](./images/ples_k_11.png)
	- HoÃ n táº¥t: Chá»©ng chá»‰ Ä‘Ã£ Ä‘Æ°á»£c cÃ i Ä‘áº·t vÃ  Ã¡p dá»¥ng cho tÃªn miá»n. 
	- ![images](./images/ples_k_19.png)
#### DirectAdmin
- DA há»— trá»£ free SSL vá»›i Let's Encrypt 
	- Enable Letâ€™s Encrypt trÃªn DirecAdmin: yÃªu cáº§u version DirectAdmin pháº£i trÃªn 1.5 vÃ  version Custombuild pháº£i trÃªn 2.0
		- Thá»±c hiá»‡n cÃ¡c lá»‡nh Ä‘á»ƒ kiá»ƒm tra:
		```
		cd /usr/local/directadmin/custombuild
		./build version
		```
		- Báº­t tÃ­nh nÄƒng Letâ€™s Encrypt vÃ  SNI trÃªn DirectAdmin, thá»±c hiá»‡n cÃ¡c lá»‡nh sau:
		```
		echo â€œletsencrypt=1â€ >> /usr/local/directadmin/conf/directadmin.conf
		echo â€œenable_ssl_sni=1â€ >> /usr/local/directadmin/conf/directadmin.conf
		```
		- Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥ DirectAdmin:
		```
		/etc/init.d/directadmin restart
		```
		- Update license Letâ€™s Encrypt:
		```
		wget -O /usr/local/directadmin/scripts/letsencrypt.sh http://files.directadmin.com/services/all/letsencrypt.sh
		```
		- Update web-server configs trÃªn DirectAdmin báº±ng cÃ¡c lá»‡nh sau:
		```
		cd /usr/local/directadmin/custombuild
		./build update
		./build letsencrypt
		./build rewrite_confs
		```
	- Cáº¥u hÃ¬nh SSL 
		- Truy cáº­p vÃ o webpanel cá»§a DA theo Ä‘á»‹a chá»‰: http://[ip-address]:2222 (vá»›i port máº·c Ä‘á»‹nh cá»§a DA lÃ  2222)
		- Login vÃ o user quáº£n lÃ­ domain cáº§n add ssl, táº¡i má»©c user level  chá»n pháº§n SSL Certificates.
		- ![images](./images/image-1633409085361.png)
		- Chá»n Free & automatic certificate from Letâ€™s Encrypt vÃ  nháº¥n Save Ä‘á»ƒ tiáº¿n hÃ nh add Letâ€™s encrypt
		- ![images](./images/image-1633409702249.png)
		- Chá» server cÃ i Ä‘áº·t ssl vÃ  chuyá»ƒn hÆ°á»›ng bÃ¡o add key ssl thÃ nh cÃ´ng.

- Sinh CSR 
	- Truy cáº­p vÃ o webpanel cá»§a DA theo Ä‘á»‹a chá»‰: http://[ip-address]:2222 (vá»›i port máº·c Ä‘á»‹nh cá»§a DA lÃ  2222)
	- Login vÃ o user quáº£n lÃ­ domain cáº§n add ssl, táº¡i má»©c user level  chá»n pháº§n SSL Certificates.
	- ![images](./images/image-1633409085361.png)
	- Nháº¥n vÃ o nÃºt  "Create A Certificate Request" vÃ  Ä‘iá»n cÃ¡c thÃ´ng tin cáº§n thiáº¿t. Nhá»¯ng thÃ´ng tin nÃ y sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o mÃ£ CSR gá»­i cho Tá»• chá»©c cáº¥p chá»©ng chá»‰ (Certificate Authority).
		- MÃ£ quá»‘c gia gá»“m hai chá»¯ cÃ¡i;
		- Bang/Tá»‰nh;
		- ThÃ nh phá»‘;
		- TÃªn cÃ´ng ty;
		- Bá»™ pháº­n cÃ´ng ty;
		- TÃªn miá»n phá»• biáº¿n (Common Name) â€“ lÃ  tÃªn miá»n Ä‘áº§y Ä‘á»§ mÃ  báº¡n muá»‘n báº£o máº­t báº±ng chá»©ng chá»‰ SSL;
		- Email;
		- KÃ­ch thÆ°á»›c khÃ³a (bit), kÃ­ch thÆ°á»›c hiá»‡n Ä‘áº¡i tá»‘i thiá»ƒu lÃ  2048 bit;
		- Loáº¡i chá»©ng chá»‰ â€“ thuáº­t toÃ¡n bÄƒm Ä‘Æ°á»£c sá»­ dá»¥ng trong mÃ£ CSR.
	- ![images](./images/direct_3.jpg)
	- Sau khi hoÃ n táº¥t, DirectAdmin sáº½ hiá»ƒn thá»‹ mÃ£ CSR cÃ¹ng vá»›i khÃ³a riÃªng tÆ°. MÃ£ CSR Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kÃ­ch hoáº¡t chá»©ng chá»‰ SSL. Cáº§n sao chÃ©p mÃ£ nÃ y bao gá»“m cáº£ pháº§n Ä‘áº§u vÃ  pháº§n cuá»‘i â€”â€“BEGIN CERTIFICATE REQUESTâ€”â€“ vÃ  â€”â€“END CERTIFICATE REQUESTâ€”â€“.
	- ![images](./images/direct_4.jpg)
- Sá»­ dá»¥ng CSR xin CA cáº¥p chá»©ng chá»‰, xÃ¡c minh 
- CÃ i Ä‘áº·t chá»©ng chá»‰ SSl 
	- Truy cáº­p vÃ o webpanel cá»§a DA theo Ä‘á»‹a chá»‰: http://[ip-address]:2222 (vá»›i port máº·c Ä‘á»‹nh cá»§a DA lÃ  2222)
	- Login vÃ o user quáº£n lÃ­ domain cáº§n add ssl, táº¡i má»©c user level  chá»n pháº§n SSL Certificates.
	- ![images](./images/image-1633409085361.png)
	- Copy ná»™i dung file Private key vÃ  Certificate vÃ o pháº§n Paste a pre-generated Certificate and key >> Save
	- ![images](./images/file-1642143033096_1642143033050.jpg)
	- Trá»Ÿ láº¡i `SSL Certificates` vÃ  chá»n `Click Here to paste a CA Root Certificate`
	- ![images](./images/file-1642143036113_1642143036064.jpg)
	- ![images](./images/file-1642143043114_1642143039155.jpg)
	- Truy cáº­p Domain Setup
	- ![images](./images/file-1642143052797_1642143052744.jpg)
	- Click Domain cáº§n cÃ i Ä‘áº·t
	- ![images](./images/file-1642143056316_1642143056254.jpg)
	- Click Use a symbolic link from private_html to public_html - allows for same data in http and https -> Save
	- ![images](./images/file-1642143059193_1642143059138.jpg)
### 6.3 SSL cho tÃªn miá»n chÃ­nh vÃ  subdomain
- CÃ³ hai phÆ°Æ¡ng Ã¡n phá»• biáº¿n Ä‘á»ƒ cáº¥p chá»©ng chá»‰ SSL cho cáº£ tÃªn miá»n chÃ­nh vÃ  cÃ¡c subdomain:
- Sá»­ dá»¥ng Wildcard SSL
	- Wildcard SSL cho phÃ©p báº£o máº­t khÃ´ng giá»›i háº¡n cÃ¡c subdomain dÆ°á»›i má»™t tÃªn miá»n chÃ­nh (vÃ­ dá»¥: *.example.com).
	- Chá»‰ cáº§n má»™t chá»©ng chá»‰ duy nháº¥t Ä‘á»ƒ Ã¡p dá»¥ng cho www.example.com, mail.example.com, api.example.com, v.v.
	- PhÃ¹ há»£p khi táº¥t cáº£ subdomain thuá»™c cÃ¹ng má»™t cáº¥p.
- Sá»­ dá»¥ng Multi-Domain SSL (SAN/UCC)
	- Cho phÃ©p báº£o máº­t nhiá»u tÃªn miá»n vÃ  subdomain khÃ¡c nhau trong cÃ¹ng má»™t chá»©ng chá»‰.
	- VÃ­ dá»¥: example.com, www.example.com, sub1.example.net, mail.example.org.
	- PhÃ¹ há»£p khi cáº§n báº£o máº­t nhiá»u tÃªn miá»n khÃ´ng cÃ¹ng gá»‘c.

### 6.4 Tá»± Ä‘á»™ng gia háº¡n (Auto-renewal) vá»›i Let's Encrypt (Certbot, ACME,...)
#### ACME 
- Automated Certificate Management Environment - Giao thá»©c MÃ´i trÆ°á»ng quáº£n lÃ½ chá»©ng chá»‰ tá»± Ä‘á»™ng (ACME) lÃ  má»™t cÃ¡ch chuáº©n hÃ³a Ä‘á»ƒ tá»± Ä‘á»™ng hÃ³a quy trÃ¬nh láº¥y vÃ  gia háº¡n SSL/TLS chá»©ng chá»‰. NÃ³ cho phÃ©p mÃ¡y chá»§ web chá»©ng minh quyá»n sá»Ÿ há»¯u tÃªn miá»n vÃ  nháº­n chá»©ng chá»‰ mÃ  khÃ´ng cáº§n can thiá»‡p thá»§ cÃ´ng. ACME tá»± Ä‘á»™ng cáº¥p vÃ  gia háº¡n chá»©ng chá»‰, cáº£i thiá»‡n báº£o máº­t trang web, giáº£m lá»—i cá»§a con ngÆ°á»i trong quáº£n lÃ½ chá»©ng chá»‰ vÃ  Ä‘Æ°á»£c há»— trá»£ rá»™ng rÃ£i bá»Ÿi cÃ¡c cÆ¡ quan cáº¥p chá»©ng chá»‰ vÃ  mÃ¡y chá»§ web.
- Giao thá»©c ACME lÃ  má»™t tiÃªu chuáº©n má»Ÿ Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tá»± Ä‘á»™ng hÃ³a quÃ¡ trÃ¬nh cáº¥p phÃ¡t vÃ  gia háº¡n chá»©ng chá»‰ sá»‘, giÃºp Ä‘Æ¡n giáº£n hÃ³a Ä‘Ã¡ng ká»ƒ cÃ´ng tÃ¡c quáº£n lÃ½ chá»©ng chá»‰. ÄÆ°á»£c phÃ¡t triá»ƒn nháº±m tinh gá»n toÃ n bá»™ quy trÃ¬nh, ACME Ä‘Ã£ Ä‘Æ°á»£c nhiá»u Tá»• chá»©c cáº¥p chá»©ng chá»‰ (CA) Ã¡p dá»¥ng rá»™ng rÃ£i vÃ  trá»Ÿ thÃ nh má»™t tiÃªu chuáº©n Internet (RFC 8555).
- TrÆ°á»›c khi cÃ³ ACME, viá»‡c Ä‘Äƒng kÃ½ vÃ  quáº£n lÃ½ chá»©ng chá»‰ SSL/TLS thÆ°á»ng yÃªu cáº§u thao tÃ¡c thá»§ cÃ´ng vÃ  tá»‘n thá»i gian. Quáº£n trá»‹ viÃªn há»‡ thá»‘ng pháº£i:
	- Táº¡o yÃªu cáº§u kÃ½ chá»©ng chá»‰ (CSR)
	- Chá»©ng minh quyá»n sá»Ÿ há»¯u tÃªn miá»n qua nhiá»u phÆ°Æ¡ng thá»©c khÃ¡c nhau
	- Gá»­i CSR Ä‘áº¿n Tá»• chá»©c cáº¥p chá»©ng chá»‰
	- Chá» phÃª duyá»‡t vÃ  cáº¥p chá»©ng chá»‰
	- CÃ i Ä‘áº·t chá»©ng chá»‰ thá»§ cÃ´ng trÃªn mÃ¡y chá»§ web
	- Theo dÃµi vÃ  gia háº¡n chá»©ng chá»‰ trÆ°á»›c khi háº¿t háº¡n
- Quy trÃ¬nh nÃ y dá»… dáº«n Ä‘áº¿n lá»—i do con ngÆ°á»i vÃ  cÃ³ thá»ƒ khiáº¿n chá»©ng chá»‰ háº¿t háº¡n, gÃ¢y cáº£nh bÃ¡o báº£o máº­t cho ngÆ°á»i truy cáº­p.
- ACME tá»± Ä‘á»™ng hÃ³a toÃ n bá»™ quy trÃ¬nh thÃ´ng qua má»™t giao thá»©c tiÃªu chuáº©n cho phÃ©p mÃ¡y chá»§ web giao tiáº¿p trá»±c tiáº¿p vá»›i Tá»• chá»©c cáº¥p chá»©ng chá»‰. MÃ¡y chá»§ web (ACME client) gá»­i yÃªu cáº§u cáº¥p chá»©ng chá»‰ cho tÃªn miá»n cá»¥ thá»ƒ. Tá»• chá»©c cáº¥p chá»©ng chá»‰ (ACME server) Ä‘Æ°a ra thá»­ thÃ¡ch Ä‘á»ƒ xÃ¡c minh quyá»n sá»Ÿ há»¯u tÃªn miá»n, thÆ°á»ng báº±ng cÃ¡ch yÃªu cáº§u Ä‘áº·t má»™t tá»‡p xÃ¡c thá»±c trÃªn mÃ¡y chá»§. Khi quÃ¡ trÃ¬nh xÃ¡c minh hoÃ n táº¥t, chá»©ng chá»‰ Ä‘Æ°á»£c phÃ¡t hÃ nh vÃ  cÃ i Ä‘áº·t tá»± Ä‘á»™ng. ToÃ n bá»™ quy trÃ¬nh cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n hoÃ n toÃ n tá»± Ä‘á»™ng, bao gá»“m cáº£ cÃ i Ä‘áº·t ban Ä‘áº§u vÃ  cÃ¡c láº§n gia háº¡n Ä‘á»‹nh ká»³.
- Giao thá»©c ACME mang láº¡i nhiá»u lá»£i Ã­ch cho chá»§ sá»Ÿ há»¯u vÃ  quáº£n trá»‹ viÃªn website:
	- Tá»± Ä‘á»™ng hÃ³a: Giáº£m Ä‘Ã¡ng ká»ƒ sá»± can thiá»‡p thá»§ cÃ´ng trong quÃ¡ trÃ¬nh quáº£n lÃ½ chá»©ng chá»‰.
	- TÄƒng cÆ°á»ng báº£o máº­t: Gia háº¡n Ä‘á»‹nh ká»³ vÃ  tá»± Ä‘á»™ng giÃºp chá»©ng chá»‰ luÃ´n Ä‘Æ°á»£c cáº­p nháº­t.
	- Tiáº¿t kiá»‡m chi phÃ­: Nhiá»u CA há»— trá»£ ACME cung cáº¥p chá»©ng chá»‰ miá»…n phÃ­ hoáº·c chi phÃ­ tháº¥p.
	- Giáº£m thiá»ƒu lá»—i: Tá»± Ä‘á»™ng hÃ³a giÃºp háº¡n cháº¿ rá»§i ro sai sÃ³t do con ngÆ°á»i.
	- Kháº£ nÄƒng má»Ÿ rá»™ng: Cho phÃ©p quáº£n lÃ½ chá»©ng chá»‰ dá»… dÃ ng cho nhiá»u tÃªn miá»n hoáº·c subdomain.
	- Chuáº©n hÃ³a: LÃ  má»™t tiÃªu chuáº©n má»Ÿ, ACME thÃºc Ä‘áº©y kháº£ nÄƒng tÆ°Æ¡ng thÃ­ch giá»¯a cÃ¡c há»‡ thá»‘ng khÃ¡c nhau.
#### Certbot Auto Renew 
- Certbot cÃ i Ä‘áº·t máº·c Ä‘á»‹nh thÆ°á»ng Ä‘Ã£ bao gá»“m tÃ¡c vá»¥ tá»± Ä‘á»™ng gia háº¡n. CÃ³ thá»ƒ kiá»ƒm tra báº±ng lá»‡nh 
```
systemctl list-timers | grep certbot
```
- Lá»‡nh renew 	
	```
	sudo certbot renew 
	```
	- CÃ³ thá»ƒ kiá»ƒm tra mÃ´ phá»ng viá»‡c renew báº±ng option `--dry-run`
- Cáº¥u hÃ¬nh auto renew certbot báº±ng crontab 
	```
	sudo crontab -e
	```
	- ThÃªm lá»‡nh certbot vÃ o lá»‹ch cháº¡y hÃ ng ngÃ y. Trong vÃ­ dá»¥ nÃ y, lá»‡nh Ä‘Æ°á»£c thiáº¿t láº­p Ä‘á»ƒ cháº¡y vÃ o 12:00 trÆ°a má»—i ngÃ y. Lá»‡nh sáº½ kiá»ƒm tra chá»©ng chá»‰ hiá»‡n cÃ³ trÃªn mÃ¡y chá»§ cÃ³ háº¿t háº¡n trong vÃ²ng 30 ngÃ y hay khÃ´ng vÃ  sáº½ tá»± Ä‘á»™ng gia háº¡n náº¿u cáº§n. Tham sá»‘ --quiet Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ háº¡n cháº¿ viá»‡c táº¡o Ä‘áº§u ra.
	```
	0 12 * * * /usr/bin/certbot renew --quiet
	```
	- LÆ°u vÃ  Ä‘Ã³ng tá»‡p cáº¥u hÃ¬nh. Táº¥t cáº£ chá»©ng chá»‰ Ä‘Ã£ cÃ i Ä‘áº·t sáº½ Ä‘Æ°á»£c tá»± Ä‘á»™ng gia háº¡n.

## 7. Cáº¥u hÃ¬nh & kiá»ƒm tra SSL
### 7.1 Cáº¥u hÃ¬nh HTTPS redirect (301)
- Cáº¥u hÃ¬nh chuyá»ƒn hÆ°á»›ng HTTPS vá»›i mÃ£ tráº¡ng thÃ¡i 301 lÃ  má»™t bÆ°á»›c quan trá»ng trong viá»‡c Ä‘áº£m báº£o tÃ­nh báº£o máº­t vÃ  chuyÃªn nghiá»‡p cho website. Khi ngÆ°á»i dÃ¹ng truy cáº­p vÃ o phiÃªn báº£n HTTP (khÃ´ng an toÃ n), mÃ¡y chá»§ sáº½ tá»± Ä‘á»™ng chuyá»ƒn há» sang phiÃªn báº£n HTTPS (cÃ³ mÃ£ hÃ³a SSL) vá»›i mÃ£ pháº£n há»“i 301 â€” nghÄ©a lÃ  chuyá»ƒn hÆ°á»›ng vÄ©nh viá»…n.
- CÃ¡ch cáº¥u hÃ¬nh vá»›i má»™t sá»‘ WebServer 
	- Apache: 
		- Sá»­ dá»¥ng .htaccess
			- ThÃªm Ä‘oáº¡n sau vÃ o tá»‡p .htaccess trong thÆ° má»¥c gá»‘c cá»§a website:
			```
			<IfModule mod_rewrite.c>
			  RewriteEngine On
			  RewriteCond %{HTTPS} !=on
			  RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
			</IfModule>
			```
			- YÃªu cáº§u: Apache pháº£i báº­t mod_rewrite.
		- Chá»‰nh sá»­a trong file `VirtualHost` thÃªm dÃ²ng sau vÃ o pháº§n cáº¥u hÃ¬nh cá»§a `VirtualHost` trÃªn port 80:
			`Redirect permanent / https://yourdomain.com/` 
			```
			## port 80
			<VirtualHost *:80>
			ServerName yourdomain.com
			Redirect permanent / https://yourdomain.com/
			</VirtualHost>
			## port 443
			<VirtualHost _default_:443>
			ServerName yourdomain.com
			DocumentRoot /usr/local/apache2/htdocs
			SSLEngine On
			...
			</VirtualHost>

			```
		- Sau khi chá»‰nh sá»­a, cáº§n reload Apache:
		```
		sudo systemctl restart apache2
		```
	- Nginx: 
		- Chá»‰nh sá»­a trong khá»‘i cáº¥u hÃ¬nh server láº¯ng nghe cá»•ng 80 (HTTP), thÃªm:
		```
		server {
			listen 80;
			server_name yourdomain.com www.yourdomain.com;
			return 301 https://$host$request_uri;
		}
		```
		- Sau khi chá»‰nh sá»­a, cáº§n reload Nginx:
		```
		sudo systemctl reload nginx
		```

	- Tomcat
		- Trong tá»‡p server.xml, chá»‰nh cáº¥u hÃ¬nh cá»•ng 80 nhÆ° sau:
		```
		<Connector port="80" redirectPort="443" />
		```
		- VÃ  Ä‘áº£m báº£o cá»•ng 443 Ä‘Ã£ Ä‘Æ°á»£c cáº¥u hÃ¬nh vá»›i SSL.

	- IIS (Windows Server)
		- Sá»­ dá»¥ng URL Rewrite 
			- CÃ i Ä‘áº·t module URL Rewrite.
			- Má»Ÿ IIS Manager â†’ chá»n website â†’ má»Ÿ URL Rewrite.
			- ThÃªm quy táº¯c má»›i (Inbound Rule) vá»›i Ä‘iá»u kiá»‡n {HTTPS} = OFF vÃ  hÃ nh Ä‘á»™ng Redirect Ä‘áº¿n https://{HTTP_HOST}/{R:1}.
		- Sá»­ dá»¥ng HTTP redirect
			- Táº¡i panel quáº£n lÃ½ website: Chá»n Ã´ Redirect vÃ  nháº­p URL Ä‘Ã­ch sá»­ dá»¥ng giao thá»©c HTTPS. Thiáº¿t láº­p tráº¡ng thÃ¡i chuyá»ƒn hÆ°á»›ng lÃ  chuyá»ƒn hÆ°á»›ng vÄ©nh viá»…n (301).
		- Sá»­ dá»¥ng option `Redirect HTTP to HTTPS` trong cÃ i Ä‘áº·t `HSTS` 
		- ![images](./images/s-213.png) 
- Cáº¥u hÃ¬nh vá»›i cÃ¡c Web hosting control panel
	- cPanel 
		- VÃ o Domains.
		- Báº­t tÃ¹y chá»n Force HTTPS Redirect cho tÃªn miá»n cáº§n chuyá»ƒn hÆ°á»›ng.
		- ![images](./images/s-9.png)

	- DirecAdmin
		- VÃ o User Level â†’ Domain Setup â†’ chá»n tÃªn miá»n.
		- Báº­t tÃ¹y chá»n: Force SSL with https redirect.
		- ![images](./images/s-7.png)
	- Plesk
		- ÄÄƒng nháº­p Plesk.
		- VÃ o Websites & Domains â†’ chá»n tÃªn miá»n â†’ Hosting Settings.
		- TÃ­ch chá»n: Permanent SEO-safe 301 redirect from HTTP to HTTPS.
		- ![images](./images/s-8.png)

### 7.2 Cáº¥u hÃ¬nh HSTS, OCSP Stapling, HTTP/2
#### 7.2.1 HSTS 
- HTTP Strict Transport Security (HSTS) lÃ  má»™t cÆ¡ cháº¿ chÃ­nh sÃ¡ch báº£o máº­t web giÃºp báº£o vá»‡ website khá»i cÃ¡c cuá»™c táº¥n cÃ´ng háº¡ cáº¥p giao thá»©c (protocol downgrade) vÃ  chiáº¿m Ä‘oáº¡t cookie. CÆ¡ cháº¿ nÃ y cho phÃ©p mÃ¡y chá»§ web khai bÃ¡o ráº±ng trÃ¬nh duyá»‡t (hoáº·c cÃ¡c tÃ¡c nhÃ¢n ngÆ°á»i dÃ¹ng tÆ°Æ¡ng thÃ­ch khÃ¡c) chá»‰ Ä‘Æ°á»£c phÃ©p giao tiáº¿p thÃ´ng qua káº¿t ná»‘i HTTPS báº£o máº­t vÃ  tuyá»‡t Ä‘á»‘i khÃ´ng sá»­ dá»¥ng giao thá»©c HTTP khÃ´ng an toÃ n.
- HSTS (HTTP Strict Transport Security) Ä‘Æ°á»£c phÃ¡t triá»ƒn nháº±m giáº£i quyáº¿t má»™t sá»‘ lá»— há»•ng báº£o máº­t khi website chá»‰ dá»±a vÃ o HTTPS mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p bá»• sung:
	- Táº¥n cÃ´ng SSL Stripping: Káº» táº¥n cÃ´ng cÃ³ thá»ƒ cháº·n yÃªu cáº§u HTTP ban Ä‘áº§u vÃ  chuyá»ƒn hÆ°á»›ng ngÆ°á»i dÃ¹ng Ä‘áº¿n phiÃªn báº£n khÃ´ng báº£o máº­t cá»§a trang web.
	- Ná»™i dung há»—n há»£p (Mixed Content): Má»™t sá»‘ tÃ i nguyÃªn trÃªn trang váº«n cÃ³ thá»ƒ Ä‘Æ°á»£c táº£i qua HTTP, gÃ¢y rá»§i ro báº£o máº­t.
	- HÃ nh vi ngÆ°á»i dÃ¹ng: NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ nháº­p â€œhttp://â€ hoáº·c bá» qua giao thá»©c khi gÃµ URL, vÃ´ tÃ¬nh sá»­ dá»¥ng káº¿t ná»‘i khÃ´ng báº£o máº­t.
	- HSTS kháº¯c phá»¥c cÃ¡c váº¥n Ä‘á» nÃ y báº±ng cÃ¡ch buá»™c má»i káº¿t ná»‘i pháº£i sá»­ dá»¥ng HTTPS, ká»ƒ cáº£ khi ngÆ°á»i dÃ¹ng truy cáº­p qua HTTP.
- CÆ¡ cháº¿ hoáº¡t Ä‘á»™ng cá»§a HSTS
	- Khi mÃ¡y chá»§ web gá»­i tiÃªu Ä‘á» HSTS trong pháº£n há»“i, trÃ¬nh duyá»‡t sáº½ Ä‘Æ°á»£c hÆ°á»›ng dáº«n:
	- Tá»± Ä‘á»™ng chuyá»ƒn má»i liÃªn káº¿t HTTP sang HTTPS.
	- NgÄƒn ngÆ°á»i dÃ¹ng bá» qua cáº£nh bÃ¡o chá»©ng chá»‰.
	- Ghi nhá»› chÃ­nh sÃ¡ch nÃ y trong khoáº£ng thá»i gian xÃ¡c Ä‘á»‹nh (qua tham sá»‘ max-age).
- Cáº¥u trÃºc tiÃªu Ä‘á» HSTS
	- max-age: Thá»i gian (tÃ­nh báº±ng giÃ¢y) mÃ  trÃ¬nh duyá»‡t ghi nhá»› viá»‡c Ã©p buá»™c HTTPS.
	- includeSubDomains (tÃ¹y chá»n): Ãp dá»¥ng chÃ­nh sÃ¡ch HSTS cho toÃ n bá»™ subdomain.
	- preload (tÃ¹y chá»n): Cho biáº¿t chá»§ sá»Ÿ há»¯u Ä‘á»“ng Ã½ Ä‘Æ°a tÃªn miá»n vÃ o danh sÃ¡ch táº£i sáºµn HSTS cá»§a trÃ¬nh duyá»‡t.
- Lá»£i Ã­ch khi triá»ƒn khai HSTS
	- TÄƒng cÆ°á»ng báº£o máº­t: NgÄƒn cháº·n táº¥n cÃ´ng dáº¡ng man-in-the-middle, SSL stripping vÃ  chiáº¿m quyá»n cookie.
	- Cáº£i thiá»‡n tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng: Tá»± Ä‘á»™ng chuyá»ƒn hÆ°á»›ng sang HTTPS giÃºp giáº£m Ä‘á»™ trá»….
	- Tá»‘i Æ°u hÃ³a SEO: CÃ¡c cÃ´ng cá»¥ tÃ¬m kiáº¿m Æ°u tiÃªn website báº£o máº­t hÆ¡n, cÃ³ thá»ƒ cáº£i thiá»‡n thá»© háº¡ng.
	- Há»— trá»£ tuÃ¢n thá»§: ÄÃ¡p á»©ng yÃªu cáº§u báº£o vá»‡ dá»¯ liá»‡u vÃ  quyá»n riÃªng tÆ° trong cÃ¡c quy Ä‘á»‹nh phÃ¡p lÃ½.
- Cáº¥u hÃ¬nh HSTS trÃªn cÃ¡c WebServer 
	- TrÆ°á»›c khi triá»ƒn khai HSTS, cáº§n Ä‘áº£m báº£o website hoáº¡t Ä‘á»™ng Ä‘áº§y Ä‘á»§ qua HTTPS:
		- Cáº¥p phÃ¡t chá»©ng chá»‰ SSL/TLS tá»« Tá»• chá»©c cáº¥p chá»©ng chá»‰ (CA) Ä‘Ã¡ng tin cáº­y, cháº³ng háº¡n nhÆ° SSL.com.
		- CÃ i Ä‘áº·t chá»©ng chá»‰ lÃªn mÃ¡y chá»§ web.
		- Cáº¥u hÃ¬nh mÃ¡y chá»§ web Ä‘á»ƒ sá»­ dá»¥ng káº¿t ná»‘i HTTPS.
		- Cáº­p nháº­t táº¥t cáº£ liÃªn káº¿t ná»™i bá»™ sang giao thá»©c HTTPS.
		- Äáº£m báº£o toÃ n bá»™ tÃ i nguyÃªn bÃªn ngoÃ i (script, hÃ¬nh áº£nh, v.v.) Ä‘Æ°á»£c táº£i qua HTTPS.
	- Báº¯t Ä‘áº§u báº±ng cÃ¡ch thÃªm tiÃªu Ä‘á» HSTS vá»›i giÃ¡ trá»‹ max-age ngáº¯n Ä‘á»ƒ kiá»ƒm tra cáº¥u hÃ¬nh. VÃ­ dá»¥: sá»­ dá»¥ng max-age=300 (tÆ°Æ¡ng Ä‘Æ°Æ¡ng 5 phÃºt).
	- Apache2 
		- Äá»ƒ sá»­ dá»¥ng header HSTS cáº§n enable module headers trong Apache2
			```
			a2enmode headers.load
			```
		- Bá»• sung header HSTS vÃ o VirtualHost cáº§n cáº¥u hÃ¬nh `/etc/apache2/sites-enabled/`: Cáº¥u hÃ¬nh máº«u  
			```
			<VirtualHost *:443>
			...
			Header always set Strict-Transport-Security "max-age=300; includeSubDomains; preload"
			...
			</VirtualHost>
			```
			- ChÃº Ã½ chá»‰ cáº¥u hÃ¬nh trÃªn VirtualHost ssl trÃªn port 443 
			- Hoáº·c cÃ³ thá»ƒ cáº¥u hÃ¬nh thÃªm header trÃªn trong file `.htaccess` táº¡i thÆ° má»¥c gá»‘c cá»§a web 
	- Nginx 
		- ThÃªm header HSTS táº¡i cÃ¡c file VirtualHost cáº§n cáº¥u hÃ¬nh 
		`add_header Strict-Transport-Security "max-age=300; includeSubDomains; preload" always;`
		- Cáº¥u hÃ¬nh máº«u 
		```
		server {
			listen 80 default_server;
			listen [::]:80 default_server;
			server_name _;
			# Discourage deep links by using a permanent redirect to home page of HTTPS site
			return 301 https://$host;
			# Alternatively, redirect all HTTP links to the matching HTTPS page 
			# return 301 https://$host$request_uri;
		}
		server {
			listen 443 ssl;
			server_name www.example.com;

			add_header Strict-Transport-Security "max-age=300; includeSubDomains" always;
		}
		```
	- IIS 
		- Má»Ÿ IIS Manager (inetmgr)
		- Trong khung Connections, chá»n website báº¡n muá»‘n cáº¥u hÃ¬nh
		- á» khung Actions bÃªn pháº£i, tÃ¬m má»¥c Configure, chá»n HSTS
		- ![images](./images/s-212.png) 
		- Cá»­a sá»• Edit Website HSTS sáº½ hiá»‡n ra: Chá»n 
			- Enable â†’ Ä‘á»ƒ báº­t HSTS
			- Redirect HTTP to HTTPS â†’ Ä‘á»ƒ IIS tá»± chuyá»ƒn hÆ°á»›ng ngÆ°á»i dÃ¹ng tá»« HTTP sang HTTPS
			- Nháº¥n OK Ä‘á»ƒ lÆ°u cáº¥u hÃ¬nh
		- ![images](./images/s-213.png) 
	- Apache Tomcat 
		- Tomcat cung cáº¥p bá»™ lá»c cÃ³ tÃªn HttpHeaderSecurityFilter, cho phÃ©p thÃªm cÃ¡c tiÃªu Ä‘á» HTTP báº£o máº­t nhÆ° Strict-Transport-Security, X-Frame-Options vÃ  X-Content-Type-Options vÃ o pháº£n há»“i.
		- Bá»™ lá»c nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c thÃªm vÃ  cáº¥u hÃ¬nh nhÆ° cÃ¡c bá»™ lá»c khÃ¡c thÃ´ng qua tá»‡p web.xml. VÃ­ dá»¥ cáº¥u hÃ¬nh trong tá»‡p conf/web.xml.
		```
		<filter>
		  <filter-name>httpHeaderSecurity</filter-name>
		  <filter-class>org.apache.catalina.filters.HttpHeaderSecurityFilter</filter-class>
		  <async-supported>true</async-supported>
		  <init-param>
			<param-name>hstsEnabled</param-name>
			<param-value>true</param-value>
		  </init-param>
		  <init-param>
			<param-name>hstsMaxAgeSeconds</param-name>
			<param-value>300</param-value>
		  </init-param>
		  <init-param>
			<param-name>hstsIncludeSubDomains</param-name>
			<param-value>true</param-value>
		  </init-param>
		</filter>
		 
		<!-- The mapping for the HTTP header security Filter -->
		<filter-mapping>
		  <filter-name>httpHeaderSecurity</filter-name>
		  <url-pattern>/*</url-pattern>
		  <dispatcher>REQUEST</dispatcher>
		</filter-mapping>
		```
#### 7.2.2 OCSP Stapling
- OCSP (Online Certificate Status Protocol) lÃ  má»™t giao thá»©c Internet dÃ¹ng Ä‘á»ƒ kiá»ƒm tra tráº¡ng thÃ¡i thu há»“i cá»§a chá»©ng chá»‰ sá»‘ X.509, thay tháº¿ cho phÆ°Æ¡ng phÃ¡p sá»­ dá»¥ng danh sÃ¡ch thu há»“i chá»©ng chá»‰ (CRL). OCSP cho phÃ©p cÃ¡c á»©ng dá»¥ng (nhÆ° trÃ¬nh duyá»‡t web) kiá»ƒm tra trá»±c tuyáº¿n xem má»™t chá»©ng chá»‰ cÃ³ cÃ²n hiá»‡u lá»±c hay Ä‘Ã£ bá»‹ thu há»“i hay khÃ´ng.
- OCSP stapling lÃ  má»™t ká»¹ thuáº­t Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t vÃ  báº£o máº­t cá»§a giao thá»©c SSL/TLS báº±ng cÃ¡ch cho phÃ©p mÃ¡y chá»§ web cung cáº¥p trá»±c tiáº¿p pháº£n há»“i OCSP (Online Certificate Status Protocol) Ä‘Ã£ Ä‘Æ°á»£c kÃ½ vÃ  Ä‘Ã³ng dáº¥u thá»i gian cho trÃ¬nh duyá»‡t, thay vÃ¬ trÃ¬nh duyá»‡t pháº£i tá»± truy váº¥n cÆ¡ quan cáº¥p chá»©ng chá»‰ (CA). Äiá»u nÃ y giÃºp tÄƒng tá»‘c quÃ¡ trÃ¬nh thiáº¿t láº­p káº¿t ná»‘i vÃ  giáº£m táº£i cho cÃ¡c CA. 
- Hoáº¡t Ä‘á»™ng cá»§a OCSP stapling 
1. MÃ¡y chá»§ web Ä‘á»‹nh ká»³ yÃªu cáº§u pháº£n há»“i OCSP: MÃ¡y chá»§ web Ä‘á»‹nh ká»³ gá»­i yÃªu cáº§u Ä‘áº¿n OCSP responder (thÆ°á»ng lÃ  CA hoáº·c nhÃ  cung cáº¥p dá»‹ch vá»¥ khÃ¡c) Ä‘á»ƒ xÃ¡c thá»±c chá»©ng chá»‰ SSL/TLS cá»§a nÃ³.
2. Pháº£n há»“i Ä‘Æ°á»£c Ä‘Ã³ng dáº¥u thá»i gian vÃ  kÃ½ sá»‘: OCSP responder sáº½ tráº£ vá» má»™t pháº£n há»“i Ä‘Ã£ Ä‘Æ°á»£c kÃ½ sá»‘ vÃ  Ä‘Ã³ng dáº¥u thá»i gian, xÃ¡c nháº­n tráº¡ng thÃ¡i cá»§a chá»©ng chá»‰ (vÃ­ dá»¥: cÃ²n hiá»‡u lá»±c, bá»‹ thu há»“i).
3. MÃ¡y chá»§ web "ghim" (staple) pháº£n há»“i: MÃ¡y chá»§ web lÆ°u trá»¯ pháº£n há»“i nÃ y vÃ  gá»­i nÃ³ cÃ¹ng vá»›i chá»©ng chá»‰ cho trÃ¬nh duyá»‡t trong quÃ¡ trÃ¬nh báº¯t tay SSL/TLS.
4. TrÃ¬nh duyá»‡t xÃ¡c thá»±c chá»©ng chá»‰: TrÃ¬nh duyá»‡t nháº­n pháº£n há»“i Ä‘Ã£ Ä‘Æ°á»£c ghim vÃ  xÃ¡c thá»±c chá»©ng chá»‰ mÃ  khÃ´ng cáº§n pháº£i thá»±c hiá»‡n truy váº¥n riÃªng Ä‘áº¿n OCSP responder. 
- Æ¯u Ä‘iá»ƒm cá»§a OCSP stapling:
	- Cáº£i thiá»‡n hiá»‡u suáº¥t: Giáº£m thá»i gian thiáº¿t láº­p káº¿t ná»‘i SSL/TLS vÃ¬ trÃ¬nh duyá»‡t khÃ´ng cáº§n thá»±c hiá»‡n thÃªm má»™t bÆ°á»›c truy váº¥n OCSP, giÃºp cáº£i thiá»‡n tá»‘c Ä‘á»™ táº£i trang web. 
	- TÄƒng cÆ°á»ng báº£o máº­t: Giáº£m táº£i cho cÃ¡c CA, giáº£m nguy cÆ¡ bá»‹ táº¥n cÃ´ng tá»« chá»‘i dá»‹ch vá»¥ (DoS) hoáº·c cÃ¡c cuá»™c táº¥n cÃ´ng khÃ¡c nháº¯m vÃ o OCSP responder. 
	- Cáº£i thiá»‡n quyá»n riÃªng tÆ°: TrÃ¡nh viá»‡c lá»™ thÃ´ng tin duyá»‡t web cá»§a ngÆ°á»i dÃ¹ng cho cÃ¡c bÃªn thá»© ba, vÃ¬ trÃ¬nh duyá»‡t khÃ´ng cÃ²n pháº£i trá»±c tiáº¿p truy váº¥n OCSP responder. 
	- Äá»™ tin cáº­y cao: Äáº£m báº£o ráº±ng trÃ¬nh duyá»‡t luÃ´n nháº­n Ä‘Æ°á»£c pháº£n há»“i OCSP má»›i nháº¥t vÃ  há»£p lá»‡, giÃºp tÄƒng cÆ°á»ng Ä‘á»™ tin cáº­y cá»§a quÃ¡ trÃ¬nh xÃ¡c thá»±c chá»©ng chá»‰. 
- NhÆ°á»£c Ä‘iá»ƒm 
	- KhÃ´ng pháº£i táº¥t cáº£ trÃ¬nh duyá»‡t hoáº·c mÃ¡y chá»§ web Ä‘á»u há»— trá»£ OCSP Stapling.
	- Náº¿u OCSP Stapling khÃ´ng Ä‘Æ°á»£c kÃ­ch hoáº¡t hoáº·c trÃªn trÃ¬nh duyá»‡t hoáº·c mÃ¡y chá»§ web, nÃ³ khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng vÃ  tra cá»©u tráº¡ng thÃ¡i há»£p lá»‡ sáº½ Ä‘Æ°á»£c tá»± Ä‘á»™ng hoÃ n nguyÃªn vá» OCSP kiá»ƒm tra trá»±c tiáº¿p vá»›i Certificate Authority
- OCSP stapling lÃ  má»™t ká»¹ thuáº­t hiá»‡u quáº£ Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t vÃ  báº£o máº­t cá»§a SSL/TLS báº±ng cÃ¡ch cho phÃ©p mÃ¡y chá»§ web tá»± xÃ¡c thá»±c chá»©ng chá»‰ vÃ  cung cáº¥p pháº£n há»“i cho trÃ¬nh duyá»‡t, thay vÃ¬ Ä‘á»ƒ trÃ¬nh duyá»‡t tá»± thá»±c hiá»‡n viá»‡c nÃ y. 
- Cáº¥u hÃ¬nh OCSP Stapling vá»›i cÃ¡c web server 
- Apache 
	- OCSP stapling Ä‘Æ°á»£c há»— trá»£ ká»ƒ tá»« phiÃªn báº£n Apache 2.3.3 trá»Ÿ Ä‘i. Kiá»ƒm tra báº±ng lá»‡nh 
	```
	apache2 -v
	```
	- Táº£i vá» gÃ³i chá»©ng chá»‰ CA (CA bundle): Tiáº¿n hÃ nh láº¥y cÃ¡c chá»©ng chá»‰ Root CA vÃ  Intermediate CA á»Ÿ Ä‘á»‹nh dáº¡ng PEM, sau Ä‘Ã³ lÆ°u táº¥t cáº£ vÃ o cÃ¹ng má»™t tá»‡p. GÃ³i chá»©ng chá»‰ nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¢y dá»±ng chuá»—i xÃ¡c thá»±c Ä‘áº§y Ä‘á»§ trÃªn mÃ¡y chá»§.
	- File CA bundle bao gá»“m cáº£ chá»©ng chá»‰ CA intermediate vÃ  CA root.
	- Chá»‰nh sá»­a thÃªm cÃ¡c cáº¥u hÃ¬nh trong VirtualHost
		- ThÃ´ng sá»‘ cache: Cáº¥u hÃ¬nh nÆ¡i lÆ°u cache, Ä‘áº·t bÃªn ngoÃ i cáº·p `<VirtualHost> </VirtualHost>`
		```
		SSLStaplingCache shmcb:/tmp/stapling_cache(128000)
		```
		- CÃ¡c thÃ´ng sá»‘ enable tÃ­nh nÄƒng vÃ  trá» tá»›i trust chain certificate Ä‘áº·t trong cáº·p `<VirtualHost> </VirtualHost>`
		```
		SSLCACertificateFile /etc/ssl/ca-certs.pem
		SSLUseStapling on
		```
	- Cáº¥u hÃ¬nh máº«u 
	```
	<IfModule mod_ssl.c>
		SSLStaplingCache shmcb:/tmp/stapling_cache(128000)
		<VirtualHost *:443>

				ServerAdmin webmaster@localhost
				ServerName example.com
				DocumentRoot /var/www

				SSLEngine on

				SSLCertificateFile /etc/apache2/ssl/example.com/apache.crt
				SSLCertificateKeyFile /etc/apache2/ssl/example.com/apache.key

				SSLCACertificateFile /etc/ssl/ca-certs.pem
				SSLUseStapling on
		</VirtualHost>
	</IfModule>
	```
	- Test
	```
	apachectl -t
	```
	- Reload Ä‘á»ƒ apply 
	```
	service apache2 reload
	```
- Nginx	
	- OCSP stapling Ä‘Æ°á»£c há»— trá»£ ká»ƒ tá»« phiÃªn báº£n Nginx 1.3.7+. trá»Ÿ Ä‘i. Kiá»ƒm tra báº±ng lá»‡nh 
	```
	nginx -v
	```
	- Chá»‰nh sá»­a cáº¥u hÃ¬nh táº¡i cÃ¡c file virtualhost : ThÃªm cÃ¡c thá»‘ng sá»‘ sau 
	```
	ssl_stapling on;
	ssl_stapling_verify on;
	ssl_trusted_certificate /etc/ssl/private/ca-certs.pem;
	```
	- Cáº¥u hÃ¬nh máº«u 
	```
	server {

			listen   443;
			server_name example.org;

			root /usr/share/nginx/www;
			index index.html index.htm;

			ssl on;
			ssl_certificate /etc/nginx/ssl/example.org/server.crt;
			ssl_certificate_key /etc/nginx/ssl/example.org/server.key;

			ssl_stapling on;
			ssl_stapling_verify on;
			ssl_trusted_certificate /etc/ssl/private/ca-certs.pem;
	}
	```
	- Test
	```
	service nginx configtest
	```
	- Reload Ä‘á»ƒ Apply
	```
	service nginx reload
	```
- IIS
	- Máº·c Ä‘á»‹nh IIS há»— trá»£ OCSP stapling tá»« Windows Server 2008 
	- Tuy nhiÃªn Ä‘á»‘i vá»›i Host sá»­ dá»¥ng tÃ­nh nÄƒng Server Name Indication hoáº·c Use Centralized Certificate Store cáº§n cáº¥u hÃ¬nh enable:
	- Táº¡i Ä‘Æ°á»ng dáº«n registry `[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL]`
	- ThÃªm subkey `"EnableOcspStaplingForSni"=dword:00000001`
- Tomcat 
	- Äá»ƒ kÃ­ch hoáº¡t OCSP Stapling trong Tomcat, cáº§n Ä‘áº£m báº£o cáº¥u hÃ¬nh Tomcat sá»­ dá»¥ng chá»©ng chá»‰ cÃ³ há»— trá»£ OCSP vÃ  trÃ¬nh káº¿t ná»‘i Tomcat Native Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘á»ƒ sá»­ dá»¥ng OpenSSL. NgoÃ i ra, cáº§n cáº¥u hÃ¬nh OCSP responder vÃ  Ä‘áº£m báº£o chá»©ng chá»‰ chá»©a thÃ´ng tin OCSP cáº§n thiáº¿t. Khi Ä‘Æ°á»£c thiáº¿t láº­p Ä‘Ãºng, Tomcat sáº½ tá»± Ä‘á»™ng xá»­ lÃ½ quÃ¡ trÃ¬nh stapling khi cÃ³ yÃªu cáº§u tá»« phÃ­a client.
	- KÃ­ch hoáº¡t APR Connector:
		- Trong tá»‡p server.xml, Ä‘áº£m báº£o APR connector Ä‘Æ°á»£c báº­t vá»›i cÃ¡c thuá»™c tÃ­nh nhÆ° sau:
	```
	SSLEnabled="true"
	protocol="org.apache.coyote.http11.Http11AprProtocol"
	```
	- Cáº¥u hÃ¬nh SSL: Náº¿u sá»­ dá»¥ng keystore, cáº§n Ä‘áº£m báº£o keystore Ä‘Æ°á»£c cáº¥u hÃ¬nh chÃ­nh xÃ¡c trong APR connector.
	- Java 9 trá»Ÿ lÃªn: CÃ³ thá»ƒ báº­t OCSP Stapling báº±ng cÃ¡ch thiáº¿t láº­p thuá»™c tÃ­nh há»‡ thá»‘ng:	`jdk.tls.server.enableStatusRequestExtension`
	```
	System.setProperty(â€œjdk.tls.server.enableStatusRequestExtensionâ€, â€œtrueâ€);
	```

#### 7.2.3 HTTP/2
- HTTP/2 lÃ  phiÃªn báº£n lá»›n thá»© hai cá»§a HTTP â€“ giao thá»©c máº¡ng cáº¥p á»©ng dá»¥ng quy Ä‘á»‹nh cÃ¡ch ná»™i dung Ä‘Æ°á»£c truyá»n táº£i qua internet.
- Ra máº¯t vÃ o nÄƒm 2015, HTTP/2 thay tháº¿ HTTP/1.1 vá»›i má»¥c tiÃªu chÃ­nh lÃ  tÄƒng tá»‘c Ä‘á»™ phÃ¢n phá»‘i ná»™i dung.
- TÃ­nh nÄƒng chÃ­nh giÃºp HTTP/2 tÄƒng tá»‘c lÃ  Stream Multiplexing: táº¡o má»™t káº¿t ná»‘i duy nháº¥t cho má»i loáº¡i dá»¯ liá»‡u vÃ  truyá»n dá»¯ liá»‡u song song.
- NgoÃ i ra, HTTP/2 cÃ²n tÄƒng tá»‘c hÆ¡n ná»¯a nhá»:
	- NÃ©n tiÃªu Ä‘á» (Header Compression).
	- Æ¯u tiÃªn luá»“ng (Stream Prioritization).
	- Sá»­ dá»¥ng tÃ­nh nÄƒng Server Push.
- KhÃ¡c vá»›i HTTP/1.1, HTTP/2 lÃ  giao thá»©c nhá»‹ phÃ¢n, Ä‘iá»u nÃ y cÅ©ng giÃºp nÃ³ hiá»‡u quáº£ hÆ¡n.
- Cáº¥u hÃ¬nh vá»›i cÃ¡c Web server 
- Apache2
	- Enable Module HTTP2
	```
	sudo a2enmod http2
	```
	- Reload Apache Ä‘á»ƒ apply
	```
	sudo systemctl restart apache2
	```
- Nginx:
	- Äá»ƒ báº­t HTTP/2 trong Nginx, chÃºng ta cáº§n thÃªm tham sá»‘ http2 vÃ o chá»‰ thá»‹ listen trong cáº¥u hÃ¬nh virtual host: VÃ­ dá»¥ file cáº¥u hÃ¬nh máº«u:
	```
	listen 443 ssl http2;
	server {
	  listen 443 ssl http2;
	  listen [::]:443 ssl http2;
	  server_name example.com;
	  root /path/to/public;
	  ssl_certificate /path/to/certificate.crt;
	  ssl_certificate_key /path/to/private.key;
	  ssl_protocols TLSv1.2;
	}
	```
	- Reload Nginx Ä‘á»ƒ apply
	```
	sudo systemctl reload nginx.service
	```
- IIS: Máº·c Ä‘á»‹nh HTTP/2 sáº½ Ä‘Æ°á»£c enable khi enable HTTPS vÃ  cáº¥u hÃ¬nh chá»©ng chá»‰ SSL cho website
- Tomcat 
	- ÄÄƒng nháº­p vÃ o mÃ¡y chá»§ Tomcat vÃ  truy cáº­p thÆ° má»¥c cÃ i Ä‘áº·t
		- Truy cáº­p thÆ° má»¥c conf
		- Chá»‰nh sá»­a tá»‡p server.xml báº±ng vi hoáº·c trÃ¬nh soáº¡n tháº£o yÃªu thÃ­ch
		- ThÃªm dÃ²ng sau vÃ o pháº§n cáº¥u hÃ¬nh SSL Connector:
		```
		<UpgradeProtocol className="org.apache.coyote.http2.Http2Protocol" />
		```
		- Cáº¥u hÃ¬nh tá»•ng thá»ƒ sáº½ cÃ³ dáº¡ng nhÆ° sau:
		```
		<Connector port="443" protocol="org.apache.coyote.http11.Http11AprProtocol"
				   maxThreads="150" SSLEnabled="true" >
			<UpgradeProtocol className="org.apache.coyote.http2.Http2Protocol" />
			<SSLHostConfig>
				<Certificate certificateKeyFile="conf/key.pem"
							 certificateFile="conf/cert.pem"
							 certificateChainFile="conf/chain.pem"
							 type="RSA" />
			</SSLHostConfig>
		</Connector>
		```
	- Khá»Ÿi Ä‘á»™ng láº¡i Tomcat báº±ng cÃ¡ch chuyá»ƒn Ä‘áº¿n thÆ° má»¥c bin vÃ  thá»±c thi cÃ¡c lá»‡nh sau:
	```
	./shutdown.sh
	./startup.sh
	```

### 7.3 CÃ´ng cá»¥ kiá»ƒm tra SSL:
#### 7.3.1 SSL Labs
- SSL Labs, cá»¥ thá»ƒ lÃ  SSL Labs cá»§a Qualys, lÃ  má»™t cÃ´ng cá»¥ trá»±c tuyáº¿n miá»…n phÃ­ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm tra cáº¥u hÃ¬nh báº£o máº­t cá»§a cÃ¡c mÃ¡y chá»§ web, táº­p trung chá»§ yáº¿u vÃ o viá»‡c kiá»ƒm tra chá»©ng chá»‰ SSL/TLS vÃ  giao thá»©c liÃªn quan. NÃ³ Ä‘Ã¡nh giÃ¡ cÃ¡c khÃ­a cáº¡nh nhÆ° Ä‘á»™ máº¡nh cá»§a thuáº­t toÃ¡n mÃ£ hÃ³a, cáº¥u hÃ¬nh giao thá»©c, vÃ  kháº£ nÄƒng chá»‘ng láº¡i cÃ¡c táº¥n cÃ´ng tiá»m áº©n, tá»« Ä‘Ã³ cung cáº¥p thÃ´ng tin chi tiáº¿t vÃ  Ä‘iá»ƒm Ä‘Ã¡nh giÃ¡ vá» má»©c Ä‘á»™ báº£o máº­t cá»§a website. 
- SSL Lab cung cáº¥p 
	- Kiá»ƒm tra chá»©ng chá»‰ SSL/TLS: SSL Labs phÃ¢n tÃ­ch chá»©ng chá»‰ SSL/TLS cá»§a má»™t mÃ¡y chá»§, kiá»ƒm tra thá»i háº¡n, nhÃ  phÃ¡t hÃ nh, thuáº­t toÃ¡n kÃ½, vÃ  cÃ¡c thÃ´ng tin liÃªn quan khÃ¡c. 
	- ÄÃ¡nh giÃ¡ giao thá»©c vÃ  thuáº­t toÃ¡n: CÃ´ng cá»¥ nÃ y kiá»ƒm tra cÃ¡c giao thá»©c vÃ  thuáº­t toÃ¡n mÃ£ hÃ³a Ä‘Æ°á»£c há»— trá»£ bá»Ÿi mÃ¡y chá»§, bao gá»“m cáº£ TLS vÃ  cÃ¡c bá»™ mÃ£ hÃ³a, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh xem chÃºng cÃ³ Ä‘á»§ máº¡nh vÃ  an toÃ n hay khÃ´ng. 
	- PhÃ¢n tÃ­ch cáº¥u hÃ¬nh: SSL Labs Ä‘Ã¡nh giÃ¡ cáº¥u hÃ¬nh cá»§a mÃ¡y chá»§, bao gá»“m cáº£ viá»‡c há»— trá»£ cÃ¡c giao thá»©c lá»—i thá»i hoáº·c cÃ¡c bá»™ mÃ£ hÃ³a yáº¿u, vÃ  cung cáº¥p thÃ´ng tin chi tiáº¿t vá» cÃ¡c váº¥n Ä‘á» cáº¥u hÃ¬nh cÃ³ thá»ƒ xáº£y ra. 
	- Äiá»ƒm Ä‘Ã¡nh giÃ¡: Dá»±a trÃªn cÃ¡c phÃ¢n tÃ­ch, SSL Labs sáº½ Ä‘Æ°a ra má»™t Ä‘iá»ƒm Ä‘Ã¡nh giÃ¡ tá»•ng quan vá» má»©c Ä‘á»™ báº£o máº­t cá»§a mÃ¡y chá»§, giÃºp ngÆ°á»i dÃ¹ng dá»… dÃ ng hiá»ƒu Ä‘Æ°á»£c tÃ¬nh tráº¡ng báº£o máº­t cá»§a website. 
	- CÃ´ng cá»¥ kiá»ƒm tra trá»±c tuyáº¿n: SSL Labs lÃ  má»™t cÃ´ng cá»¥ trá»±c tuyáº¿n miá»…n phÃ­, ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ truy cáº­p vÃ  sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm tra báº¥t ká»³ website nÃ o. 
- ![images](./images/s-12.png)
- Test vá»›i `google.com`
- ![images](./images/s-13.png)
- ![images](./images/s-14.png)

#### 7.3.2 SSL Checker
- SSL checker lÃ  má»™t dá»‹ch vá»¥ trá»±c tuyáº¿n dÃ¹ng Ä‘á»ƒ kiá»ƒm tra vÃ  xÃ¡c minh tÃ­nh há»£p lá»‡ cá»§a chá»©ng chá»‰ SSL hoáº·c TLS cá»§a má»™t trang web/mÃ¡y chá»§. 
- SSL checker tool Ä‘Æ°a ra cÃ¡c thÃ´ng tin chi tiáº¿t vá» chá»©ng chá»‰ SSL/TLS vÃ  giÃºp quáº£n trá»‹ viÃªn vÃ  cÃ¡c chuyÃªn gia báº£o máº­t kiá»ƒm tra tÃ­nh toÃ n váº¹n vÃ  báº£o máº­t cá»§a trang web cá»§a há».
- SSL Checker lÃ  cÃ´ng cá»¥ há»¯u Ã­ch há»— trá»£ thá»±c hiá»‡n cÃ¡c chá»©c nÄƒng sau:
	- Kiá»ƒm tra tÃ­nh há»£p lá»‡ cá»§a chá»©ng chá»‰ SSL, xÃ¡c Ä‘á»‹nh thá»i gian cÃ²n hiá»‡u lá»±c vÃ  cáº£nh bÃ¡o khi chá»©ng chá»‰ Ä‘Ã£ háº¿t háº¡n.
	- Äáº£m báº£o tÃ­nh toÃ n váº¹n cá»§a chá»©ng chá»‰ báº±ng cÃ¡ch xÃ¡c minh chá»¯ kÃ½ sá»‘, giÃºp phÃ¡t hiá»‡n cÃ¡c hÃ nh vi táº¥n cÃ´ng hoáº·c can thiá»‡p trÃ¡i phÃ©p.
	- XÃ¡c minh danh tÃ­nh chá»§ sá»Ÿ há»¯u chá»©ng chá»‰ Ä‘á»ƒ Ä‘áº£m báº£o Ä‘á»™ tin cáº­y cá»§a káº¿t ná»‘i.
	- Kiá»ƒm tra thuáº­t toÃ¡n mÃ£ hÃ³a nháº±m Ä‘áº£m báº£o dá»¯ liá»‡u truyá»n táº£i giá»¯a mÃ¡y khÃ¡ch vÃ  mÃ¡y chá»§ luÃ´n Ä‘Æ°á»£c báº£o vá»‡.
	- NgÄƒn cháº·n hÃ nh vi truy cáº­p trÃ¡i phÃ©p báº±ng cÃ¡ch báº£o máº­t thÃ´ng tin Ä‘Äƒng nháº­p nhÆ° máº­t kháº©u.
	- Cung cáº¥p thÃ´ng tin chi tiáº¿t vá» chá»©ng chá»‰ bao gá»“m: thá»i gian hiá»‡u lá»±c, tÃªn chá»§ thá»ƒ, tá»• chá»©c phÃ¡t hÃ nh chá»©ng chá»‰, vÃ  Ä‘á»‹nh dáº¡ng mÃ£ hÃ³a.
- Kiá»ƒm tra tÃ­nh há»£p lá»‡ cá»§a chá»©ng chá»‰ SSL 
	- BÆ°á»›c 1: Truy cáº­p má»™t cÃ´ng cá»¥ SSL Checker trá»±c tuyáº¿n, vÃ­ dá»¥: [SSL Shopper](https://www.sslshopper.com/ssl-checker.html)
	- ![images](./images/s-15.png)
	- BÆ°á»›c 2: Nháº­p URL cá»§a website hoáº·c mÃ¡y chá»§ cáº§n kiá»ƒm tra vÃ  nháº¥n nÃºt "Check SSL".
	- BÆ°á»›c 3: Äá»c káº¿t quáº£ tráº£ vá», táº­p trung vÃ o cÃ¡c thÃ´ng tin chÃ­nh sau:
		- ![images](./images/s-16.png)
		- Thá»i háº¡n hiá»‡u lá»±c: Hiá»ƒn thá»‹ thá»i gian cÃ²n láº¡i trÆ°á»›c khi chá»©ng chá»‰ háº¿t háº¡n. Chá»©ng chá»‰ Ä‘Ã£ háº¿t háº¡n hoáº·c sáº¯p háº¿t háº¡n Ä‘Æ°á»£c xem lÃ  khÃ´ng há»£p lá»‡.
		- Thuáº­t toÃ¡n mÃ£ hÃ³a: Cho biáº¿t má»©c Ä‘á»™ mÃ£ hÃ³a SSL/TLS Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ báº£o vá»‡ dá»¯ liá»‡u truyá»n táº£i.
		- ThÃ´ng tin chá»©ng chá»‰: Bao gá»“m tÃªn chá»§ thá»ƒ, nhÃ  cung cáº¥p chá»©ng chá»‰, thá»i Ä‘iá»ƒm phÃ¡t hÃ nh vÃ  háº¿t háº¡n.
		- Chuá»—i chá»©ng chá»‰: XÃ¡c minh Ä‘áº§y Ä‘á»§ chá»©ng chá»‰ trung gian nháº±m báº£o Ä‘áº£m trÃ¬nh duyá»‡t khÃ´ng Ä‘Æ°a ra cáº£nh bÃ¡o báº£o máº­t.
- Kiá»ƒm tra thá»i háº¡n cá»§a chá»©ng chá»‰ SSL: Thá»i háº¡n thÆ°á»ng Ä‘Æ°á»£c hiá»ƒn thá»‹ theo Ä‘á»‹nh dáº¡ng ngÃ y/thÃ¡ng/nÄƒm. CÃ³ thá»ƒ dá»… dÃ ng xÃ¡c Ä‘á»‹nh ngÃ y háº¿t háº¡n vÃ  chuáº©n bá»‹ gia háº¡n ká»‹p thá»i nháº±m duy trÃ¬ káº¿t ná»‘i báº£o máº­t cho website hoáº·c dá»‹ch vá»¥.

### 7.4 ÄÃ¡nh giÃ¡ báº£o máº­t (SSL Rating)
- SSL Rating lÃ  há»‡ thá»‘ng Ä‘Ã¡nh giÃ¡ má»©c Ä‘á»™ an toÃ n cá»§a cáº¥u hÃ¬nh SSL/TLS trÃªn mÃ¡y chá»§ web. Má»¥c tiÃªu cá»§a viá»‡c Ä‘Ã¡nh giÃ¡ nÃ y lÃ  xÃ¡c Ä‘á»‹nh xem má»™t mÃ¡y chá»§ cÃ³ Ä‘ang sá»­ dá»¥ng cÃ¡c tiÃªu chuáº©n mÃ£ hÃ³a hiá»‡n Ä‘áº¡i, cáº¥u hÃ¬nh Ä‘Ãºng cÃ¡ch vÃ  cÃ³ kháº£ nÄƒng báº£o vá»‡ ngÆ°á»i dÃ¹ng khá»i cÃ¡c lá»— há»•ng báº£o máº­t hay khÃ´ng.
- SSL Rating thÆ°á»ng Ä‘Æ°á»£c thá»ƒ hiá»‡n dÆ°á»›i dáº¡ng Ä‘iá»ƒm sá»‘ (0â€“100) vÃ  xáº¿p háº¡ng chá»¯ cÃ¡i (A+, A, B, C, D, F). Má»™t sá»‘ ná»n táº£ng nhÆ° SSL Labs cá»§a Qualys hoáº·c CyberSSL cung cáº¥p cÃ´ng cá»¥ kiá»ƒm tra vÃ  cháº¥m Ä‘iá»ƒm SSL cÃ´ng khai cho cÃ¡c mÃ¡y chá»§ trÃªn Internet.
- CÃ¡c yáº¿u tá»‘ áº£nh hÆ°á»Ÿng Ä‘áº¿n SSL Rating
	- Chá»©ng chá»‰ há»£p lá»‡: ÄÆ°á»£c cáº¥p bá»Ÿi CA Ä‘Ã¡ng tin cáº­y, khÃ´ng háº¿t háº¡n, khÃ´ng bá»‹ thu há»“i.
	- Chuá»—i chá»©ng chá»‰ Ä‘áº§y Ä‘á»§: Bao gá»“m chá»©ng chá»‰ trung gian vÃ  root CA.
	- Thuáº­t toÃ¡n mÃ£ hÃ³a: Æ¯u tiÃªn sá»­ dá»¥ng RSA 2048-bit trá»Ÿ lÃªn, hoáº·c ECC vá»›i Ä‘á»™ máº¡nh tÆ°Æ¡ng Ä‘Æ°Æ¡ng.
	- Há»— trá»£ giao thá»©c hiá»‡n Ä‘áº¡i: TLS 1.2 vÃ  TLS 1.3 Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ cao; viá»‡c há»— trá»£ SSL 2.0/3.0 hoáº·c TLS 1.0/1.1 sáº½ lÃ m giáº£m Ä‘iá»ƒm.
	- Cáº¥u hÃ¬nh báº£o máº­t: CÃ³ báº­t HSTS, OCSP Stapling, khÃ´ng há»— trá»£ cipher yáº¿u nhÆ° RC4, 3DES.
	- Kháº£ nÄƒng chá»‘ng lá»— há»•ng: KhÃ´ng bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi cÃ¡c lá»—i nhÆ° Heartbleed, POODLE, BEAST.
- Thang Ä‘iá»ƒm SSL Rating 
	- A+: Cáº¥u hÃ¬nh tá»‘i Æ°u, báº£o máº­t cao, khÃ´ng cÃ³ lá»—i nghiÃªm trá»ng.
	- A: Cáº¥u hÃ¬nh tá»‘t, cÃ³ thá»ƒ thiáº¿u má»™t sá»‘ tÃ­nh nÄƒng nÃ¢ng cao nhÆ° HSTS.
	- Bâ€“C: Cáº¥u hÃ¬nh cháº¥p nháº­n Ä‘Æ°á»£c nhÆ°ng cáº§n cáº£i thiá»‡n (vÃ­ dá»¥: há»— trá»£ giao thá»©c cÅ©).
	- Dâ€“F: Cáº¥u hÃ¬nh yáº¿u, cÃ³ lá»—i nghiÃªm trá»ng hoáº·c chá»©ng chá»‰ khÃ´ng há»£p lá»‡.
- CÃ´ng cá»¥ kiá»ƒm tra SSL Rating phá»• biáº¿n
	- [SSL Labs Server Test](https://www.ssllabs.com/ssltest/)  
	- [CyberSSL Checker](https://www.cyberssl.com/tools/sslchecker)  
	- [DigiCert SSL Tools](https://www.digicert.com/help/)
- VÃ­ dá»¥ sá»­ dá»¥ng CyberSSL 
	- Truy cáº­p trang kiá»ƒm tra SSL cá»§a CyberSSL táº¡i [Ä‘Ã¢y](https://www.cyberssl.com/tools/sslchecker)
	- ![images](./images/s-17.png)
	- Nháº­p tÃªn miá»n cáº§n kiá»ƒm tra vÃ o Ã´ tÃ¬m kiáº¿m.
	- Nháº¥n Check SSL Ä‘á»ƒ báº¯t Ä‘áº§u phÃ¢n tÃ­ch.
	- ![images](./images/s-18.png)
	- Káº¿t quáº£ sáº½ hiá»ƒn thá»‹:
	- ![images](./images/s-19.png)
	- ![images](./images/s-20.png)
	- ![images](./images/s-21.png)

## 8. Lá»—i thÆ°á»ng gáº·p
### 8.1 Mixed content
- Vá»›i TLS (cÃ²n gá»i lÃ  SSL), cÃ¡c káº¿t ná»‘i Internet Ä‘Æ°á»£c mÃ£ hÃ³a, tá»« Ä‘Ã³ táº¡o ra tráº£i nghiá»‡m duyá»‡t web an toÃ n hÆ¡n. NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ dá»… dÃ ng nháº­n biáº¿t cÃ¡c trang web Ä‘Æ°á»£c mÃ£ hÃ³a TLS thÃ´ng qua tiá»n tá»‘ https:// trong URL thay vÃ¬ http://.
- ![images](./images/s-22.png)
- Tuy nhiÃªn, trong má»™t sá»‘ trÆ°á»ng há»£p, trang web HTTPS váº«n cÃ³ thá»ƒ táº£i má»™t sá»‘ thÃ nh pháº§n (nhÆ° hÃ¬nh áº£nh, script hoáº·c CSS) thÃ´ng qua giao thá»©c HTTP khÃ´ng mÃ£ hÃ³a. TÃ¬nh huá»‘ng nÃ y Ä‘Æ°á»£c gá»i lÃ  `ná»™i dung há»—n há»£p` (mixed content), hay cÃ²n Ä‘Æ°á»£c biáº¿t Ä‘áº¿n vá»›i tÃªn gá»i â€œHTTP trÃªn HTTPSâ€.
- Khi xáº£y ra ná»™i dung há»—n há»£p (mixed content), ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ hiá»ƒu nháº§m ráº±ng há» Ä‘ang truy cáº­p má»™t káº¿t ná»‘i an toÃ n vÃ  Ä‘Æ°á»£c mÃ£ hÃ³a vÃ¬ Ä‘á»‹a chá»‰ trang web sá»­ dá»¥ng HTTPS. Tuy nhiÃªn, viá»‡c trang váº«n táº£i má»™t sá»‘ thÃ nh pháº§n khÃ´ng Ä‘Æ°á»£c mÃ£ hÃ³a sáº½ táº¡o ra lá»— há»•ng báº£o máº­t, khiáº¿n ngÆ°á»i dÃ¹ng cÃ³ nguy cÆ¡ bá»‹ theo dÃµi trÃ¡i phÃ©p hoáº·c bá»‹ táº¥n cÃ´ng trung gian (on-path attacks).
- Má»©c Ä‘á»™ nghiÃªm trá»ng cá»§a lá»— há»•ng phá»¥ thuá»™c vÃ o loáº¡i ná»™i dung há»—n há»£p: ná»™i dung thá»¥ Ä‘á»™ng (passive) nhÆ° hÃ¬nh áº£nh, hoáº·c ná»™i dung chá»§ Ä‘á»™ng (active) nhÆ° script vÃ  iframe, vá»›i ná»™i dung chá»§ Ä‘á»™ng gÃ¢y rá»§i ro cao hÆ¡n.
	- Ná»™i dung há»—n há»£p thá»¥ Ä‘á»™ng (Passive/Display Mixed Content): LÃ  cÃ¡c ná»™i dung Ä‘Æ°á»£c táº£i qua giao thá»©c HTTP nhÆ°ng khÃ´ng cÃ³ kháº£ nÄƒng tÆ°Æ¡ng tÃ¡c hoáº·c thay Ä‘á»•i pháº§n cÃ²n láº¡i cá»§a trang web â€” vÃ­ dá»¥ nhÆ° hÃ¬nh áº£nh, video hoáº·c Ã¢m thanh. Máº·c dÃ¹ káº» táº¥n cÃ´ng cÃ³ thá»ƒ cháº·n hoáº·c thay tháº¿ ná»™i dung nÃ y, há» khÃ´ng thá»ƒ can thiá»‡p vÃ o toÃ n bá»™ ná»™i dung trang.
	- Ná»™i dung há»—n há»£p chá»§ Ä‘á»™ng (Active Mixed Content): LÃ  cÃ¡c thÃ nh pháº§n Ä‘Æ°á»£c táº£i qua HTTP cÃ³ kháº£ nÄƒng tÆ°Æ¡ng tÃ¡c, kiá»ƒm soÃ¡t hoáº·c sá»­a Ä‘á»•i trang web â€” nhÆ° tá»‡p JavaScript hoáº·c cÃ¡c yÃªu cáº§u API. ÄÃ¢y lÃ  loáº¡i ná»™i dung nguy hiá»ƒm hÆ¡n vÃ¬ cÃ³ thá»ƒ bá»‹ khai thÃ¡c Ä‘á»ƒ chiáº¿m quyá»n Ä‘iá»u khiá»ƒn trang, thu tháº­p dá»¯ liá»‡u nháº¡y cáº£m (máº­t kháº©u, thÃ´ng tin Ä‘Äƒng nháº­p), hoáº·c chuyá»ƒn hÆ°á»›ng ngÆ°á»i dÃ¹ng Ä‘áº¿n trang giáº£ máº¡o.
- Má»©c Ä‘á»™ Ä‘e dá»a:
	- Ná»™i dung há»—n há»£p chá»§ Ä‘á»™ng Ä‘Æ°á»£c xem lÃ  rá»§i ro báº£o máº­t nghiÃªm trá»ng hÆ¡n nhiá»u so vá»›i ná»™i dung thá»¥ Ä‘á»™ng.
	- CÃ¡c trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i thÆ°á»ng tá»± Ä‘á»™ng cháº·n ná»™i dung há»—n há»£p chá»§ Ä‘á»™ng, trong khi má»™t sá»‘ loáº¡i ná»™i dung thá»¥ Ä‘á»™ng váº«n Ä‘Æ°á»£c phÃ©p táº£i (kÃ¨m cáº£nh bÃ¡o trong báº£ng Ä‘iá»u khiá»ƒn dÃ nh cho nhÃ  phÃ¡t triá»ƒn).
- TÃ¡c Ä‘á»™ng cá»§a ná»™i dung há»—n há»£p thá»¥ Ä‘á»™ng:
	- Máº·c dÃ¹ Ã­t nguy hiá»ƒm hÆ¡n, ná»™i dung thá»¥ Ä‘á»™ng váº«n cÃ³ thá»ƒ bá»‹ khai thÃ¡c Ä‘á»ƒ theo dÃµi hÃ nh vi ngÆ°á»i dÃ¹ng hoáº·c lÃ m rÃ² rá»‰ thÃ´ng tin cÃ¡ nhÃ¢n.
	- Do cÃ¡c trÃ¬nh duyá»‡t chá»‰ cáº£nh bÃ¡o trong cÃ´ng cá»¥ dÃ nh cho nhÃ  phÃ¡t triá»ƒn, Ä‘a sá»‘ ngÆ°á»i dÃ¹ng khÃ´ng biáº¿t ráº±ng há» Ä‘ang tiáº¿p xÃºc vá»›i ná»™i dung há»—n há»£p.
- Lá»—i `MixedContent` cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­a báº±ng viá»‡c cáº¥u hÃ¬nh báº¯t buá»™c má»i káº¿t ná»‘i Ä‘á» sá»­ dá»¥ng HTTPS
	- Báº¯t buá»™c toÃ n bá»™ káº¿t ná»‘i chuyá»ƒn sang HTTPS
	- Cáº¥u hÃ¬nh bá»• sung HSTS 

### 8.2 ERR_CERT_COMMON_NAME_INVALID
- ERR_CERT_COMMON_NAME_INVALID lÃ  lá»—i SSL phá»• biáº¿n xáº£y ra khi truy cáº­p má»™t website.
- ![images](./images/errcomnam.webp)
- Trong pháº§n lá»›n trÆ°á»ng há»£p, lá»—i nÃ y xuáº¥t phÃ¡t tá»« cáº¥u hÃ¬nh chá»©ng chá»‰ khÃ´ng chÃ­nh xÃ¡c trÃªn mÃ¡y chá»§, cá»¥ thá»ƒ lÃ  tÃªn miá»n (Common Name hoáº·c SAN) trong chá»©ng chá»‰ khÃ´ng khá»›p vá»›i tÃªn miá»n truy cáº­p thá»±c táº¿. NgoÃ i ra, lá»—i nÃ y cÅ©ng cÃ³ thá»ƒ do pháº§n má»m diá»‡t virus, tÆ°á»ng lá»­a, hoáº·c tiá»‡n Ã­ch má»Ÿ rá»™ng bÃªn thá»© ba can thiá»‡p vÃ o káº¿t ná»‘i HTTPS, gÃ¢y giÃ¡n Ä‘oáº¡n quÃ¡ trÃ¬nh xÃ¡c minh chá»©ng chá»‰.
	- CÃ i Ä‘áº·t SSL khÃ´ng chÃ­nh xÃ¡c
		- Viá»‡c cÃ i Ä‘áº·t chá»©ng chá»‰ SSL sai cÃ¡ch trÃªn mÃ¡y chá»§. Viá»‡c quÃ©t nhanh báº±ng cÃ´ng cá»¥ kiá»ƒm tra SSL cÃ³ thá»ƒ giÃºp xÃ¡c Ä‘á»‹nh chÃ­nh xÃ¡c nguyÃªn nhÃ¢n vÃ  sá»­a chá»¯a ká»‹p thá»i.
		- Má»™t sá»‘ nguyÃªn nhÃ¢n phá»• biáº¿n gÃ¢y ra lá»—i nÃ y bao gá»“m:
			- Sai tÃªn miá»n trong chá»©ng chá»‰ (certificate name mismatch): TÃªn miá»n Ä‘Æ°á»£c cáº¥p trong chá»©ng chá»‰ SSL pháº£i khá»›p vá»›i URL mÃ  ngÆ°á»i dÃ¹ng truy cáº­p. Náº¿u khÃ´ng, trÃ¬nh duyá»‡t sáº½ cho ráº±ng chá»©ng chá»‰ Ä‘Æ°á»£c cáº¥p cho má»™t website khÃ¡c vÃ  cháº·n káº¿t ná»‘i.
			- KhÃ´ng há»— trá»£ cáº£ cÃ³ vÃ  khÃ´ng cÃ³ â€˜wwwâ€™: Khi mua chá»©ng chá»‰ SSL, cáº§n Ä‘áº£m báº£o chá»©ng chá»‰ há»— trá»£ cáº£ hai phiÃªn báº£n tÃªn miá»n: domain.com vÃ  www.domain.com. Náº¿u chá»‰ cáº¥p cho má»™t trong hai, ngÆ°á»i dÃ¹ng truy cáº­p phiÃªn báº£n cÃ²n láº¡i sáº½ gáº·p lá»—i trÃªn.
			- Chá»©ng chá»‰ tá»± kÃ½ (self-signed certificate): CÃ¡c trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i chá»‰ tin cáº­y chá»©ng chá»‰ do Tá»• chá»©c chá»©ng thá»±c (CA) há»£p lá»‡ cáº¥p phÃ¡t. Náº¿u sá»­ dá»¥ng chá»©ng chá»‰ tá»± kÃ½, khÃ´ng chá»‰ gÃ¢y lá»—i káº¿t ná»‘i mÃ  cÃ²n áº£nh hÆ°á»Ÿng Ä‘áº¿n káº¿t quáº£ SEO.
	- Thiáº¿u chá»©ng chá»‰ SSL
		- ÄÃ´i khi lá»—i xáº£y ra do chÆ°a cÃ i Ä‘áº·t chá»©ng chá»‰ nÃ o. VÃ­ dá»¥, má»™t sá»‘ ngÆ°á»i dÃ¹ng WordPress má»›i cÃ³ thá»ƒ báº­t giao thá»©c HTTPS trong báº£ng Ä‘iá»u khiá»ƒn nhÆ°ng quÃªn chÆ°a cÃ i chá»©ng chá»‰ thá»±c táº¿ trÃªn mÃ¡y chá»§.
		- Khuyáº¿n nghá»‹:
			- Chá»‰ cáº¥u hÃ¬nh HTTPS trong CMS sau khi Ä‘Ã£ cÃ i Ä‘áº·t chá»©ng chá»‰ há»£p lá»‡.
			- Náº¿u chÆ°a cÃ³ chá»©ng chá»‰, táº¡m thá»i chuyá»ƒn vá» HTTP cho Ä‘áº¿n khi há»‡ thá»‘ng Ä‘Æ°á»£c báº£o máº­t Ä‘áº§y Ä‘á»§.
- Lá»—i ERR_CERT_COMMON_NAME_INVALID Ä‘Æ°á»£c kháº¯c phá»¥c báº±ng cÃ¡ch:
	- Kiá»ƒm tra tÃªn miá»n trong chá»©ng chá»‰: Ä‘áº£m báº£o Common Name vÃ  SAN khá»›p vá»›i tÃªn miá»n thá»±c táº¿ (example.com vÃ  www.example.com náº¿u cáº§n).
	- Táº¡o láº¡i CSR náº¿u cáº§n: sá»­ dá»¥ng OpenSSL Ä‘á»ƒ táº¡o yÃªu cáº§u má»›i vá»›i SAN chÃ­nh xÃ¡c.
	- Cáº¥u hÃ¬nh Ä‘Ãºng mÃ¡y chá»§ web: Apache hoáº·c Nginx pháº£i trá» Ä‘áº¿n chá»©ng chá»‰ Ä‘Ãºng vÃ  khai bÃ¡o Ä‘Ãºng ServerName, server_name.
	- Kiá»ƒm tra redirect: trÃ¡nh chuyá»ƒn hÆ°á»›ng sai giá»¯a www vÃ  non-www.
	- DÃ¹ng cÃ´ng cá»¥ kiá»ƒm tra: nhÆ° SSL Labs hoáº·c openssl s_client Ä‘á»ƒ xÃ¡c minh sau khi sá»­a.

### 8.3 SSL handshake failure
- SSL handshake lÃ  quÃ¡ trÃ¬nh mÃ  trong Ä‘Ã³ client vÃ  server thiáº¿t láº­p cÃ¡c thuáº­t toÃ¡n mÃ£ hÃ³a vÃ  khÃ³a bÃ­ máº­t Ä‘á»ƒ giao tiáº¿p an toÃ n, Ä‘á»“ng thá»i trao Ä‘á»•i vÃ  xÃ¡c minh chá»©ng chá»‰ sá»‘ cá»§a nhau.
- ThÃ´ng bÃ¡o lá»—i "SSL Handshake Failed" xuáº¥t hiá»‡n khi client hoáº·c server khÃ´ng thá»ƒ thiáº¿t láº­p káº¿t ná»‘i báº£o máº­t.
- ![images](./images/sslhs.jpg)
- Lá»—i nÃ y cÃ³ thá»ƒ xáº£y ra trong cÃ¡c trÆ°á»ng há»£p sau:
	- Client Ä‘ang sá»­ dá»¥ng sai ngÃ y hoáº·c giá» há»‡ thá»‘ng
	- TrÃ¬nh duyá»‡t (client) cÃ³ cáº¥u hÃ¬nh gÃ¢y xung Ä‘á»™t trong quÃ¡ trÃ¬nh xÃ¡c thá»±c SSL
	- Káº¿t ná»‘i bá»‹ can thiá»‡p bá»Ÿi bÃªn thá»© ba trÃªn phÃ­a client (vÃ­ dá»¥: tÆ°á»ng lá»­a, proxy, pháº§n má»m diá»‡t virus)
	- Client vÃ  server khÃ´ng há»— trá»£ cÃ¹ng má»™t phiÃªn báº£n SSL/TLS
	- Client vÃ  server sá»­ dá»¥ng cÃ¡c bá»™ mÃ£ hÃ³a (Cipher Suites) khÃ¡c nhau, khÃ´ng tÆ°Æ¡ng thÃ­ch
	- Chá»©ng chá»‰ sá»‘ cá»§a client hoáº·c server khÃ´ng há»£p lá»‡ (háº¿t háº¡n, tá»± kÃ½, bá»‹ thu há»“i,...)
- CÃ¡c cÃ¡ch xá»­ lÃ½ lá»—i: 
	- Kiá»ƒm tra láº¡i chá»©ng chá»‰ SSL: Äáº£m báº£o há»£p lá»‡, cÃ²n háº¡n.
	- Kiá»ƒm tra cáº¥u hÃ¬nh giao thá»©c, cipher 
		- Äáº£m báº£o mÃ¡y chá»§ há»— trá»£ TLS 1.2 hoáº·c 1.3.
		- Loáº¡i bá» cÃ¡c giao thá»©c cÅ© nhÆ° SSLv3, TLS 1.0/1.1.
		- Kiá»ƒm tra vÃ  cáº¥u hÃ¬nh láº¡i cipher suites tÆ°Æ¡ng thÃ­ch vá»›i client.
	- Kiá»ƒm tra tÆ°á»ng lá»­a, antivirus cÃ³ cháº·n, can thiá»‡p vÃ o quÃ¡ trÃ¬nh Handshake 
	- Kiá»ƒm tra client
		- Äáº£m báº£o thá»i gian Ä‘Ãºng.
		- TrÃ¬nh duyá»‡t má»›i nháº¥t há»— trá»£ giao thá»©c, cipher 

### 8.4 Expired certificate
- TÆ°Æ¡ng tá»± nhÆ° cÃ¡c giáº¥y tá» tÃ¹y thÃ¢n do chÃ­nh phá»§ cáº¥p (nhÆ° há»™ chiáº¿u) cÃ³ thá»i háº¡n sá»­ dá»¥ng vÃ  cáº§n gia háº¡n Ä‘á»‹nh ká»³, chá»©ng chá»‰ SSL cÅ©ng cáº§n Ä‘Æ°á»£c gia háº¡n thÆ°á»ng xuyÃªn. Viá»‡c nÃ y giÃºp xÃ¡c minh ráº±ng dá»‹ch vá»¥ web váº«n do Ä‘Ãºng tá»• chá»©c sá»Ÿ há»¯u, giá»‘ng nhÆ° viá»‡c cáº­p nháº­t áº£nh há»™ chiáº¿u Ä‘á»ƒ xÃ¡c thá»±c danh tÃ­nh. Náº¿u chá»©ng chá»‰ SSL Ä‘Ã£ háº¿t háº¡n, trÃ¬nh duyá»‡t cá»§a ngÆ°á»i dÃ¹ng sáº½ khÃ´ng tin cáº­y káº¿t ná»‘i, quÃ¡ trÃ¬nh TLS handshake sáº½ tháº¥t báº¡i vÃ  káº¿t ná»‘i báº£o máº­t khÃ´ng thá»ƒ Ä‘Æ°á»£c thiáº¿t láº­p.
- CÃ¡ch kháº¯c phá»¥c: Quáº£n trá»‹ viÃªn há»‡ thá»‘ng cáº§n Ä‘áº£m báº£o táº¥t cáº£ chá»©ng chá»‰ SSL cho tÃªn miá»n vÃ  cÃ¡c subdomain Ä‘á»u Ä‘Æ°á»£c cáº­p nháº­t Ä‘Ãºng háº¡n.
- LÆ°u Ã½: Lá»—i nÃ y cÅ©ng cÃ³ thá»ƒ phÃ¡t sinh tá»« phÃ­a thiáº¿t bá»‹ ngÆ°á»i dÃ¹ng náº¿u Ä‘á»“ng há»“ há»‡ thá»‘ng hiá»ƒn thá»‹ sai ngÃ y/giá» â€” khiáº¿n trÃ¬nh duyá»‡t khÃ´ng thá»ƒ xÃ¡c Ä‘á»‹nh chÃ­nh xÃ¡c thá»i háº¡n cá»§a chá»©ng chá»‰. Trong trÆ°á»ng há»£p nÃ y, chá»‰ cáº§n chá»‰nh láº¡i thá»i gian Ä‘Ãºng trÃªn thiáº¿t bá»‹ client lÃ  sáº½ kháº¯c phá»¥c Ä‘Æ°á»£c lá»—i.
- ![images](./images/ssl-error-7-20241024-9764531.webp)
### 8.5 NET::ERR_CERT_AUTHORITY_INVALID ( Lá»—i do thiáº¿u intermediate CA cert)
- `NET::ERR_CERT_AUTHORITY_INVALID` lá»—i liÃªn quan Ä‘áº¿n báº£o máº­t, Ä‘Æ°á»£c trÃ¬nh duyá»‡t hiá»ƒn thá»‹ khi khÃ´ng thá»ƒ xÃ¡c minh chá»©ng chá»‰ SSL cá»§a má»™t website.
- Lá»—i nÃ y cho tháº¥y chá»©ng chá»‰ SSL cÃ³ thá»ƒ Ä‘Ã£ Ä‘Æ°á»£c cáº¥p bá»Ÿi má»™t Tá»• chá»©c chá»©ng thá»±c (CA) khÃ´ng Ä‘Ã¡ng tin cáº­y, hoáº·c trÃ¬nh duyá»‡t khÃ´ng nháº­n diá»‡n Ä‘Æ°á»£c CA Ä‘Ã³. Náº¿u ngÆ°á»i dÃ¹ng váº«n tiáº¿p tá»¥c truy cáº­p, cÃ³ nguy cÆ¡ bá»‹ rÃ² rá»‰ dá»¯ liá»‡u hoáº·c gáº·p cÃ¡c rá»§i ro báº£o máº­t nhÆ° táº¥n cÃ´ng trung gian (MITM).
- Lá»—i NET::ERR_CERT_AUTHORITY_INVALID thÆ°á»ng xáº£y ra khi trÃ¬nh duyá»‡t khÃ´ng thá»ƒ xÃ¡c thá»±c Ä‘á»™ tin cáº­y cá»§a chá»©ng chá»‰ SSL do thiáº¿u chá»©ng chá»‰ trung gian trong chuá»—i xÃ¡c thá»±c. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ nguyÃªn nhÃ¢n liÃªn quan:
	- Chuá»—i chá»©ng chá»‰ khÃ´ng Ä‘áº§y Ä‘á»§: MÃ¡y chá»§ chá»‰ cung cáº¥p chá»©ng chá»‰ chÃ­nh (leaf certificate) mÃ  khÃ´ng kÃ¨m theo cÃ¡c chá»©ng chá»‰ trung gian cáº§n thiáº¿t Ä‘á»ƒ liÃªn káº¿t Ä‘áº¿n root CA Ä‘Ã¡ng tin cáº­y. TrÃ¬nh duyá»‡t khÃ´ng thá»ƒ xÃ¢y dá»±ng chuá»—i tin cáº­y vÃ  sáº½ Ä‘Ã¡nh dáº¥u chá»©ng chá»‰ lÃ  khÃ´ng há»£p lá»‡.
	- CA khÃ´ng Ä‘Ã¡ng tin cáº­y hoáº·c khÃ´ng phá»• biáº¿n: Má»™t sá»‘ chá»©ng chá»‰ do CA nhá» hoáº·c CA tá»± táº¡o cáº¥p phÃ¡t cÃ³ thá»ƒ yÃªu cáº§u cÃ i Ä‘áº·t thá»§ cÃ´ng cÃ¡c chá»©ng chá»‰ trung gian, náº¿u khÃ´ng sáº½ dáº«n Ä‘áº¿n lá»—i xÃ¡c thá»±c.
	- Chá»©ng chá»‰ háº¿t háº¡n hoáº·c chÆ°a Ä‘Æ°á»£c cáº­p nháº­t: DÃ¹ cÃ³ intermediate CA, náº¿u chá»©ng chá»‰ trung gian Ä‘Ã£ háº¿t háº¡n hoáº·c khÃ´ng tÆ°Æ¡ng thÃ­ch, váº«n cÃ³ thá»ƒ dáº«n Ä‘áº¿n lá»—i nÃ y.
	- LÆ°u cache SSL cÅ© trong trÃ¬nh duyá»‡t: TrÃ¬nh duyá»‡t cÃ³ thá»ƒ lÆ°u trá»¯ chá»©ng chá»‰ tá»« láº§n truy cáº­p trÆ°á»›c, dáº«n Ä‘áº¿n xung Ä‘á»™t náº¿u chuá»—i chá»©ng chá»‰ Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t trÃªn mÃ¡y chá»§ nhÆ°ng cache váº«n dÃ¹ng phiÃªn báº£n cÅ©.
	- Pháº§n má»m báº£o máº­t hoáº·c VPN can thiá»‡p: Má»™t sá»‘ pháº§n má»m diá»‡t virus hoáº·c VPN cÃ³ thá»ƒ "báº» gÃ£y" chuá»—i chá»©ng chá»‰, thay tháº¿ báº±ng chá»©ng chá»‰ proxy khÃ´ng cÃ³ chuá»—i trung gian Ä‘áº§y Ä‘á»§.
- Lá»—i nÃ y cÃ³ thá»ƒ xá»­ lÃ½ báº±ng cÃ¡ch 
	- Äáº£m báº£o cÃ i Ä‘áº·t Ä‘áº§y Ä‘á»§ chuá»—i chá»©ng chá»‰ (bao gá»“m intermediate CA)
	- Sá»­ dá»¥ng chá»©ng chá»‰ Ä‘Æ°á»£c cáº¥p bá»Ÿi CA uy tÃ­n, khÃ´ng dÃ¹ng self-signed
	- Gia háº¡n chá»©ng chá»‰ trÆ°á»›c khi háº¿t háº¡n
	- Äá»“ng bá»™ thá»i gian há»‡ thá»‘ng báº±ng NTP
	- Kiá»ƒm tra cáº¥u hÃ¬nh mÃ¡y chá»§ SSL (Apache, Nginx, Tomcatâ€¦) Ä‘áº£m báº£o trá» Ä‘Ãºng file fullchain
	- XÃ¡c minh cáº¥u hÃ¬nh ServerName hoáº·c server_name khá»›p vá»›i chá»©ng chá»‰
	- Loáº¡i bá» cÃ¡c chá»©ng chá»‰ cÅ©, xung Ä‘á»™t hoáº·c bá»‹ thu há»“i
	- Kiá»ƒm tra certificate path vÃ  quyá»n truy cáº­p Ä‘áº¿n file chá»©ng chá»‰
	- DÃ¹ng cÃ´ng cá»¥ kiá»ƒm tra nhÆ° openssl s_client, SSL Labs Ä‘á»ƒ xÃ¡c thá»±c chuá»—i tin cáº­y
	- Cáº­p nháº­t CA certificates trÃªn há»‡ thá»‘ng (update-ca-certificates trÃªn Linux)

## 9. Giao thá»©c & chuáº©n liÃªn quan
### 9.1 HTTPS (SSL over HTTP) 
- Giao thá»©c truyá»n siÃªu vÄƒn báº£n báº£o máº­t (HTTPS) lÃ  phiÃªn báº£n an toÃ n cá»§a HTTP â€” giao thá»©c chÃ­nh dÃ¹ng Ä‘á»ƒ truyá»n dá»¯ liá»‡u giá»¯a trÃ¬nh duyá»‡t web vÃ  website.
- HTTPS sá»­ dá»¥ng mÃ£ hÃ³a Ä‘á»ƒ tÄƒng cÆ°á»ng báº£o máº­t trong quÃ¡ trÃ¬nh truyá»n dá»¯ liá»‡u. Äiá»u nÃ y Ä‘áº·c biá»‡t quan trá»ng khi ngÆ°á»i dÃ¹ng gá»­i thÃ´ng tin nháº¡y cáº£m, cháº³ng háº¡n nhÆ° Ä‘Äƒng nháº­p vÃ o tÃ i khoáº£n ngÃ¢n hÃ ng, dá»‹ch vá»¥ email hoáº·c trang chÄƒm sÃ³c sá»©c khá»e.
- Báº¥t ká»³ website nÃ o â€” Ä‘áº·c biá»‡t lÃ  nhá»¯ng trang yÃªu cáº§u thÃ´ng tin Ä‘Äƒng nháº­p â€” Ä‘á»u nÃªn sá»­ dá»¥ng HTTPS. TrÃªn cÃ¡c trÃ¬nh duyá»‡t web hiá»‡n Ä‘áº¡i nhÆ° Chrome, cÃ¡c website khÃ´ng dÃ¹ng HTTPS sáº½ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u khÃ¡c biá»‡t, thÆ°á»ng kÃ¨m cáº£nh bÃ¡o, nháº±m báº£o vá»‡ ngÆ°á»i dÃ¹ng khá»i nhá»¯ng rá»§i ro tiá»m áº©n.
- Giao thá»©c HTTPS sá»­ dá»¥ng giao thá»©c mÃ£ hÃ³a TLS (Transport Layer Security) â€” trÆ°á»›c Ä‘Ã¢y Ä‘Æ°á»£c gá»i lÃ  SSL (Secure Sockets Layer) â€” Ä‘á»ƒ báº£o vá»‡ quÃ¡ trÃ¬nh trao Ä‘á»•i dá»¯ liá»‡u. TLS hoáº¡t Ä‘á»™ng dá»±a trÃªn cÆ¡ cháº¿ mÃ£ hÃ³a báº¥t Ä‘á»‘i xá»©ng trong há»‡ thá»‘ng háº¡ táº§ng khÃ³a cÃ´ng khai (PKI), sá»­ dá»¥ng hai loáº¡i khÃ³a khÃ¡c nhau:
	- KhÃ³a riÃªng (private key): Chá»‰ do mÃ¡y chá»§ náº¯m giá»¯, Ä‘Æ°á»£c giá»¯ bÃ­ máº­t tuyá»‡t Ä‘á»‘i. NÃ³ dÃ¹ng Ä‘á»ƒ giáº£i mÃ£ dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c mÃ£ hÃ³a báº±ng khÃ³a cÃ´ng khai.
	- KhÃ³a cÃ´ng khai (public key): Ai cÅ©ng cÃ³ thá»ƒ truy cáº­p. Khi client gá»­i dá»¯ liá»‡u Ä‘Æ°á»£c mÃ£ hÃ³a báº±ng khÃ³a nÃ y, chá»‰ mÃ¡y chá»§ vá»›i khÃ³a riÃªng tÆ°Æ¡ng á»©ng má»›i cÃ³ thá»ƒ giáº£i mÃ£.
- HTTPS Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u khÃ´ng bá»‹ truyá»n khÃ´ng mÃ£ hoÃ¡ trÃªn máº¡ng nhÆ° HTTP. Giao thá»©c HTTP thÃ´ng thÆ°á»ng chia dá»¯ liá»‡u thÃ nh cÃ¡c gÃ³i khÃ´ng mÃ£ hÃ³a, dá»… bá»‹ cháº·n, Ä‘á»c trá»™m (sniff) báº±ng pháº§n má»m miá»…n phÃ­ â€” Ä‘áº·c biá»‡t lÃ  trÃªn Wi-Fi cÃ´ng cá»™ng. Äiá»u nÃ y khiáº¿n thÃ´ng tin ráº¥t dá»… bá»‹ nghe lÃ©n vÃ  táº¥n cÃ´ng trung gian (on-path attack).
- NgÆ°á»£c láº¡i, HTTPS mÃ£ hÃ³a dá»¯ liá»‡u Ä‘áº¿n má»©c náº¿u bá»‹ cháº·n, káº» táº¥n cÃ´ng cÅ©ng chá»‰ tháº¥y chuá»—i kÃ½ tá»± vÃ´ nghÄ©a. 
- HTTPS sá»­ dá»¥ng cá»•ng (port) `443`, khÃ¡c vá»›i HTTP lÃ  port `80`.

### 9.2 SMTPS, IMAPS, POP3S (á»©ng dá»¥ng SSL trong email)
#### SMTPS
- SMTPS (viáº¿t táº¯t cá»§a Simple Mail Transfer Protocol Secure) lÃ  phÆ°Æ¡ng phÃ¡p báº£o máº­t giao thá»©c gá»­i email tiÃªu chuáº©n SMTP. SMTPS sá»­ dá»¥ng TLS (Transport Layer Security) hoáº·c SSL (Secure Sockets Layer) Ä‘á»ƒ mÃ£ hÃ³a quÃ¡ trÃ¬nh trao Ä‘á»•i dá»¯ liá»‡u giá»¯a mÃ¡y chá»§ vÃ  á»©ng dá»¥ng email, nháº±m Ä‘áº£m báº£o tÃ­nh báº£o máº­t vÃ  toÃ n váº¹n cá»§a ná»™i dung email.
- SMTPS thiáº¿t láº­p má»™t káº¿t ná»‘i báº£o máº­t vÃ  mÃ£ hÃ³a giá»¯a á»©ng dá»¥ng gá»­i thÆ° (email client) vÃ  mÃ¡y chá»§ SMTP, giÃºp ngÄƒn cháº·n truy cáº­p trÃ¡i phÃ©p hoáº·c sá»­a Ä‘á»•i ná»™i dung email.
- Cá»•ng káº¿t ná»‘i
	- Port 465: DÃ¹ng cho SMTPS vá»›i mÃ£ hÃ³a ngáº§m Ä‘á»‹nh (implicit TLS), káº¿t ná»‘i Ä‘Æ°á»£c mÃ£ hÃ³a ngay tá»« Ä‘áº§u.
	- Port 587: DÃ¹ng cho SMTP káº¿t há»£p mÃ£ hÃ³a STARTTLS, mÃ£ hÃ³a Ä‘Æ°á»£c kÃ­ch hoáº¡t sau khi káº¿t ná»‘i.
- Vá» máº·t lá»‹ch sá»­, "smtps" tá»«ng Ä‘Æ°á»£c IANA Ä‘Äƒng kÃ½ vá»›i cá»•ng TCP 465 Ä‘á»ƒ dÃ nh cho cÃ¡c Mail Transfer Agent (MTA) truyá»n email á»Ÿ dáº¡ng mÃ£ hÃ³a. Tuy nhiÃªn, viá»‡c Ä‘Äƒng kÃ½ nÃ y bá»‹ thu há»“i do chuyá»ƒn hÆ°á»›ng chuáº©n hÃ³a sang phÆ°Æ¡ng phÃ¡p khÃ¡c, sá»­ dá»¥ng STARTTLS trÃªn cá»•ng 587. Sau Ä‘Ã³, RFC 8314 Ä‘Ã£ khÃ´i phá»¥c láº¡i vai trÃ² cho cá»•ng 465 nhÆ° má»™t cá»•ng chÃ­nh thá»©c Ä‘á»ƒ gá»­i email an toÃ n theo chuáº©n "submissions" sá»­ dá»¥ng TLS ngáº§m Ä‘á»‹nh (implicit TLS).
- Cá»•ng 465 hiá»‡n Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ gá»­i email qua SMTPS vá»›i mÃ£ hÃ³a khá»Ÿi táº¡o ngay tá»« Ä‘áº§u káº¿t ná»‘i. ÄÃ¢y lÃ  phÆ°Æ¡ng phÃ¡p truyá»n thá»‘ng, trong Ä‘Ã³ toÃ n bá»™ phiÃªn gá»­i email Ä‘Æ°á»£c báº£o vá»‡ bá»Ÿi TLS tá»« khi báº¯t Ä‘áº§u káº¿t ná»‘i TCP.
- Cá»•ng 587 lÃ  cá»•ng tiÃªu chuáº©n hiá»‡n Ä‘áº¡i Ä‘á»ƒ gá»­i email (submission) báº±ng giao thá»©c SMTP cÃ³ há»— trá»£ mÃ£ hÃ³a. TrÃªn cá»•ng nÃ y, káº¿t ná»‘i ban Ä‘áº§u Ä‘Æ°á»£c thiáº¿t láº­p á»Ÿ dáº¡ng khÃ´ng mÃ£ hÃ³a, sau Ä‘Ã³ Ä‘Æ°á»£c nÃ¢ng cáº¥p lÃªn TLS thÃ´ng qua cÆ¡ cháº¿ STARTTLS. CÃ¡ch tiáº¿p cáº­n nÃ y linh hoáº¡t hÆ¡n vÃ  Ä‘Æ°á»£c Æ°a chuá»™ng trong cÃ¡c há»‡ thá»‘ng hiá»‡n Ä‘áº¡i.
- Viá»‡c sá»­ dá»¥ng Ä‘Ãºng cá»•ng phá»¥ thuá»™c vÃ o cÆ¡ cháº¿ mÃ£ hÃ³a mong muá»‘n vÃ  pháº§n má»m mÃ¡y chá»§ email. Cáº£ hai cá»•ng 465 vÃ  587 Ä‘á»u Ä‘ang Ä‘Æ°á»£c há»— trá»£, tuy nhiÃªn port 587 káº¿t há»£p STARTTLS Ä‘Æ°á»£c khuyáº¿n nghá»‹ cho má»¥c Ä‘Ã­ch gá»­i thÆ° xÃ¡c thá»±c trong háº¡ táº§ng hiá»‡n Ä‘áº¡i, trong khi port 465 váº«n phá»• biáº¿n do há»— trá»£ tá»‘t bá»Ÿi nhiá»u client cÅ© vÃ  ISP. Cáº¥u hÃ¬nh mÃ¡y chá»§ cáº§n Ä‘áº£m báº£o Ä‘Ãºng giao thá»©c, chá»©ng chá»‰ há»£p lá»‡ vÃ  quy Ä‘á»‹nh chÃ­nh sÃ¡ch mÃ£ hÃ³a phÃ¹ há»£p vá»›i tá»«ng cá»•ng.

#### IMAPS
- ÄÃ¢y lÃ  giao thá»©c truy cáº­p thÆ° Internet (Internet Message Access Protocol) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ truy xuáº¥t email thÃ´ng qua káº¿t ná»‘i báº£o máº­t báº±ng giao thá»©c SSL (Secure Sockets Layer) hoáº·c TLS (Transport Layer Security).
- IMAPS (IMAP qua SSL):
	- IMAPS, cÃ²n Ä‘Æ°á»£c gá»i lÃ  IMAP over SSL, lÃ  phÆ°Æ¡ng thá»©c trong Ä‘Ã³ lÆ°u lÆ°á»£ng IMAP Ä‘Æ°á»£c truyá»n qua má»™t káº¿t ná»‘i báº£o máº­t (secure socket) tá»›i má»™t cá»•ng báº£o máº­t, thÃ´ng thÆ°á»ng lÃ  TCP port 993.
	- Giáº£ sá»­ mÃ¡y chá»§ Ä‘Ã£ Ä‘Æ°á»£c cÃ i Ä‘áº·t chá»©ng chá»‰ SSL há»£p lá»‡, thÃ¬ khÃ´ng cáº§n cáº¥u hÃ¬nh bá»• sung nÃ o khÃ¡c Ä‘á»ƒ kÃ­ch hoáº¡t IMAPS. TrÃªn phÃ­a client, chá»‰ cáº§n cáº¥u hÃ¬nh á»©ng dá»¥ng email trá» Ä‘áº¿n mÃ¡y chá»§ IMAP thÃ´ng qua cá»•ng 993 lÃ  Ä‘á»§.
	- LÆ°u Ã½: Náº¿u cá»‘ gáº¯ng káº¿t ná»‘i Ä‘áº¿n port 993 báº±ng má»™t client khÃ´ng há»— trá»£ SSL (vÃ­ dá»¥: Telnet), káº¿t ná»‘i sáº½ bá»‹ tá»« chá»‘i.
- IMAP qua STARTTLS (cÃ²n gá»i lÃ  IMAP over TLS):
	- Trong phÆ°Æ¡ng thá»©c nÃ y, lÆ°u lÆ°á»£ng IMAP ban Ä‘áº§u khÃ´ng Ä‘Æ°á»£c mÃ£ hÃ³a khi truyá»n qua máº¡ng.
	- KÃªnh truyá»n khÃ´ng mÃ£ hÃ³a Ä‘Ã³ sau Ä‘Ã³ sáº½ Ä‘Æ°á»£c nÃ¢ng cáº¥p thÃ nh káº¿t ná»‘i mÃ£ hÃ³a náº¿u cáº£ client vÃ  server cÃ¹ng há»— trá»£ lá»‡nh STARTTLS, vÃ  thá»±c hiá»‡n thÃ nh cÃ´ng báº¯t tay báº£o máº­t (STARTTLS handshake).
	- Äá»ƒ sá»­ dá»¥ng phÆ°Æ¡ng thá»©c nÃ y, ngÆ°á»i dÃ¹ng cáº§n cáº¥u hÃ¬nh á»©ng dá»¥ng email chá»n tÃ¹y chá»n TLS hoáº·c STARTTLS trong pháº§n thiáº¿t láº­p káº¿t ná»‘i. Khi Ä‘Ã³ client sáº½ káº¿t ná»‘i qua cá»•ng máº·c Ä‘á»‹nh TCP port 143 cho IMAP. Vá»›i cÃ¡c mÃ¡y chá»§ nhÆ° Kerio Connect cÃ³ há»— trá»£ STARTTLS, káº¿t ná»‘i sáº½ Ä‘Æ°á»£c mÃ£ hÃ³a sau quÃ¡ trÃ¬nh khá»Ÿi táº¡o, Ä‘áº£m báº£o an toÃ n.
- Lá»£i Ã­ch cá»§a IMAPS:
	- Báº£o máº­t (Confidentiality): MÃ£ hÃ³a ná»™i dung email, giÃºp thÃ´ng tin nháº¡y cáº£m khÃ´ng bá»‹ truy cáº­p trÃ¡i phÃ©p.
	- ToÃ n váº¹n dá»¯ liá»‡u (Integrity): Äáº£m báº£o ná»™i dung thÆ° khÃ´ng bá»‹ thay Ä‘á»•i trong quÃ¡ trÃ¬nh truyá»n táº£i.
	- XÃ¡c thá»±c (Authentication): XÃ¡c minh danh tÃ­nh cá»§a mÃ¡y chá»§ email, ngÄƒn cháº·n cÃ¡c cuá»™c táº¥n cÃ´ng dáº¡ng giáº£ máº¡o trung gian (man-in-the-middle).
- Cá»•ng máº·c Ä‘á»‹nh cá»§a IMAPS (IMAP over SSL/TLS) lÃ  TCP port 993. ÄÃ¢y lÃ  cá»•ng Ä‘Æ°á»£c sá»­ dá»¥ng khi client muá»‘n káº¿t ná»‘i Ä‘áº¿n mÃ¡y chá»§ IMAP thÃ´ng qua má»™t káº¿t ná»‘i Ä‘Æ°á»£c mÃ£ hÃ³a toÃ n pháº§n ngay tá»« Ä‘áº§u (implicit TLS). Trong khi Ä‘Ã³, náº¿u sá»­ dá»¥ng IMAP vá»›i STARTTLS, káº¿t ná»‘i sáº½ báº¯t Ä‘áº§u khÃ´ng mÃ£ hÃ³a trÃªn port 143, sau Ä‘Ã³ Ä‘Æ°á»£c nÃ¢ng cáº¥p lÃªn TLS náº¿u cáº£ hai bÃªn há»— trá»£.
	- IMAPS (SSL/TLS ngáº§m Ä‘á»‹nh) â†’ Port 993
	- IMAP + STARTTLS (TLS nÃ¢ng cáº¥p) â†’ Port 143

#### POP3S
- POP3S (Post Office Protocol version 3 Secure) lÃ  phiÃªn báº£n báº£o máº­t cá»§a giao thá»©c POP3, sá»­ dá»¥ng SSL/TLS Ä‘á»ƒ mÃ£ hÃ³a káº¿t ná»‘i giá»¯a mÃ¡y khÃ¡ch (email client) vÃ  mÃ¡y chá»§ thÆ° Ä‘iá»‡n tá»­. Má»¥c tiÃªu chÃ­nh cá»§a POP3S lÃ  Ä‘áº£m báº£o tÃ­nh báº£o máº­t vÃ  toÃ n váº¹n cá»§a dá»¯ liá»‡u email trong quÃ¡ trÃ¬nh truyá»n táº£i.
- Äáº·c Ä‘iá»ƒm ká»¹ thuáº­t cá»§a POP3S:
	- Cá»•ng sá»­ dá»¥ng: TCP port 995: ÄÃ¢y lÃ  cá»•ng máº·c Ä‘á»‹nh cho POP3S, nÆ¡i káº¿t ná»‘i Ä‘Æ°á»£c mÃ£ hÃ³a ngay tá»« khi báº¯t Ä‘áº§u (implicit TLS).
	- CÆ¡ cháº¿ mÃ£ hÃ³a: POP3S sá»­ dá»¥ng SSL hoáº·c TLS Ä‘á»ƒ thiáº¿t láº­p má»™t kÃªnh truyá»n an toÃ n, giÃºp báº£o vá»‡ thÃ´ng tin Ä‘Äƒng nháº­p vÃ  ná»™i dung email khá»i bá»‹ nghe lÃ©n hoáº·c giáº£ máº¡o.
- So vá»›i POP3 thÃ´ng thÆ°á»ng (port 110): POP3 khÃ´ng mÃ£ hÃ³a dá»¯ liá»‡u theo máº·c Ä‘á»‹nh. Náº¿u muá»‘n báº£o máº­t, cáº§n sá»­ dá»¥ng lá»‡nh STLS Ä‘á»ƒ nÃ¢ng cáº¥p káº¿t ná»‘i â€” nhÆ°ng khÃ´ng pháº£i mÃ¡y chá»§ nÃ o cÅ©ng há»— trá»£. POP3S kháº¯c phá»¥c Ä‘iá»ƒm yáº¿u nÃ y báº±ng cÃ¡ch yÃªu cáº§u mÃ£ hÃ³a ngay tá»« Ä‘áº§u.
- á»¨ng dá»¥ng thá»±c táº¿: Nhiá»u dá»‹ch vá»¥ email nhÆ° Gmail, Outlook, Yahoo Mail há»— trá»£ POP3S Ä‘á»ƒ ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ táº£i email vá» mÃ¡y tÃ­nh cÃ¡ nhÃ¢n má»™t cÃ¡ch an toÃ n thÃ´ng qua cÃ¡c á»©ng dá»¥ng nhÆ° Outlook, Thunderbird,...
- Æ¯u Ä‘iá»ƒm:
	- Báº£o vá»‡ thÃ´ng tin Ä‘Äƒng nháº­p vÃ  ná»™i dung email khá»i bá»‹ Ä‘Ã¡nh cáº¯p.
	- Dá»… triá»ƒn khai trÃªn cáº£ mÃ¡y chá»§ vÃ  mÃ¡y khÃ¡ch.
	- TÆ°Æ¡ng thÃ­ch vá»›i háº§u háº¿t cÃ¡c á»©ng dá»¥ng email hiá»‡n Ä‘áº¡i.

#### Tá»•ng quÃ¡t vá» SSL vá»›i mail 

| Giao thá»©c | Vai trÃ² chÃ­nh               | Cá»•ng máº·c Ä‘á»‹nh | MÃ£ hÃ³a khá»Ÿi Ä‘áº§u | Giao thá»©c ná»n | CÆ¡ cháº¿ báº£o máº­t    | Má»©c Ä‘á»™ phá»• biáº¿n |
| --------- | --------------------------- | ------------- | --------------- | ------------- | ----------------- | --------------- |
| **SMTPS** | Gá»­i email (SMTP báº£o máº­t)    | 465           | TLS ngáº§m Ä‘á»‹nh   | SMTP          | MÃ£ hÃ³a toÃ n phiÃªn | Ráº¥t phá»• biáº¿n    |
| **IMAPS** | Nháº­n email (truy cáº­p tá»« xa) | 993           | TLS ngáº§m Ä‘á»‹nh   | IMAP          | MÃ£ hÃ³a toÃ n phiÃªn | Ráº¥t phá»• biáº¿n    |
| **POP3S** | Táº£i email vá» client         | 995           | TLS ngáº§m Ä‘á»‹nh   | POP3          | MÃ£ hÃ³a toÃ n phiÃªn | Trung bÃ¬nh      |

### 9.3 TLS versions vÃ  security policy (vÃ­ dá»¥ táº¯t TLS 1.0/1.1)
- CÃ¡c phiÃªn báº£n TLS
	- SSL 1.0 (1994): KhÃ´ng Ä‘Æ°á»£c phÃ¡t hÃ nh cÃ´ng khai do lá»—i báº£o máº­t nghiÃªm trá»ng.
	- SSL 2.0 (1995)
		- TÃ­nh nÄƒng: Giá»›i thiá»‡u cÆ¡ cháº¿ mÃ£ hÃ³a cÆ¡ báº£n cho HTTP.
		- Váº¥n Ä‘á»: KhÃ´ng há»— trá»£ xÃ¡c thá»±c thÃ´ng Ä‘iá»‡p, dá»… bá»‹ táº¥n cÃ´ng man-in-the-middle vÃ  khÃ´ng báº£o vá»‡ toÃ n váº¹n dá»¯ liá»‡u.
		- TÃ¬nh tráº¡ng: Bá»‹ loáº¡i bá» hoÃ n toÃ n.
	- SSL 3.0 (1996): 
		- TÃ­nh nÄƒng má»›i:
			- Há»— trá»£ xÃ¡c thá»±c thÃ´ng Ä‘iá»‡p (Message Authentication Code).
			- Cáº£i thiá»‡n quÃ¡ trÃ¬nh báº¯t tay (handshake).
		- Váº¥n Ä‘á»: Sau nÃ y bá»‹ phÃ¡t hiá»‡n lá»— há»•ng nghiÃªm trá»ng (vÃ­ dá»¥: POODLE attack).
		- TÃ¬nh tráº¡ng: Bá»‹ loáº¡i bá», khÃ´ng cÃ²n Ä‘Æ°á»£c há»— trá»£ bá»Ÿi cÃ¡c trÃ¬nh duyá»‡t hiá»‡n Ä‘áº¡i.
	- TLS 1.0 (1999)
		- TÃ­nh nÄƒng má»›i: Chuáº©n hÃ³a bá»Ÿi IETF, káº¿ thá»«a SSL 3.0 vá»›i cáº£i tiáº¿n vá» cáº¥u trÃºc giao thá»©c.
		- Há»— trá»£ cÃ¡c thuáº­t toÃ¡n mÃ£ hÃ³a máº¡nh hÆ¡n.
		- Váº¥n Ä‘á»: Váº«n dá»… bá»‹ táº¥n cÃ´ng nhÆ° BEAST.
		- TÃ¬nh tráº¡ng: Bá»‹ loáº¡i bá» khá»i háº§u háº¿t há»‡ thá»‘ng hiá»‡n Ä‘áº¡i.
	- TLS 1.1 (2006)
		- TÃ­nh nÄƒng má»›i:
			- ThÃªm cÆ¡ cháº¿ khá»Ÿi táº¡o ngáº«u nhiÃªn (explicit IV) cho CBC Ä‘á»ƒ chá»‘ng táº¥n cÃ´ng.
			- Há»— trá»£ báº£o vá»‡ tá»‘t hÆ¡n vá»›i cÃ¡c thuáº­t toÃ¡n mÃ£ hÃ³a khá»‘i.
		- TÃ¬nh tráº¡ng: KhÃ´ng Ä‘Æ°á»£c triá»ƒn khai rá»™ng rÃ£i, hiá»‡n Ä‘Ã£ bá»‹ loáº¡i bá».

	- TLS 1.2 (2008)
		- TÃ­nh nÄƒng má»›i:
			- Cho phÃ©p chá»‰ Ä‘á»‹nh thuáº­t toÃ¡n bÄƒm (hash) vÃ  mÃ£ hÃ³a riÃªng biá»‡t.
			- Há»— trá»£ SHA-256 vÃ  cÃ¡c thuáº­t toÃ¡n hiá»‡n Ä‘áº¡i.
		- Cáº£i thiá»‡n hiá»‡u suáº¥t vÃ  báº£o máº­t tá»•ng thá»ƒ.
		- TÃ¬nh tráº¡ng: Váº«n Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i vÃ  lÃ  tiÃªu chuáº©n tá»‘i thiá»ƒu hiá»‡n nay.
	- TLS 1.3  (2018)
		- ÄÆ°á»£c chuáº©n hÃ³a vÃ o thÃ¡ng 8 nÄƒm 2018 trong RFC 8446, káº¿ thá»«a TLS 1.2 nhÆ°ng cÃ³ nhiá»u thay Ä‘á»•i máº¡nh máº½ nháº±m tÄƒng cÆ°á»ng báº£o máº­t vÃ  tá»‘i Æ°u hiá»‡u suáº¥t truyá»n thÃ´ng máº¡ng. 
		- CÃ¡c thay Ä‘á»•i Ä‘Ã¡ng chÃº Ã½ bao gá»“m:
			- TÃ¡ch biá»‡t thuáº­t toÃ¡n thá»a thuáº­n khÃ³a vÃ  xÃ¡c thá»±c ra khá»i cÃ¡c cipher suite, giÃºp cáº¥u trÃºc giao thá»©c Ä‘Æ¡n giáº£n vÃ  dá»… báº£o trÃ¬ hÆ¡n.
			- Loáº¡i bá» cÃ¡c Ä‘Æ°á»ng cong elliptic yáº¿u vÃ  Ã­t Ä‘Æ°á»£c sá»­ dá»¥ng, Ä‘áº£m báº£o chá»‰ nhá»¯ng thuáº­t toÃ¡n Ä‘Ã¡ng tin cáº­y má»›i Ä‘Æ°á»£c phÃ©p tham gia trao Ä‘á»•i khÃ³a.
			- KhÃ´ng cÃ²n há»— trá»£ cÃ¡c hÃ m bÄƒm khÃ´ng an toÃ n nhÆ° MD5 vÃ  SHA-224.
			- Báº¯t buá»™c sá»­ dá»¥ng chá»¯ kÃ½ sá»‘, ngay cáº£ khi dÃ¹ng láº¡i cáº¥u hÃ¬nh tá»« phiÃªn cÅ©, nháº±m nÃ¢ng cao má»©c Ä‘á»™ xÃ¡c thá»±c.
			- TÃ­ch há»£p cÆ¡ cháº¿ sinh khÃ³a HKDF vÃ  Ä‘á» xuáº¥t Diffie-Hellman bÃ¡n táº¡m thá»i (semi-ephemeral DH) Ä‘á»ƒ tÄƒng tÃ­nh linh hoáº¡t vÃ  báº£o máº­t trong quÃ¡ trÃ¬nh sinh khÃ³a.
			- Thay Ä‘á»•i cÆ¡ cháº¿ resume phiÃªn: bá» session ID truyá»n thá»‘ng, thay báº±ng PSK (Pre-Shared Key) vÃ  session ticket an toÃ n hÆ¡n.
			- Há»— trá»£ báº¯t tay 1-RTT (rÃºt gá»n quy trÃ¬nh báº¯t tay xuá»‘ng má»™t láº§n trao Ä‘á»•i), Ä‘á»“ng thá»i giá»›i thiá»‡u há»— trá»£ 0-RTT cho phÃ©p khÃ´i phá»¥c phiÃªn vá»›i Ä‘á»™ trá»… gáº§n nhÆ° báº±ng khÃ´ng.
			- Báº¯t buá»™c há»— trá»£ forward secrecy: chá»‰ cho phÃ©p cÃ¡c phÆ°Æ¡ng thá»©c trao Ä‘á»•i khÃ³a táº¡m thá»i nhÆ° (EC)DHE Ä‘á»ƒ Ä‘áº£m báº£o dá»¯ liá»‡u quÃ¡ khá»© khÃ´ng bá»‹ lá»™ khi khÃ³a lÃ¢u dÃ i bá»‹ rÃ² rá»‰.
			- Loáº¡i bá» hÃ ng loáº¡t tÃ­nh nÄƒng khÃ´ng an toÃ n hoáº·c lá»—i thá»i, bao gá»“m:
				- Renegotiation
				- Compression
				- Cipher khÃ´ng AEAD (Authenticated Encryption with Associated Data)
				- Null cipher
				- Static RSA / static Diffie-Hellman key exchange
				- Custom DHE group
				- EC point format negotiation
				- Change Cipher Spec protocol
				- TrÆ°á»ng UNIX time trong ClientHello
				- TrÆ°á»ng Ä‘á»™ dÃ i (length field) trong pháº§n dá»¯ liá»‡u bá»• sung cá»§a AEAD
			- Cáº¥m hoÃ n toÃ n viá»‡c Ä‘Ã m phÃ¡n ngÆ°á»£c vá» SSL hoáº·c RC4, tÄƒng cÆ°á»ng kiá»ƒm soÃ¡t tÆ°Æ¡ng thÃ­ch.
			- TÃ­ch há»£p session hash Ä‘á»ƒ tÄƒng tÃ­nh toÃ n váº¹n vÃ  chá»‘ng láº¡i táº¥n cÃ´ng ghi láº¡i (replay attack).
			- ÄÃ³ng bÄƒng giÃ¡ trá»‹ version trong record layer, trÃ¡nh gÃ¢y lá»—i tÆ°Æ¡ng thÃ­ch vá»›i cÃ¡c thiáº¿t bá»‹ trung gian khÃ´ng tuÃ¢n chuáº©n (protocol ossification).
			- ThÃªm cÃ¡c thuáº­t toÃ¡n hiá»‡n Ä‘áº¡i:
			- Cipher: ChaCha20 stream cipher vá»›i Poly1305 MAC
			- Chá»¯ kÃ½ sá»‘: Ed25519, Ed448
			- Trao Ä‘á»•i khÃ³a: x25519, x448
			- Há»— trá»£ gá»­i nhiá»u pháº£n há»“i OCSP, phá»¥c vá»¥ viá»‡c xÃ¡c thá»±c chá»©ng chá»‰ theo thá»i gian thá»±c.
			- MÃ£ hÃ³a toÃ n bá»™ pháº§n handshake sau ServerHello, bao gá»“m chá»©ng chá»‰ mÃ¡y chá»§ â†’ chá»‘ng phÃ¢n tÃ­ch lÆ°u lÆ°á»£ng vÃ  giáº£ máº¡o dá»¯ liá»‡u trong giai Ä‘oáº¡n handshake.
- ChÃ­nh sÃ¡ch TLS (Transport Layer Security) 
	- LÃ  táº­p há»£p cÃ¡c cáº¥u hÃ¬nh Ä‘Æ°á»£c thiáº¿t láº­p nháº±m tÄƒng cÆ°á»ng báº£o máº­t cho dá»¯ liá»‡u truyá»n qua Internet. ChÃºng quy Ä‘á»‹nh rÃµ phiÃªn báº£n TLS vÃ  bá»™ mÃ£ hÃ³a (cipher suite) nÃ o Ä‘Æ°á»£c phÃ©p sá»­ dá»¥ng trong quÃ¡ trÃ¬nh truyá»n thÃ´ng an toÃ n.
	- CÃ¡c chÃ­nh sÃ¡ch nÃ y Ä‘áº£m báº£o tÃ­nh riÃªng tÆ°, toÃ n váº¹n vÃ  xÃ¡c thá»±c cá»§a dá»¯ liá»‡u thÃ´ng qua cÃ¡c cÆ¡ cháº¿ mÃ£ hÃ³a vÃ  xÃ¡c thá»±c. Náº¿u Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘Ãºng, TLS policy Ä‘Ã³ng vai trÃ² then chá»‘t trong viá»‡c báº£o vá»‡ thÃ´ng tin nháº¡y cáº£m trong cÃ¡c giao dá»‹ch vÃ  liÃªn láº¡c trá»±c tuyáº¿n.
	- CÃ¡c phÆ°Æ¡ng diá»‡n áº£nh hÆ°á»Ÿng cá»§a chÃ­nh sÃ¡ch 
		- PhiÃªn báº£n TLS
			- TLS 1.3 vÃ  1.2: Khuyáº¿n nghá»‹ sá»­ dá»¥ng vÃ¬ cung cáº¥p báº£o máº­t máº¡nh máº½ hÆ¡n. TLS 1.3 cÃ²n cáº£i thiá»‡n tá»‘c Ä‘á»™ báº¯t tay vÃ  loáº¡i bá» cÃ¡c thuáº­t toÃ¡n yáº¿u.
			- TLS 1.0 / 1.1: ÄÃ£ lá»—i thá»i, tá»“n táº¡i nhiá»u lá»— há»•ng; nÃªn bá»‹ vÃ´ hiá»‡u hÃ³a.
			- TÆ°Æ¡ng thÃ­ch há»‡ thá»‘ng cÅ©: Má»™t sá»‘ há»‡ thá»‘ng cÅ© váº«n cáº§n TLS 1.0/1.1 â†’ cáº§n cÃ¢n nháº¯c ká»¹ trÆ°á»›c khi táº¯t hoÃ n toÃ n.
		- Cipher Suite
			- Äá»‹nh nghÄ©a: Cipher suite lÃ  táº­p há»£p cÃ¡c thuáº­t toÃ¡n mÃ£ hÃ³a, trao Ä‘á»•i khÃ³a, xÃ¡c thá»±c,... dÃ¹ng trong káº¿t ná»‘i TLS.
			- Chá»n lá»±a: TLS policy sáº½ quy Ä‘á»‹nh rÃµ cipher nÃ o Ä‘Æ°á»£c phÃ©p. Pháº£i Ä‘áº£m báº£o cÃ¡c cipher Ä‘Æ°á»£c chá»n lÃ  máº¡nh vÃ  tÆ°Æ¡ng thÃ­ch vá»›i phiÃªn báº£n TLS Ä‘ang dÃ¹ng.
			- Khuyáº¿n nghá»‹: Æ¯u tiÃªn cipher há»— trá»£ forward secrecy (vÃ­ dá»¥: ECDHE), giÃºp báº£o vá»‡ dá»¯ liá»‡u cÅ© ká»ƒ cáº£ khi khÃ³a bá»‹ rÃ² rá»‰.
	- Lá»£i Ã­ch báº£o máº­t
		- TÃ­nh bÃ­ máº­t: TLS mÃ£ hÃ³a dá»¯ liá»‡u â†’ ngÄƒn nghe lÃ©n, truy cáº­p trÃ¡i phÃ©p.
		- XÃ¡c thá»±c: TLS Ä‘áº£m báº£o xÃ¡c minh danh tÃ­nh cÃ¡c bÃªn giao tiáº¿p â†’ chá»‘ng giáº£ máº¡o.
		- ToÃ n váº¹n: TLS Ä‘áº£m báº£o dá»¯ liá»‡u khÃ´ng bá»‹ thay Ä‘á»•i trong quÃ¡ trÃ¬nh truyá»n.
	- Triá»ƒn khai
		- ChÃ­nh sÃ¡ch máº·c Ä‘á»‹nh: Nhiá»u há»‡ Ä‘iá»u hÃ nh vÃ  dá»‹ch vá»¥ cung cáº¥p TLS policy sáºµn, cÃ³ thá»ƒ Ã¡p dá»¥ng ngay.
		- TÃ¹y chá»‰nh: CÃ³ thá»ƒ cáº¥u hÃ¬nh chÃ­nh sÃ¡ch TLS riÃªng tÃ¹y theo yÃªu cáº§u cá»¥ thá»ƒ.
		- GiÃ¡m sÃ¡t & cáº­p nháº­t: Pháº£i thÆ°á»ng xuyÃªn kiá»ƒm tra viá»‡c sá»­ dá»¥ng TLS, cáº­p nháº­t pháº§n má»m Ä‘á»ƒ giáº£m thiá»ƒu rá»§i ro vÃ  vÃ¡ lá»—i báº£o máº­t.
	- Táº§m quan trá»ng
		- TuÃ¢n thá»§ chuáº©n: TLS policy lÃ  báº¯t buá»™c trong nhiá»u tiÃªu chuáº©n báº£o máº­t nhÆ° PCI DSS, HIPAA,...
		- Báº£o vá»‡ há»‡ thá»‘ng: Giáº£m thiá»ƒu rá»§i ro táº¥n cÃ´ng man-in-the-middle, rÃ² rá»‰ dá»¯ liá»‡u,...
		- Táº¡o niá»m tin ngÆ°á»i dÃ¹ng: Sá»­ dá»¥ng TLS cho tháº¥y cam káº¿t báº£o máº­t, tÄƒng Ä‘á»™ tin cáº­y vá»›i ngÆ°á»i dÃ¹ng.

## 10. Xu hÆ°á»›ng trong tÆ°Æ¡ng lai
- Trong bá»‘i cáº£nh sá»‘ hÃ³a hiá»‡n nay, báº£o máº­t Ä‘Ã£ trá»Ÿ thÃ nh Æ°u tiÃªn hÃ ng Ä‘áº§u Ä‘á»‘i vá»›i cáº£ doanh nghiá»‡p vÃ  cÃ¡ nhÃ¢n. Khi cÃ´ng nghá»‡ ngÃ y cÃ ng phÃ¡t triá»ƒn, cÃ¡c phÆ°Æ¡ng thá»©c mÃ  tá»™i pháº¡m máº¡ng sá»­ dá»¥ng Ä‘á»ƒ khai thÃ¡c lá»— há»•ng trong há»‡ thá»‘ng trá»±c tuyáº¿n cÅ©ng ngÃ y cÃ ng tinh vi. Transport Layer Security (TLS) lÃ  má»™t giao thá»©c cá»‘t lÃµi giÃºp Ä‘áº£m báº£o liÃªn láº¡c an toÃ n trÃªn Internet.
### 10.1 PhÃ¡t triá»ƒn cá»§a TLS 1.3 vÃ  cÃ¡c cáº£i tiáº¿n báº£o máº­t. 
- TLS 1.3 lÃ  phiÃªn báº£n má»›i nháº¥t cá»§a giao thá»©c TLS, Ä‘Æ°á»£c phÃ¡t hÃ nh nÄƒm 2018. PhiÃªn báº£n nÃ y cáº£i tiáº¿n Ä‘Ã¡ng ká»ƒ so vá»›i TLS 1.2 vá»›i trá»ng tÃ¢m lÃ  báº£o máº­t vÃ  hiá»‡u nÄƒng. Má»™t Ä‘iá»ƒm ná»•i báº­t lÃ  viá»‡c loáº¡i bá» hoÃ n toÃ n cÃ¡c thuáº­t toÃ¡n mÃ£ hÃ³a lá»—i thá»i, giÃºp chá»‰ sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p mÃ£ hÃ³a máº¡nh cho truyá»n thÃ´ng an toÃ n.
- TLS 1.3 cÅ©ng giáº£m Ä‘á»™ trá»… báº±ng cÃ¡ch rÃºt ngáº¯n quÃ¡ trÃ¬nh báº¯t tay giá»¯a client vÃ  server, tá»« Ä‘Ã³ khÃ´ng chá»‰ nÃ¢ng cao hiá»‡u suáº¥t mÃ  cÃ²n giáº£m cÆ¡ há»™i khai thÃ¡c trong giai Ä‘oáº¡n nháº¡y cáº£m nÃ y.
- Vá»›i ká»³ vá»ng Ä‘Æ°á»£c Ã¡p dá»¥ng rá»™ng rÃ£i trong thá»i gian tá»›i, TLS 1.3 sáº½ Ä‘Ã³ng vai trÃ² quan trá»ng trong viá»‡c báº£o vá»‡ giao dá»‹ch trá»±c tuyáº¿n, truyá»n dá»¯ liá»‡u nháº¡y cáº£m vÃ  tÄƒng cÆ°á»ng an ninh máº¡ng tá»•ng thá»ƒ.
- Äiá»‡n toÃ¡n lÆ°á»£ng tá»­: ThÃ¡ch thá»©c má»›i Ä‘á»‘i vá»›i TLS
	- DÃ¹ TLS hiá»‡n táº¡i váº«n ráº¥t hiá»‡u quáº£ trong viá»‡c ngÄƒn cháº·n cÃ¡c má»‘i Ä‘e dá»a, sá»± xuáº¥t hiá»‡n cá»§a cÃ´ng nghá»‡ má»›i nhÆ° Ä‘iá»‡n toÃ¡n lÆ°á»£ng tá»­ láº¡i Ä‘áº·t ra thÃ¡ch thá»©c lá»›n cho kháº£ nÄƒng tá»“n táº¡i cá»§a nÃ³ trong tÆ°Æ¡ng lai.
	- MÃ¡y tÃ­nh lÆ°á»£ng tá»­ sá»­ dá»¥ng cÃ¡c bit lÆ°á»£ng tá»­ (qubit) Ä‘á»ƒ thá»±c hiá»‡n phÃ©p tÃ­nh phá»©c táº¡p vá»›i tá»‘c Ä‘á»™ vÆ°á»£t xa mÃ¡y tÃ­nh hiá»‡n nay, khiáº¿n chÃºng cÃ³ tiá»m nÄƒng phÃ¡ vá»¡ cÃ¡c thuáº­t toÃ¡n mÃ£ hÃ³a truyá»n thá»‘ng Ä‘ang Ä‘Æ°á»£c TLS sá»­ dá»¥ng.
	- Äá»ƒ Ä‘á»‘i phÃ³ vá»›i má»‘i Ä‘e dá»a nÃ y, cÃ¡c nhÃ  nghiÃªn cá»©u Ä‘ang phÃ¡t triá»ƒn cÃ¡c thuáº­t toÃ¡n mÃ£ hÃ³a háº­u lÆ°á»£ng tá»­ (post-quantum cryptography â€“ PQC) cÃ³ kháº£ nÄƒng chá»‘ng láº¡i táº¥n cÃ´ng tá»« mÃ¡y tÃ­nh lÆ°á»£ng tá»­ nhÆ°ng váº«n tÆ°Æ¡ng thÃ­ch vá»›i cÃ¡c giao thá»©c hiá»‡n cÃ³ nhÆ° TLS. Nhá»¯ng thuáº­t toÃ¡n nÃ y sáº½ Ä‘Ã³ng vai trÃ² quan trá»ng trong viá»‡c duy trÃ¬ tÃ­nh an toÃ n cá»§a TLS trong ká»· nguyÃªn háº­u lÆ°á»£ng tá»­.
- CÃ¡c cáº£i tiáº¿n báº£o máº­t trong tÆ°Æ¡ng lai vá»›i TLS 1.3 
	- Má»Ÿ rá»™ng triá»ƒn khai TLS 1.3: TLS 1.3 lÃ  phiÃªn báº£n má»›i nháº¥t vá»›i nhiá»u cáº£i tiáº¿n vá» báº£o máº­t vÃ  tá»‘c Ä‘á»™, Ä‘Æ¡n giáº£n hÃ³a quÃ¡ trÃ¬nh báº¯t tay vÃ  loáº¡i bá» cÃ¡c thuáº­t toÃ¡n mÃ£ hÃ³a lá»—i thá»i. Dá»± kiáº¿n trong nhá»¯ng nÄƒm tá»›i sáº½ cÃ³ nhiá»u website vÃ  á»©ng dá»¥ng chuyá»ƒn sang sá»­ dá»¥ng TLS 1.3.
	- MÃ£ hÃ³a háº­u lÆ°á»£ng tá»­ (Post-Quantum Cryptography â€“ PQC): Khi mÃ¡y tÃ­nh lÆ°á»£ng tá»­ trá»Ÿ nÃªn máº¡nh hÆ¡n, chÃºng cÃ³ kháº£ nÄƒng phÃ¡ vá»¡ cÃ¡c cÆ¡ cháº¿ mÃ£ hÃ³a hiá»‡n táº¡i. TLS Ä‘ang Ä‘Æ°á»£c phÃ¡t triá»ƒn Ä‘á»ƒ tÃ­ch há»£p cÃ¡c thuáº­t toÃ¡n PQC nháº±m báº£o Ä‘áº£m an toÃ n trong tÆ°Æ¡ng lai.
	- TLS nháº¹ cho IoT: Sá»± phÃ¡t triá»ƒn máº¡nh máº½ cá»§a Internet váº¡n váº­t (IoT) Ä‘Ã²i há»i cÃ¡c giao thá»©c truyá»n thÃ´ng báº£o máº­t cÃ³ thá»ƒ cháº¡y trÃªn thiáº¿t bá»‹ giá»›i háº¡n tÃ i nguyÃªn. Do Ä‘Ã³, cÃ¡c biáº¿n thá»ƒ nháº¹ nhÆ° DTLS (Datagram TLS) Ä‘ang Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ Ä‘Ã¡p á»©ng nhu cáº§u nÃ y.
### 10.2 TÃ­ch há»£p SSL vá»›i cÃ¡c cÃ´ng nghá»‡ má»›i (HTTP/3, QUIC). 
- HTTP/3 lÃ  phiÃªn báº£n lá»›n thá»© ba cá»§a giao thá»©c HTTP Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ truyá»n dá»¯ liá»‡u trÃªn web. KhÃ¡c vá»›i cÃ¡c phiÃªn báº£n trÆ°á»›c, HTTP/3 sá»­ dá»¥ng QUIC (Quick UDP Internet Connections) lÃ m táº§ng truyá»n táº£i thay vÃ¬ TCP (Transmission Control Protocol). Sá»± thay Ä‘á»•i nÃ y mang láº¡i nhiá»u lá»£i Ã­ch:
	- Káº¿t ná»‘i nhanh hÆ¡n: QUIC thiáº¿t láº­p káº¿t ná»‘i nhanh hÆ¡n TCP, giÃºp giáº£m Ä‘á»™ trá»….
	- Hiá»‡u suáº¥t cáº£i thiá»‡n: HTTP/3 rÃºt ngáº¯n thá»i gian táº£i trang web, Ä‘áº·c biá»‡t hiá»‡u quáº£ trÃªn cÃ¡c máº¡ng cháº­m hoáº·c khÃ´ng á»•n Ä‘á»‹nh.
	- Báº£o máº­t nÃ¢ng cao: QUIC tÃ­ch há»£p mÃ£ hÃ³a báº±ng TLS 1.3 ngay tá»« Ä‘áº§u, Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘Æ°á»£c truyá»n an toÃ n giá»¯a mÃ¡y khÃ¡ch vÃ  mÃ¡y chá»§.
- TÃ­ch há»£p SSL vá»›i HTTP/3
	- HTTP/3 chá»‰ sá»­ dá»¥ng TLS 1.3 
		- HTTP/3 chá»‰ há»— trá»£ TLS 1.3, khÃ´ng cÃ²n há»— trá»£ cÃ¡c phiÃªn báº£n cÅ© nhÆ° TLS 1.2.
		- TLS khÃ´ng hoáº¡t Ä‘á»™ng nhÆ° má»™t lá»›p riÃªng biá»‡t trÃªn TCP nhÆ° trÆ°á»›c, mÃ  Ä‘Æ°á»£c tÃ­ch há»£p trá»±c tiáº¿p vÃ o QUIC, tá»©c lÃ  mÃ£ hÃ³a diá»…n ra ngay trong táº§ng truyá»n táº£i.
	- QUIC thay tháº¿ TCP vÃ  tÃ­ch há»£p TLS
		- QUIC lÃ  giao thá»©c truyá»n táº£i má»›i dá»±a trÃªn UDP, Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ giáº£m Ä‘á»™ trá»… vÃ  cáº£i thiá»‡n hiá»‡u suáº¥t.
		- Trong QUIC, quÃ¡ trÃ¬nh báº¯t tay TLS 1.3 Ä‘Æ°á»£c thá»±c hiá»‡n ngay trong quÃ¡ trÃ¬nh thiáº¿t láº­p káº¿t ná»‘i, giÃºp rÃºt ngáº¯n thá»i gian báº¯t Ä‘áº§u truyá»n dá»¯ liá»‡u.
		- KhÃ´ng cÃ²n phÃ¢n biá»‡t rÃµ rÃ ng giá»¯a táº§ng báº£o máº­t (TLS) vÃ  táº§ng truyá»n táº£i nhÆ° trong HTTP/2 + TLS/TCP.
	- Lá»£i Ã­ch cá»§a tÃ­ch há»£p TLS trong HTTP/3
		- TÄƒng tá»‘c Ä‘á»™ káº¿t ná»‘i: Nhá» handshake 1-RTT cá»§a TLS 1.3 vÃ  cÆ¡ cháº¿ 0-RTT cá»§a QUIC.
		- Báº£o máº­t máº·c Ä‘á»‹nh: Má»i káº¿t ná»‘i HTTP/3 Ä‘á»u Ä‘Æ°á»£c mÃ£ hÃ³a, khÃ´ng cÃ³ phiÃªn báº£n "khÃ´ng báº£o máº­t".
		- Giáº£m nguy cÆ¡ bá»‹ táº¥n cÃ´ng: TLS 1.3 loáº¡i bá» nhiá»u thuáº­t toÃ¡n yáº¿u, Ä‘á»“ng thá»i mÃ£ hÃ³a cáº£ pháº§n handshake giÃºp chá»‘ng phÃ¢n tÃ­ch lÆ°u lÆ°á»£ng.
- Cáº¥u hÃ¬nh vá»›i cÃ¡c web server sá»­ dá»¥ng HTTP/3 sau Ä‘Ã³ import chá»©ng chá»‰ vÃ o tÆ°Æ¡ng tá»± HTTP/1 HTTP/2 
	- Nginx 
		- HTTP/3 support in Nginx is still considered experimental and requires QUIC support.
		- Nginx 1.25.0+ (1.26.0+ recommended)
		- Cáº§n module `ngx_http_v3_module`
	- Cáº¥u hÃ¬nh máº«u 
	```
	http {
		include       mime.types;
		default_type  application/octet-stream;

		server {
			listen 443 ssl http2;
			listen [::]:443 ssl http2;
			listen 443 http3 reuseport;
			listen [::]:443 http3 reuseport;
			ssl_certificate /path/to/yourdomain.crt;
			ssl_certificate_key /path/to/yourdomain.key;
			ssl_protocols TLSv1.2 TLSv1.3;
			ssl_prefer_server_ciphers off;

			# HTTP/3 specific configuration
			http3_max_concurrent_streams 1000;
			http3_max_header_list_size 4096;
			http3_idle_timeout 60s;
		}
	}

	```

### 10.3 Tá»± Ä‘á»™ng hÃ³a chá»©ng chá»‰ SSL
- Tá»± Ä‘á»™ng hÃ³a chá»©ng chá»‰ SSL lÃ  quÃ¡ trÃ¬nh sá»­ dá»¥ng cÃ´ng cá»¥ vÃ  giao thá»©c Ä‘á»ƒ tá»± Ä‘á»™ng cáº¥p phÃ¡t, cÃ i Ä‘áº·t, gia háº¡n vÃ  thu há»“i chá»©ng chá»‰ sá»‘ mÃ  khÃ´ng cáº§n can thiá»‡p thá»§ cÃ´ng. ÄÃ¢y lÃ  giáº£i phÃ¡p thiáº¿t yáº¿u trong mÃ´i trÆ°á»ng hiá»‡n Ä‘áº¡i, nÆ¡i sá»‘ lÆ°á»£ng mÃ¡y chá»§, dá»‹ch vá»¥ vÃ  tÃªn miá»n ngÃ y cÃ ng tÄƒng, trong khi thá»i háº¡n chá»©ng chá»‰ ngÃ y cÃ ng ngáº¯n.
- Viá»‡c tá»± Ä‘á»™ng hoÃ¡ chá»©ng chá»‰ SSL giÃºp:
	- NgÄƒn ngá»«a háº¿t háº¡n chá»©ng chá»‰: Tá»± Ä‘á»™ng gia háº¡n giÃºp trÃ¡nh lá»—i káº¿t ná»‘i HTTPS do chá»©ng chá»‰ háº¿t háº¡n.
	- Tiáº¿t kiá»‡m thá»i gian vÃ  cÃ´ng sá»©c: KhÃ´ng cáº§n thao tÃ¡c thá»§ cÃ´ng trÃªn tá»«ng mÃ¡y chá»§.
	- TÄƒng cÆ°á»ng báº£o máº­t: Giáº£m rá»§i ro do lá»—i con ngÆ°á»i vÃ  Ä‘áº£m báº£o tuÃ¢n thá»§ chÃ­nh sÃ¡ch mÃ£ hÃ³a máº¡nh.
	- Kháº£ nÄƒng má»Ÿ rá»™ng: Dá»… dÃ ng quáº£n lÃ½ hÃ ng trÄƒm hoáº·c hÃ ng nghÃ¬n chá»©ng chá»‰ trong há»‡ thá»‘ng lá»›n.
- CÃ¡c giáº£i phÃ¡p 
	- ACME (Automatic Certificate Management Environment): Giao thá»©c tiÃªu chuáº©n Ä‘Æ°á»£c Let's Encrypt vÃ  nhiá»u CA khÃ¡c sá»­ dá»¥ng Ä‘á»ƒ tá»± Ä‘á»™ng cáº¥p vÃ  gia háº¡n chá»©ng chá»‰.
	- REST API: Cho phÃ©p tÃ­ch há»£p quáº£n lÃ½ chá»©ng chá»‰ vÃ o há»‡ thá»‘ng CI/CD hoáº·c cÃ¡c ná»n táº£ng DevOps.
	- Certbot: CÃ´ng cá»¥ mÃ£ nguá»“n má»Ÿ phá»• biáº¿n Ä‘á»ƒ tá»± Ä‘á»™ng hÃ³a SSL vá»›i Let's Encrypt, há»— trá»£ Apache, Nginx, IIS,...
	- Dá»‹ch vá»¥ thÆ°Æ¡ng máº¡i: CÃ¡c ná»n táº£ng nhÆ° DigiCert CertCentral, GlobalSign Atlas, hoáº·c SSLTrust cung cáº¥p giáº£i phÃ¡p tá»± Ä‘á»™ng hÃ³a toÃ n diá»‡n cho doanh nghiá»‡p.
- Hiá»‡n nay cÃ³ má»™t sá»‘ web server há»— trá»£ tá»± Ä‘á»™ng cáº¥p vÃ  gia háº¡n chá»©ng chá»‰ SSL (AutoSSL), giÃºp Ä‘Æ¡n giáº£n hÃ³a viá»‡c báº£o máº­t website Ä‘Ã¡ng chÃº Ã½ cÃ³ thá»ƒ ká»ƒ tá»›i lÃ  Caddy, cÃ¡c Web Hosting Manager cÅ©ng há»— trá»£ viá»‡c auto ssl sá»­ dá»¥ng Let's Encrypt 
	- Tá»± Ä‘á»™ng HTTPS máº·c Ä‘á»‹nh: Caddy lÃ  web server Ä‘áº§u tiÃªn há»— trá»£ HTTPS tá»± Ä‘á»™ng ngay khi cáº¥u hÃ¬nh tÃªn miá»n.
	- TÃ­ch há»£p ACME (Let's Encrypt, ZeroSSL): KhÃ´ng cáº§n cÃ i thÃªm cÃ´ng cá»¥ ngoÃ i.
	- Tá»± Ä‘á»™ng gia háº¡n, redirect HTTP â†’ HTTPS, khÃ´ng downtime.
	- Cáº¥u hÃ¬nh cá»±c ká»³ Ä‘Æ¡n giáº£n, phÃ¹ há»£p cáº£ cho dev cÃ¡ nhÃ¢n láº«n há»‡ thá»‘ng lá»›n

## 11. SSL vÃ  luáº­t phÃ¡p â€“ Quy Ä‘á»‹nh
### 11.1 Quy Ä‘á»‹nh vá» báº£o máº­t thÃ´ng tin (PCI-DSS, GDPR, HIPAA,...)
- Trong thá»i Ä‘áº¡i ká»¹ thuáº­t sá»‘ ngÃ y nay, dá»¯ liá»‡u Ä‘Ã£ trá»Ÿ thÃ nh má»™t trong nhá»¯ng tÃ i sáº£n cÃ³ giÃ¡ trá»‹ nháº¥t Ä‘á»‘i vá»›i cÃ¡c tá»• chá»©c trÃªn toÃ n tháº¿ giá»›i. Báº£o vá»‡ dá»¯ liá»‡u nÃ y khá»i cÃ¡c vi pháº¡m vÃ  Ä‘áº£m báº£o tÃ­nh báº£o máº­t, toÃ n váº¹n vÃ  kháº£ dá»¥ng cá»§a dá»¯ liá»‡u lÃ  Ä‘iá»u tá»‘i quan trá»ng. Äá»ƒ giáº£i quyáº¿t nhá»¯ng lo ngáº¡i nÃ y, nhiá»u tiÃªu chuáº©n vÃ  quy Ä‘á»‹nh vá» tuÃ¢n thá»§ an ninh máº¡ng Ä‘Ã£ Ä‘Æ°á»£c thiáº¿t láº­p.
#### 11.1.1 PCI-DSS  
- PCI DSS (Payment Card Indutry Data Security Standard) lÃ  tiÃªu chuáº©n báº£o máº­t xÃ¡c láº­p bá»Ÿi Há»™i Ä‘á»“ng TiÃªu chuáº©n Báº£o máº­t (PCI Security Standards Council) gá»“m cÃ¡c thÃ nh viÃªn: Visa, MasterCard, American Express, Discover Financial Services, JCB International.
- TiÃªu chuáº©n nÃ y giÃºp Ä‘áº£m báº£o tÃ­nh báº£o máº­t cá»§a cÃ¡c dá»¯ liá»‡u trong tháº» thanh toÃ¡n khi Ä‘Æ°á»£c lÆ°u trong cÃ¡c ngÃ¢n hÃ ng hoáº·c cÃ¡c tá»• chá»©c cÃ³ há»— trá»£ thanh toÃ¡n Ä‘iá»‡n tá»­. PCI DSS Ä‘Æ°á»£c Ã¡p dá»¥ng trong pháº¡m vi toÃ n cáº§u. Äá»ƒ cÃ³ Ä‘Æ°á»£c chá»©ng chá»‰ nÃ y, cÃ¡c doanh nghiá»‡p cáº§n pháº£i Ä‘Ã¡p á»©ng Ä‘Æ°á»£c cháº¥t lÆ°á»£ng cÆ¡ sá»Ÿ háº¡ táº§ng vÃ  cáº§n Ä‘Æ°á»£c kiá»ƒm tra liÃªn tá»¥c hÃ ng thÃ¡ng.
- CÃ¡c doanh nghiá»‡p cáº§n tuÃ¢n thá»§ 
	- Táº¥t cáº£ cÃ¡c doanh nghiá»‡p hoáº·c nhÃ  cung cáº¥p cÃ³ há»— trá»£ xá»­ lÃ½, truyá»n táº£i hoáº·c lÆ°u trá»¯ dá»¯ liá»‡u chá»§ tháº» thanh toÃ¡n.
	- CÃ¡c nhÃ  cung cáº¥p há»— trá»£ thanh toÃ¡n báº±ng tháº» tÃ­n dá»¥ng cho hÃ ng hÃ³a hoáº·c dá»‹ch vá»¥ cÅ©ng cáº§n pháº£i cÃ³ tiÃªu chuáº©n nÃ y. DÃ¹ cho cÃ¡c nhÃ  cung cáº¥p nÃ y Ä‘Ã£ kÃ½ há»£p Ä‘á»“ng vá»›i bÃªn thá»© ba há»— trá»£ xá»­ lÃ½ tháº» thanh toÃ¡n thÃ¬ nhÃ  cung cáº¥p váº«n cáº§n pháº£i cÃ³ PCI DSS. 
	- CÃ¡c nhÃ  cung cáº¥p bÃªn thá»© ba, há»— trá»£ trá»±c tiáº¿p tham gia xá»­ lÃ½, lÆ°u trá»¯ hoáº·c truyá»n táº£i thÃ´ng tin vá» chá»§ tháº» thanh toÃ¡n thay máº·t cho má»™t doanh nghiá»‡p khÃ¡c
	- CÃ¡c tá»• chá»©c vá»«a lÃ  nhÃ  cung cáº¥p hÃ ng hÃ³a dá»‹ch vá»¥, vá»«a lÃ  bÃªn thá»© ba há»— trá»£ xá»­ lÃ½ thanh toÃ¡n cho cÃ¡c doanh nghiá»‡p khÃ¡c
- Má»¥c Ä‘Ã­ch chÃ­nh cá»§a tiÃªu chuáº©n PCI DSS lÃ  giÃºp tá»‘i Æ°u hÃ³a tÃ­nh báº£o máº­t cho cÃ¡c dá»¯ liá»‡u quan trá»ng cá»§a chá»§ tháº» thanh toÃ¡n, vÃ­ dá»¥ nhÆ° sá»‘ tháº» tÃ­n dá»¥ng, ngÃ y háº¿t háº¡n vÃ  code báº£o máº­t. Qua Ä‘Ã³, giÃºp doanh nghiá»‡p giáº£m thiá»ƒu cÃ¡c rá»§i ro vá» vi pháº¡m dá»¯ liá»‡u, gian láº­n vÃ  Ä‘Ã¡nh cáº¯p thÃ´ng tin chá»§ tháº».
- Viá»‡c tuÃ¢n thá»§ theo chá»©ng chá»‰ PCI DSS cÅ©ng Ä‘á»“ng nghÄ©a ráº±ng doanh nghiá»‡p tuÃ¢n thá»§ cÃ¡c phÆ°Æ¡ng phÃ¡p tá»‘t nháº¥t khi xá»­ lÃ½, lÆ°u trá»¯ vÃ  truyá»n táº£i dá»¯ liá»‡u thanh toÃ¡n tháº» tÃ­n dá»¥ng. BÃªn cáº¡nh Ä‘Ã³, viá»‡c tuÃ¢n thá»§ PCI DSS sáº½ giÃºp tÄƒng niá»m tin cá»§a khÃ¡ch hÃ ng vÃ  Ä‘á»‘i tÃ¡c liÃªn quan vá»›i doanh nghiá»‡p.
- Má»©c Ä‘á»™ tuÃ¢n thá»§ cá»§a PCI DSS gá»“m 4 cáº¥p Ä‘á»™ khÃ¡c nhau, tÃ¹y thuá»™c vÃ o sá»‘ lÆ°á»£ng giao dá»‹ch hÃ ng nÄƒm mÃ  má»™t doanh nghiá»‡p xá»­ lÃ½. CÃ¡c cáº¥p Ä‘á»™ nÃ y xÃ¡c Ä‘á»‹nh cÃ¡c hoáº¡t Ä‘á»™ng mÃ  doanh nghiá»‡p cáº§n lÃ m Ä‘á»ƒ Ä‘áº¡t tiÃªu chuáº©n PCI DSS:
	- Cáº¥p 1: Ãp dá»¥ng cho cÃ¡c doanh nghiá»‡p sá»­ dá»¥ng hÆ¡n 6 triá»‡u lÆ°á»£t giao dá»‹ch qua tháº» tÃ­n dá»¥ng hoáº·c tháº» ghi ná»£ hÃ ng nÄƒm. CÃ¡c Ä‘Æ¡n vá»‹ cung cáº¥p PCI sáº½ kiá»ƒm tra kiá»ƒm toÃ¡n doanh nghiá»‡p má»—i nÄƒm má»™t láº§n.
	- Cáº¥p 2: Ãp dá»¥ng cho cÃ¡c doanh nghiá»‡p sá»­ dá»¥ng tá»« 1 Ä‘áº¿n 6 triá»‡u lÆ°á»£t giao dá»‹ch qua tháº» tÃ­n dá»¥ng hoáº·c tháº» ghi ná»£ hÃ ng nÄƒm. CÃ¡c doanh nghiá»‡p nÃ y cáº§n pháº£i lÃ m báº£ng cÃ¢u há»i tá»± Ä‘Ã¡nh giÃ¡ má»—i nÄƒm má»™t láº§n vÃ  cáº§n quÃ©t PCI má»—i quÃ½.
	- Cáº¥p 3: Ãp dá»¥ng cho cÃ¡c doanh nghiá»‡p sá»­ dá»¥ng tá»« 20.000 Ä‘áº¿n 1 triá»‡u lÆ°á»£t giao dá»‹ch qua tháº» tÃ­n dá»¥ng hoáº·c tháº» ghi ná»£ hÃ ng nÄƒm. TÆ°Æ¡ng tá»± cáº¥p 2, cÃ¡c doanh nghiá»‡p nÃ y cáº§n pháº£i lÃ m báº£ng cÃ¢u há»i tá»± Ä‘Ã¡nh giÃ¡ má»—i nÄƒm má»™t láº§n vÃ  cáº§n quÃ©t PCI má»—i quÃ½.
	- Cáº¥p 4: Ãp dá»¥ng cho cÃ¡c doanh nghiá»‡p sá»­ dá»¥ng Ã­t hÆ¡n 20.000 lÆ°á»£t giao dá»‹ch qua tháº» tÃ­n dá»¥ng hoáº·c tháº» ghi ná»£ hÃ ng nÄƒm. Há» cÅ©ng cáº§n pháº£i Ä‘iá»n báº£ng tá»± Ä‘Ã¡nh giÃ¡ má»—i nÄƒm vÃ  quÃ©t PCI má»—i quÃ½.
- TiÃªu chuáº©n PCI DSS Ä‘Ã£ cung cáº¥p 12 yÃªu cáº§u khÃ¡c nhau, chia thÃ nh 6 má»¥c Ä‘á»ƒ Ä‘áº£m báº£o viá»‡c xá»­ lÃ½ dá»¯ liá»‡u thanh toÃ¡n Ä‘Æ°á»£c an toÃ n, doanh nghiá»‡p cáº§n pháº£i Ä‘áº£m báº£o tuÃ¢n thá»§ 12 yÃªu cáº§u nÃ y.
	- An toÃ n máº¡ng: 
		- 1. CÃ³ tÆ°á»ng lá»­a hoáº¡t Ä‘á»™ng.
		- 2. Máº­t kháº©u há»‡ thá»‘ng lÃ  máº­t kháº©u gá»‘c.
	- Báº£o máº­t dá»¯ liá»‡u cho chá»§ tháº» thanh toÃ¡n:
		- 3. Dá»¯ liá»‡u pháº£i Ä‘Æ°á»£c báº£o vá»‡ tá»‘t.
		- 4. Khi truyá»n cÃ¡c dá»¯ liá»‡u cá»§a chá»§ tháº» cáº§n pháº£i mÃ£ hÃ³a dá»¯ liá»‡u.
	- NgÄƒn cháº·n lá»— há»•ng báº£o máº­t
		- 5. ThÆ°á»ng xuyÃªn cáº­p nháº­t cÃ¡c pháº§n má»m diá»‡t virus.
		- 6. XÃ¢y dá»±ng vÃ  duy trÃ¬ cÃ¡c há»‡ thá»‘ng, á»©ng dá»¥ng an toÃ n.
	- Kiá»ƒm soÃ¡t lÆ°á»£ng truy cáº­p
		- 7. Giá»›i háº¡n quyá»n truy cáº­p vÃ o dá»¯ liá»‡u cá»§a chá»§ tháº».
		- 8. Má»—i ngÆ°á»i khi truy cáº­p vÃ o pháº£i cÃ³ 1 Ä‘á»‹a chá»‰ ID riÃªng biá»‡t.
		- 9. Háº¡n cháº¿ quyá»n truy cáº­p váº­t lÃ½ vÃ o dá»¯ liá»‡u cá»§a chá»§ tháº».
	- GiÃ¡m sÃ¡t máº¡ng
		- 10. Viá»‡c truy cáº­p vÃ o dá»¯ liá»‡u cá»§a chá»§ tháº» pháº£i Ä‘Æ°á»£c giÃ¡m sÃ¡t vÃ  theo dÃµi.
		- 11. Quy trÃ¬nh báº£o máº­t pháº£i Ä‘Æ°á»£c kiá»ƒm tra vÃ  cáº­p nháº­t, hoÃ n thiá»‡n thÆ°á»ng xuyÃªn.
	- Báº£o máº­t thÃ´ng tin
		- 12. Duy trÃ¬ cÃ¡c chÃ­nh sÃ¡ch vá» báº£o máº­t thÃ´ng tin cho chá»§ tháº».
#### 11.1.2 GDPR
- GDPR lÃ  viáº¿t táº¯t cá»§a General Data Protection Regulation. ÄÃ¢y lÃ  má»™t quy Ä‘á»‹nh phÃ¡p lÃ½ cÃ³ hiá»‡u lá»±c trÃªn toÃ n LiÃªn minh ChÃ¢u Ã‚u (EU) vÃ  Khu vá»±c kinh táº¿ ChÃ¢u Ã‚u (EEA) tá»« ngÃ y 25 thÃ¡ng 5 nÄƒm 2018. Quy Ä‘á»‹nh nÃ y Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ báº£o vá»‡ dá»¯ liá»‡u cÃ¡ nhÃ¢n cá»§a cÃ´ng dÃ¢n EU vÃ  trao quyá»n cho há» kiá»ƒm soÃ¡t dá»¯ liá»‡u nÃ y. Má»¥c Ä‘Ã­ch cá»§a viá»‡c tuÃ¢n thá»§ GDPR:
	- Báº£o vá»‡ quyá»n riÃªng tÆ° vÃ  dá»¯ liá»‡u cÃ¡ nhÃ¢n cá»§a cÃ´ng dÃ¢n EU.
	- Thá»‘ng nháº¥t cÃ¡c quy Ä‘á»‹nh báº£o vá»‡ dá»¯ liá»‡u trÃªn toÃ n EU.
	- Trao quyá»n cho cÃ¡c cÃ¡ nhÃ¢n kiá»ƒm soÃ¡t dá»¯ liá»‡u cá»§a há».
	- Ãp Ä‘áº·t cÃ¡c hÃ¬nh pháº¡t nghiÃªm kháº¯c Ä‘á»‘i vá»›i cÃ¡c vi pháº¡m.
- NguyÃªn táº¯c cá»‘t lÃµi cá»§a GDPR
	- TÃ­nh minh báº¡ch: CÃ¡c cÃ´ng ty pháº£i minh báº¡ch vá» cÃ¡ch há» thu tháº­p, xá»­ lÃ½ vÃ  lÆ°u trá»¯ dá»¯ liá»‡u cÃ¡ nhÃ¢n.
	- CÃ´ng báº±ng vÃ  há»£p phÃ¡p: Dá»¯ liá»‡u cÃ¡ nhÃ¢n chá»‰ Ä‘Æ°á»£c thu tháº­p vÃ  xá»­ lÃ½ vá»›i sá»± Ä‘á»“ng Ã½ cá»§a cÃ¡ nhÃ¢n hoáº·c trÃªn cÆ¡ sá»Ÿ phÃ¡p lÃ½ há»£p lá»‡.
	- Háº¡n cháº¿ má»¥c Ä‘Ã­ch: Dá»¯ liá»‡u cÃ¡ nhÃ¢n chá»‰ cÃ³ thá»ƒ Ä‘Æ°á»£c thu tháº­p vÃ  xá»­ lÃ½ cho cÃ¡c má»¥c Ä‘Ã­ch cá»¥ thá»ƒ, rÃµ rÃ ng vÃ  há»£p phÃ¡p.
	- Tuá»•i thá» lÆ°u trá»¯: Dá»¯ liá»‡u cÃ¡ nhÃ¢n Ä‘Æ°á»£c lÆ°u trá»¯ trong thá»i gian cáº§n thiáº¿t cho cÃ¡c má»¥c Ä‘Ã­ch Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh.
	- Báº£o máº­t dá»¯ liá»‡u: CÃ¡c biá»‡n phÃ¡p ká»¹ thuáº­t vÃ  tá»• chá»©c thÃ­ch há»£p pháº£i Ä‘Æ°á»£c thá»±c hiá»‡n Ä‘á»ƒ báº£o vá»‡ dá»¯ liá»‡u cÃ¡ nhÃ¢n khá»i truy cáº­p, sá»­ dá»¥ng, tiáº¿t lá»™ khÃ´ng Ä‘Æ°á»£c á»§y quyá»n hoáº·c phÃ¡ há»§y.
- GDPR áº£nh hÆ°á»Ÿng Ä‘áº¿n báº¥t ká»³ doanh nghiá»‡p nÃ o thu tháº­p, xá»­ lÃ½ hoáº·c lÆ°u trá»¯ dá»¯ liá»‡u cÃ¡ nhÃ¢n cá»§a cÃ´ng dÃ¢n EU. áº¢nh hÆ°á»Ÿng cá»¥ thá»ƒ cá»§a GDPR tÃ¹y thuá»™c vÃ o loáº¡i dá»¯ liá»‡u Ä‘Æ°á»£c xá»­ lÃ½ vÃ  cÃ¡ch thá»©c xá»­ lÃ½ dá»¯ liá»‡u.
- GDPR báº£o vá»‡ nhá»¯ng loáº¡i thÃ´ng tin riÃªng tÆ° nhÆ°
	- CÃ¡c thÃ´ng tin Ä‘á»‹nh danh cÆ¡ báº£n nhÆ° tÃªn tuá»•i, Ä‘á»‹a chá»‰, sá»‘ ID
	- Dá»¯ liá»‡u duyá»‡t web, cháº³ng háº¡n Ä‘á»‹a Ä‘iá»ƒm, Ä‘á»‹a chá»‰ IP, cookies vÃ  RFID tags.
	- ThÃ´ng tin sá»©c khá»e vÃ  di truyá»n
	- Dá»¯ liá»‡u sinh tráº¯c há»c
	- Chá»§ng tá»™c/ dÃ¢n tá»™c
	- Quan Ä‘iá»ƒm chÃ­nh trá»‹
	- Xu hÆ°á»›ng tÃ­nh dá»¥c
- Doanh nghiá»‡p cáº§n tuÃ¢n thá»§
	- Táº¥t cáº£ cÃ¡c cÃ´ng ty lÆ°u trá»¯ hoáº·c sá»Ÿ há»¯u thÃ´ng tin cÃ¡ nhÃ¢n cá»§a cÃ´ng dÃ¢n EU. Cá»¥ thá»ƒ hÆ¡n, cÃ¡c cÃ´ng ty cáº§n tuÃ¢n thá»§ GDPR náº¿u:
	- CÃ´ng ty cÃ³ trá»¥ sá»Ÿ táº¡i EU
	- CÃ³ hÆ¡n 250 lao Ä‘á»™ng
	- Ãt hÆ¡n 250 lao Ä‘á»™ng nhÆ°ng, nhÆ°ng quÃ¡ trÃ¬nh xá»­ lÃ½ dá»¯ liá»‡u áº£nh hÆ°á»Ÿng Ä‘áº¿n quyá»n vÃ  tá»± do cá»§a chá»§ thá»ƒ dá»¯ liá»‡u, hoáº·c bao gá»“m má»™t sá»‘ loáº¡i dá»¯ liá»‡u cÃ¡ nhÃ¢n nháº¡y cáº£m.
#### 11.1.3 HIPAA
- HIPAA (Health Insurance Portability and Accountability Act) lÃ  má»™t Ä‘áº¡o luáº­t quan trá»ng Ä‘Æ°á»£c ban hÃ nh bá»Ÿi chÃ­nh phá»§ liÃªn bang Hoa Ká»³ vÃ o nÄƒm 1996, nháº±m thiáº¿t láº­p cÃ¡c quy Ä‘á»‹nh vá» viá»‡c truy cáº­p, báº£o vá»‡, lÆ°u trá»¯, kiá»ƒm tra vÃ  chuyá»ƒn giao cÃ¡c há»“ sÆ¡ y táº¿ Ä‘iá»‡n tá»­. 
- Äáº¡o luáº­t nÃ y báº£o vá»‡ quyá»n lá»£i cá»§a bá»‡nh nhÃ¢n trong viá»‡c kiá»ƒm soÃ¡t thÃ´ng tin sá»©c khá»e cá»§a mÃ¬nh, Ä‘á»“ng thá»i quy Ä‘á»‹nh rÃµ khi nÃ o vÃ  trong hoÃ n cáº£nh nÃ o thÃ´ng tin nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c chia sáº». NgoÃ i ra, HIPAA yÃªu cáº§u cÃ¡c bÃ¡c sÄ©, dÆ°á»£c sÄ©, nhÃ  cung cáº¥p dá»‹ch vá»¥ y táº¿ vÃ  cÃ¡c chÆ°Æ¡ng trÃ¬nh báº£o hiá»ƒm sá»©c khá»e pháº£i thÃ´ng bÃ¡o cho bá»‡nh nhÃ¢n vá» quyá»n lá»£i cá»§a há».
- 5 Ä‘iá»u luáº­t Ä‘Æ°á»£c quy Ä‘á»‹nh trong HIPAA:
	- Luáº­t báº£o vá»‡ sá»± riÃªng tÆ° (Privacy rule)
	- Luáº­t báº£o máº­t thÃ´ng tin Ä‘iá»‡n tá»­ (Security rule)
	- Luáº­t chuyá»ƒn tiáº¿p dá»¯ liá»‡u (Transaction rule)
	- Luáº­t báº£o máº­t nháº­n diá»‡n danh tÃ­nh (Identifier rules)
	- CÃ¡c quy táº¯c thá»±c thi (Enforcement rule)
- CÃ¡c tá»• chá»©c, doanh nghiá»‡p cáº§n tuÃ¢n thá»§ HIPAA
	- NhÃ  cung cáº¥p dá»‹ch vá»¥ chÄƒm sÃ³c sá»©c khá»e: Báº¥t ká»³ cÃ¡ nhÃ¢n hoáº·c tá»• chá»©c nÃ o cung cáº¥p dá»‹ch vá»¥ chÄƒm sÃ³c sá»©c khá»e, bao gá»“m bÃ¡c sÄ©, y tÃ¡, bá»‡nh viá»‡n, phÃ²ng khÃ¡m,...
	- CÃ¡c cÃ´ng ty báº£o hiá»ƒm cung cáº¥p báº£o hiá»ƒm y táº¿ hoáº·c quáº£n lÃ½ cÃ¡c yÃªu cáº§u bá»“i thÆ°á»ng y táº¿.
	- CÃ¡c tá»• chá»©c xá»­ lÃ½ thanh toÃ¡n cho cÃ¡c dá»‹ch vá»¥ chÄƒm sÃ³c sá»©c khá»e, cháº³ng háº¡n nhÆ° cÃ´ng ty báº£o hiá»ƒm, nhÃ  cung cáº¥p dá»‹ch vá»¥ thanh toÃ¡n vÃ  cÃ¡c cÆ¡ quan chÃ­nh phá»§.
	- CÃ¡c tá»• chá»©c cung cáº¥p dá»‹ch vá»¥ cho cÃ¡c nhÃ  cung cáº¥p dá»‹ch vá»¥ chÄƒm sÃ³c sá»©c khá»e hoáº·c cÃ¡c káº¿ hoáº¡ch báº£o hiá»ƒm y táº¿, cÃ³ thá»ƒ tiáº¿p cáº­n ThÃ´ng tin Sá»©c khá»e Ä‘Æ°á»£c Báº£o vá»‡ (PHI) trong quÃ¡ trÃ¬nh lÃ m viá»‡c.	
- CÃ¡c thÃ´ng tin Ä‘Æ°á»£c báº£o vá»‡ bá»Ÿi HIPAA
	- ThÃ´ng tin sá»©c khá»e Ä‘Æ°á»£c báº£o vá»‡ (PHI) bao gá»“m:
		- ThÃ´ng tin y táº¿:
		- Bá»‡nh Ã¡n, cháº©n Ä‘oÃ¡n, Ä‘Æ¡n thuá»‘c
		- Káº¿t quáº£ xÃ©t nghiá»‡m, hÃ¬nh áº£nh y khoa
		- Tiá»n sá»­ bá»‡nh vÃ  káº¿ hoáº¡ch Ä‘iá»u trá»‹
		- ThÃ´ng tin Ä‘Æ¡n vá»‹ y táº¿:
		- BÃ¡c sÄ© Ä‘iá»u trá»‹, bá»‡nh viá»‡n, phÃ²ng khÃ¡m, nhÃ  thuá»‘c
		- Dá»‹ch vá»¥ y táº¿ mÃ  bá»‡nh nhÃ¢n Ä‘Ã£ sá»­ dá»¥ng
		- ThÃ´ng tin thanh toÃ¡n:
		- Chi tiáº¿t báº£o hiá»ƒm y táº¿, sá»‘ tháº»
		- Sá»‘ tiá»n thanh toÃ¡n, thÃ´ng tin ngÃ¢n hÃ ng
	- 18 loáº¡i thÃ´ng tin Ä‘á»‹nh danh cÃ¡ nhÃ¢n (PII) cáº§n Ä‘Æ°á»£c báº£o vá»‡:
		- Há» tÃªn
		- Äá»‹a chá»‰ (nhÃ , Ä‘Æ°á»ng, tá»‰nh, mÃ£ ZIP,...)
		- NgÃ y sinh (trá»« nÄƒm)
		- Sá»‘ Ä‘iá»‡n thoáº¡i, fax
		- Email
		- Sá»‘ an sinh xÃ£ há»™i (SSN)
		- Sá»‘ há»“ sÆ¡ y táº¿
		- Sá»‘ tháº» báº£o hiá»ƒm y táº¿
		- Sá»‘ tÃ i khoáº£n ngÃ¢n hÃ ng
		- Sá»‘ báº±ng lÃ¡i xe
		- Sá»‘ há»™ chiáº¿u
		- áº¢nh khuÃ´n máº·t
		- Dáº¥u vÃ¢n tay
		- Giá»ng nÃ³i
		- QuÃ©t má»‘ng máº¯t (iris)
		- QuÃ©t vÃµng máº¡c (retina)

### 11.2 Vai trÃ² SSL trong cÃ¡c tiÃªu chuáº©n báº£o máº­t doanh nghiá»‡p
- SSL/TLS Ä‘Ã³ng vai trÃ² trung tÃ¢m trong viá»‡c Ä‘áº£m báº£o báº£o máº­t dá»¯ liá»‡u khi truyá»n táº£i. DÆ°á»›i Ä‘Ã¢y lÃ  vai trÃ² cá»¥ thá»ƒ cá»§a SSL trong tá»«ng tiÃªu chuáº©n:
	- Trong PCI-DSS (Báº£o máº­t dá»¯ liá»‡u tháº» thanh toÃ¡n)
		- YÃªu cáº§u mÃ£ hÃ³a dá»¯ liá»‡u chá»§ tháº» khi truyá»n táº£i (YÃªu cáº§u 4): SSL/TLS Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ£ hÃ³a thÃ´ng tin nhÆ° sá»‘ tháº» tÃ­n dá»¥ng, ngÃ y háº¿t háº¡n, mÃ£ báº£o máº­t khi truyá»n qua máº¡ng cÃ´ng cá»™ng.
		- Báº£o vá»‡ dá»¯ liá»‡u khá»i bá»‹ nghe lÃ©n hoáº·c chá»‰nh sá»­a trong quÃ¡ trÃ¬nh giao dá»‹ch Ä‘iá»‡n tá»­.
		- TÄƒng Ä‘á»™ tin cáº­y vá»›i khÃ¡ch hÃ ng vÃ  Ä‘á»‘i tÃ¡c báº±ng cÃ¡ch sá»­ dá»¥ng HTTPS trÃªn cÃ¡c cá»•ng thanh toÃ¡n.
	- Trong GDPR (Báº£o vá»‡ dá»¯ liá»‡u cÃ¡ nhÃ¢n cÃ´ng dÃ¢n EU)
		- Äáº£m báº£o tÃ­nh báº£o máº­t vÃ  toÃ n váº¹n cá»§a dá»¯ liá»‡u cÃ¡ nhÃ¢n khi truyá»n qua Internet.
		- SSL/TLS lÃ  má»™t trong nhá»¯ng biá»‡n phÃ¡p ká»¹ thuáº­t báº¯t buá»™c Ä‘á»ƒ báº£o vá»‡ dá»¯ liá»‡u khá»i truy cáº­p trÃ¡i phÃ©p (theo nguyÃªn táº¯c â€œbáº£o máº­t dá»¯ liá»‡uâ€ cá»§a GDPR).
		- GiÃºp doanh nghiá»‡p chá»©ng minh tuÃ¢n thá»§ khi bá»‹ kiá»ƒm tra hoáº·c Ä‘iá»u tra vi pháº¡m.
	- Trong HIPAA (Báº£o vá»‡ thÃ´ng tin sá»©c khá»e táº¡i Hoa Ká»³)
		- SSL/TLS Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ£ hÃ³a thÃ´ng tin sá»©c khá»e Ä‘Æ°á»£c báº£o vá»‡ (PHI) khi truyá»n qua máº¡ng, Ä‘áº·c biá»‡t lÃ  trong cÃ¡c há»‡ thá»‘ng EHR (há»“ sÆ¡ y táº¿ Ä‘iá»‡n tá»­).
		- ÄÃ¡p á»©ng yÃªu cáº§u cá»§a Security Rule vá» báº£o vá»‡ dá»¯ liá»‡u trong quÃ¡ trÃ¬nh truyá»n táº£i.
		- GiÃºp cÃ¡c tá»• chá»©c y táº¿ ngÄƒn cháº·n rÃ² rá»‰ dá»¯ liá»‡u bá»‡nh nhÃ¢n, tá»« Ä‘Ã³ trÃ¡nh cÃ¡c khoáº£n pháº¡t vÃ  tá»•n tháº¥t uy tÃ­n.
- Vai trÃ² SSL/TLS trong cÃ¡c tiÃªu chuáº©n báº£o máº­t:
	- MÃ£ hÃ³a dá»¯ liá»‡u nháº¡y cáº£m khi truyá»n táº£i qua máº¡ng.
	- XÃ¡c thá»±c danh tÃ­nh mÃ¡y chá»§ vÃ  Ä‘áº£m báº£o ngÆ°á»i dÃ¹ng Ä‘ang káº¿t ná»‘i Ä‘Ãºng há»‡ thá»‘ng.
	- NgÄƒn cháº·n táº¥n cÃ´ng trung gian (MITM) vÃ  rÃ² rá»‰ dá»¯ liá»‡u.
	- LÃ  yÃªu cáº§u báº¯t buá»™c hoáº·c khuyáº¿n nghá»‹ máº¡nh máº½ trong háº§u háº¿t cÃ¡c tiÃªu chuáº©n báº£o máº­t doanh nghiá»‡p hiá»‡n Ä‘áº¡i.

## 12. Thá»±c hÃ nh 
- Thá»±c hÃ nh cáº¥u hÃ¬nh trÃªn cÃ¡c WebServer: Apache, Nginx, Tomcat, IIS 
	- CÃ i Ä‘áº·t chá»©ng chá»‰ SSL (Self-Signed & ZeroSSL), gáº¯n chá»©ng chá»‰ vÃ o mÃ¡y chá»§ web
	- Cáº¥u hÃ¬nh chuyá»ƒn hÆ°á»›ng HTTP sang HTTPS
	- KÃ­ch hoáº¡t HTTP Strict Transport Security (HSTS)
	- Báº­t OCSP Stapling 
	- Kiá»ƒm tra vÃ  kÃ­ch hoáº¡t há»— trá»£ HTTP/2
- CÃ¡c webserver: Apache, Nginx, Tomcat cÃ i trÃªn Ubuntu 22.04, IIS thá»±c hiá»‡n trÃªn Windows Server 2022 Standard 
### 12.1 Táº¡o SSL
#### 12.1.1 Self Signed Certificate
- Táº¡o thÆ° má»¥c lÆ°u key, chá»©ng chá»‰.
``` 
mkdir /etc/ssl/self_signed/
cd /etc/ssl/self_signed/
```
- BÆ°á»›c 1: Táº¡o khÃ³a bÃ­ máº­t (Private Key)
```
openssl genrsa -out annth.key 2048
```
- BÆ°á»›c 2: Táº¡o CSR (Certificate Signing Request)
```
openssl req -new -key annth.key -out annth.csr
```
- Cáº¥u hÃ¬nh cÃ¡c thÃ´ng tin nhÆ° quá»‘c gia, tá»‰nh, tÃªn miá»n (Common Name).
- ![images](./images/s-24.png)

- BÆ°á»›c 3: Tá»± kÃ½ chá»©ng chá»‰ (Self-signed certificate)
```
openssl x509 -req -days 365 -in annth.csr -signkey annth.key -out annth.crt
```	
- Káº¿t quáº£ thu Ä‘Æ°á»£c:
	- annth.crt: chá»©ng chá»‰ tá»± kÃ½
	- annth.key: khÃ³a bÃ­ máº­t Ä‘i kÃ¨m
- ![images](./images/s-25.png)

#### 12.1.2 ZeroSSL Certificate 
- ZeroSSL - má»™t dá»‹ch vá»¥ cung cáº¥p chá»©ng chá»‰ SSL/TLS miá»…n phÃ­, giÃºp báº£o máº­t dá»¯ liá»‡u khi truyá»n táº£i trÃªn internet
- ÄÄƒng kÃ½ tÃ i khoáº£n ZeroSSL
	- Truy cáº­p trang web chÃ­nh thá»©c táº¡i https://zerossl.com/.
	- Nháº¥n vÃ o má»¥c â€œGet Free SSLâ€ Ä‘á»ƒ táº¡o tÃ i khoáº£n.
	- ![images](./images/s-26.png)
	- ÄÄƒng kÃ½ báº±ng Ä‘á»‹a chá»‰ email cÃ¡ nhÃ¢n hoáº·c Ä‘Äƒng nháº­p thÃ´ng qua tÃ i khoáº£n Google hoáº·c GitHub.
	- ![images](./images/s-27.png)
	- ![images](./images/s-29.png)
	- Sau khi xÃ¡c thá»±c tÃ i khoáº£n, ngÆ°á»i dÃ¹ng sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o giao diá»‡n báº£ng Ä‘iá»u khiá»ƒn (Dashboard) Ä‘á»ƒ quáº£n lÃ½ chá»©ng chá»‰.

- Chuáº©n bá»‹ Certificate Signing Request (CSR)
	- Náº¿u Ä‘á»ƒ ZeroSSL tá»± táº¡o CSR, bá» qua bÆ°á»›c nÃ y vÃ  chá»n "Auto-Generate CSR" trong giao diá»‡n.
	- Náº¿u muá»‘n tá»± táº¡o CSR Ä‘á»ƒ tÃ¡i sá»­ dá»¥ng: Sá»­ dá»¥ng CSR tá»« pháº§n táº¡o trÆ°á»›c táº¡o chá»©ng chá»‰ self signed 

- Táº¡o chá»©ng chá»‰ trong ZeroSSL
	- Táº¡i Dashboard chá»n â€œNew Certificateâ€.
	- ![images](./images/s-30.png)
	- Nháº­p tÃªn miá»n (cÃ³ thá»ƒ nháº­p nhiá»u náº¿u sá»­ dá»¥ng SAN).
	- ![images](./images/s-31.png)
	- Chá»n thá»i háº¡n chá»©ng chá»‰ (miá»…n phÃ­ 90 ngÃ y).
	- ![images](./images/s-32.png)
	- ![images](./images/s-33.png)
	- Táº£i lÃªn file .csr náº¿u dÃ¹ng CSR tá»± táº¡o, hoáº·c Ä‘á»ƒ há»‡ thá»‘ng tá»± sinh.
	- á» Ä‘Ã¢y thá»±c hiá»‡n tá»± up CSR nÃªn táº¯t tá»± sinh, chá»n paste CSR Ä‘Ã£ cÃ³ 
	- ![images](./images/s-34.png)
	- ![images](./images/s-35.png)
	- Copy ná»™i dung file csr Ä‘Ã£ táº¡o 
	- ![images](./images/s-36.png)
	- ![images](./images/s-37.png)
	- Next 
	- ![images](./images/s-38.png)
	- ![images](./images/s-40.png)

- XÃ¡c minh quyá»n sá»Ÿ há»¯u tÃªn miá»n
	- ZeroSSL há»— trá»£ ba phÆ°Æ¡ng phÃ¡p:
	- HTTP File Upload: Táº£i file .txt vÃ  Ä‘áº·t vÃ o Ä‘Æ°á»ng dáº«n .well-known/pki-validation/ trÃªn web server.
	- ![images](./images/s-43.png)
	- DNS CNAME: Táº¡o báº£n ghi CNAME trong cáº¥u hÃ¬nh DNS cá»§a tÃªn miá»n.
	- ![images](./images/s-42.png)
	- Email: Nháº­n email xÃ¡c thá»±c gá»­i Ä‘áº¿n cÃ¡c Ä‘á»‹a chá»‰ quáº£n trá»‹ nhÆ° admin@domain.com.
	- ![images](./images/s-41.png)
	- Sá»­ dá»¥ng xÃ¡c minh báº±ng CNAME táº¡o báº£n ghi 
	- ![images](./images/s-44.png)
	- ![images](./images/s-45.png)
	- XÃ¡c minh 
	- ![images](./images/s-46.png)
	- ![images](./images/s-47.png)

- Chá»©ng chá»‰ Ä‘Æ°á»£c táº¡o 
	- Sau khi xÃ¡c minh thÃ nh cÃ´ng, chá»©ng chá»‰ sáº½ Ä‘Æ°á»£c cáº¥p.
	- ![images](./images/s-48.png)
	- Táº£i chá»©ng chá»‰ vá»
	- Sau khi chá»©ng chá»‰ Ä‘Æ°á»£c phÃ¡t hÃ nh, ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ táº£i vá» gÃ³i .zip bao gá»“m:
		- certificate.crt: chá»©ng chá»‰ chÃ­nh.
		- ca_bundle.crt: intermediate CA.
		- private.key: náº¿u sá»­ dá»¥ng CSR do há»‡ thá»‘ng táº¡o.
	- ![images](./images/s-49.png)
	- ![images](./images/s-50.png)
	- ![images](./images/s-51.png)

- Upload lÃªn thÆ° má»¥c trÃªn mÃ¡y chá»§ cÃ i Ä‘áº·t 
	- Táº¡o thÆ° má»¥c lÆ°u chá»©ng chá»‰ 
	```
	mkdir /etc/ssl/zerossl/
	```
	- ![images](./images/s-52.png)
	- Sá»­ dá»¥ng scp upload cert tá»« client lÃªn server 
	```
	scp -i ah.pem -P 2222 ca_bundle.crt root@34.128.67.222:/etc/ssl/zerossl/
	scp -i ah.pem -P 2222 certificate.crt root@34.128.67.222:/etc/ssl/zerossl/
	```
	- ![images](./images/s-53.png)
	- ![images](./images/s-54.png)

### 12.2 CÃ i Ä‘áº·t, cáº¥u hÃ¬nh trÃªn cÃ¡c Webserver 
#### 12.2.1 Apache  
##### CÃ i Ä‘áº·t  
- Sá»­ dá»¥ng lá»‡nh sau Ä‘á»ƒ cÃ i Apache
```
sudo apt install apache2 -y 
```
- ![images](./images/s-55.png)
```
sudo systemctl status apache2
```
- ![images](./images/s-56.png)
- TrÃªn mÃ¡y chá»§ Ä‘Ã£ cÃ i apache thá»±c hiá»‡n táº¡o HTML demo
```
mkdir -p /var/www/annth/public_html
nano /var/www/annth/public_html/index.html 
```
- Ná»™i dung file html 
```
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Website Test</title>
    <style>
        body {
            font-family: sans-serif;
            text-align: center;
            margin-top: 100px;
        }
    </style>
</head>
<body>
    <h1>annth.io.vn</h1>
    <p>Hello, World!</p>
    <footer>
        Â© 2025 annth.io.vn
    </footer>
</body>
</html>
```

- Cáº¥p quyá»n
``` 
chown -R $USER:$USER /var/www/annth/public_html/
chmod -R 755 /var/www/
```
- ![images](./images/s-58.png)
- Enable module ssl 
```
a2enmod ssl 
```
- ![images](./images/s-61.png)

##### CÃ i Ä‘áº·t chá»©ng chá»‰ SSL 
- Sá»­ dá»¥ng SelfSigned tá»± kÃ½ 
	- Táº¡o Virtual Host má»›i vÃ  thÃªm ná»™i dung
	```
	nano /etc/apache2/sites-available/annth_selfsigned_ssl.conf
	```
	```
	<VirtualHost *:443>
		ServerAdmin admin@annth.io.vn
		ServerName annth.io.vn
		ServerAlias www.annth.io.vn
		DocumentRoot /var/www/annth/public_html/
		ErrorLog /var/log/apache2/annth.error.log
		CustomLog /var/log/apache2/annth.access.log combined
		SSLEngine on
		SSLCertificateFile      /etc/ssl/self_signed/annth.crt
		SSLCertificateKeyFile   /etc/ssl/self_signed/annth.key
		#SSLCertificateChainFile 

		SSLProtocol all -SSLv2 -SSLv3
		SSLCipherSuite HIGH:!aNULL:!MD5
	</VirtualHost>
	```
	- ![images](./images/s-62.png)
	- Disable site default
	```
	a2dissite default-ssl.conf
	a2dissite 000-default.conf
	```
	- ![images](./images/s-63.png) 
	- Enable virtual host 
	```
	a2ensite annth_selfsigned_ssl.conf
	systemctl reload apache2 
	```
	- ![images](./images/s-65.png) 
	- Kiá»ƒm tra nháº­n tháº¥y Ä‘Ã£ nháº­n chá»©ng chá»‰ 
	- ![images](./images/s-64.png) 
	- ![images](./images/s-66.png) 
	- ![images](./images/s-67.png) 

- Sá»­ dá»¥ng chá»©ng chá»‰ cáº¥p bá»Ÿi ZeroSSL 
	- Táº¡o file VirtualHost
	``` 
	nano /etc/apache2/sites-available/annth_zerossl.conf
	```
	```
	<VirtualHost *:443>
		ServerAdmin admin@annth.io.vn
		ServerName annth.io.vn
		ServerAlias www.annth.io.vn
		DocumentRoot /var/www/annth/public_html/
		ErrorLog /var/log/apache2/annth.error.log
		CustomLog /var/log/apache2/annth.access.log combined
		SSLEngine on
		SSLCertificateFile      /etc/ssl/zerossl/certificate.crt
		SSLCertificateKeyFile   /etc/ssl/self_signed/annth.key
		SSLCertificateChainFile /etc/ssl/zerossl/ca_bundle.crt

		SSLProtocol all -SSLv2 -SSLv3
		SSLCipherSuite HIGH:!aNULL:!MD5
	</VirtualHost>

	```
	- ![images](./images/s-68.png) 
	- Disable virtualhost cÅ© vÃ  enable virtual host sá»­ dá»¥ng chá»©ng chá»‰ zerossl 
	```
	a2dissite annth_selfsigned_ssl.conf
	a2ensite annth_zerossl.conf
	systemctl reload apache2
	```
	- ![images](./images/s-69.png) 
	- Kiá»ƒm tra  
	- ![images](./images/s-59.png) 
	- ![images](./images/s-60.png) 

##### Cáº¥u hÃ¬nh HTTP Redirect, HSTS, OCSP Stapling, HTTP/2 
- HTTPS redirect (301)
	- Chá»‰nh sá»­a file VirtualHost port 80 thÃªm cáº¥u hÃ¬nh 
	`Redirect permanent / https://yourdomain.com/`
	- VÃ­ dá»¥ 
	```
	<VirtualHost *:80>
		ServerAdmin admin@annth.io.vn
		ServerName annth.io.vn
		ServerAlias www.annth.io.vn
		Redirect permanent / https://annth.io.vn/
		DocumentRoot /var/www/annth/public_html/
		ErrorLog /var/log/apache2/annth.error.log
		CustomLog /var/log/apache2/annth.access.log combined
	</VirtualHost>
	```
	- ![images](./images/s-182.png) 
	- Reload 
	```
	systemctl reload apache2
	```
	- Kiá»ƒm tra 
		- TrÆ°á»›c khi cáº¥u hÃ¬nh  
		- ![images](./images/s-70.png) 
		- Sau khi cáº¥u hÃ¬nh 
		- ![images](./images/s-71.png) 
		- ![images](./images/s-72.png) 

- HSTS
	- Enable module header 
	```
	a2enmod headers.load
	```
	- ![images](./images/s-73.png)
	- Chá»‰nh sá»­a file host thÃªm header HSTS 
	`Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"`
		- max-age=63072000: Thá»i gian (tÃ­nh báº±ng giÃ¢y) mÃ  trÃ¬nh duyá»‡t sáº½ buá»™c sá»­ dá»¥ng HTTPS cho trang web. `63072000` giÃ¢y tÆ°Æ¡ng Ä‘Æ°Æ¡ng 2 nÄƒm.
		- includeSubDomains: Ãp dá»¥ng chÃ­nh sÃ¡ch nÃ y cho táº¥t cáº£ cÃ¡c subdomain (vÃ­ dá»¥: mail.example.com, api.example.com).
		- preload: YÃªu cáº§u trang web Ä‘Æ°á»£c thÃªm vÃ o danh sÃ¡ch "HSTS preload list" cá»§a cÃ¡c trÃ¬nh duyá»‡t
	- ![images](./images/s-74.png) 
	- Reload 
	```
	systemctl reload apache2 
	```
	- Kiá»ƒm tra 
	- ![images](./images/s-75.png)

	- OCSP Stapling
	- Cáº¥u hÃ¬nh chá»‰nh sá»­a file VirtualHost
	- ThÃªm dÃ²ng bÃªn ngoÃ i cáº·p <VirtualHost></VirtualHost>
	```
	SSLStaplingCache shmcb:/tmp/stapling_cache(128000)
	```
	- ThÃªm dÃ²ng bÃªn trong 
	```
	SSLUseStapling on
	SSLCACertificateFile /etc/ssl/zerossl/ca_bundle.crt
	```
	- ![images](./images/s-77.png)
	- Reload apache 
	```
	systemctl reload apache2
	```
	- Kiá»ƒm tra báº±ng lá»‡nh 
	```
	openssl s_client -connect annth.io.vn:443 -status
	```
	- ![images](./images/s-76.png) 

- HTTP/2
	- Enable module 
	```
	a2enmod http2
	```
	- ![images](./images/s-80.png)
	- Reload Apache2
	```
	systemctl restart apache2
	```
	- Kiá»ƒm tra 
	- Sá»­ dá»¥ng lá»‡nh curl 
	``` 
	curl --http2 --head https://annth.io.vn 
	```
	- ![images](./images/s-82.png)
	- Kiá»ƒm tra trÃªn trÃ¬nh duyá»‡t 
	- ![images](./images/s-78.png)
	- Kiá»ƒm tra log 
	- ![images](./images/s-79.png)

##### Kiá»ƒm tra SSL:
- Sá»­ dá»¥ng [SSL Shopper](https://www.sslshopper.com/)
- ![images](./images/s-85.png)
- ![images](./images/s-86.png)
- Sá»­ dá»¥ng [SSL Labs](https://www.ssllabs.com/)
- ![images](./images/s-83.png)
- ![images](./images/s-84.png)
- ![images](./images/s-87.png)


#### 12.2.2 Nginx  
##### CÃ i Ä‘áº·t 
- CÃ i Ä‘áº·t Nginx báº±ng lá»‡nh sau 
```
apt install nginx -y 
```
- ![images](./images/s-88.png)
- Kiá»ƒm tra tráº¡ng thÃ¡i 
```
systemctl status nginx
```
- ![images](./images/s-89.png)
- TrÃªn mÃ¡y chá»§ Ä‘Ã£ cÃ i nginx thá»±c hiá»‡n táº¡o HTML demo tÆ°Æ¡ng tá»± apache2
```
mkdir -p /var/www/annth/public_html
nano /var/www/annth/public_html/index.html 
```
```
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Website Test</title>
    <style>
        body {
            font-family:  sans-serif;
            text-align: center;
            margin-top: 100px;
        }
    </style>
</head>
<body>
    <h1>annth.io.vn</h1>
    <p>Hello, World!</p>
    <footer>
        Â© 2025 annth.io.vn
    </footer>
</body>
</html>
```
```
chown -R $USER:$USER /var/www/annth/public_html/
chmod -R 755 /var/www/
```
- Táº¡o virtual host HTTP 
```
nano /etc/nginx/sites-available/annth
```
```
server {
       listen 80;
       listen [::]:80;

       server_name annth.io.vn;

       root /var/www/annth/public_html/;
       index index.html;

       location / {
               try_files $uri $uri/ =404;
       }
}
```
- ![images](./images/s-91.png)
- Unlink site default, enable annth
```
sudo unlink /etc/nginx/sites-enabled/default
sudo ln -s /etc/nginx/sites-available/annth /etc/nginx/sites-enabled/annth
```
- Test cáº¥u hÃ¬nh vÃ  restart nginx 
```
nginx -t
systemctl restart nginx
```
- ![images](./images/s-92.png)
- Kiá»ƒm tra Ä‘Ã£ cháº¡y trÃªn http 80 
- ![images](./images/s-90.png)

##### CÃ i Ä‘áº·t SSL 
- Sá»­ dá»¥ng SSL Selfsigned 
	- Táº¡o virtual host 443 sá»­ dá»¥ng chá»©ng chá»‰ self-signed
	```
	nano /etc/nginx/sites-available/annth_zerossl
	```
	```
	server {
		listen   443;
		ssl    on;
		ssl_certificate    /etc/ssl/self_signed/annth.crt; 
		ssl_certificate_key    /etc/ssl/self_signed/annth.key;
		server_name annth.io.vn;
		access_log /var/log/nginx/annth.io.vn.access.log;
		error_log /var/log/nginx/annth.io.vn.error.log;
		
		location / {
		root   /var/www/annth/public_html/;
		index  index.html;
		}
	}
	```
	- ![images](./images/s-93.png)
	- Enable virtual host 
	```
	ln -s /etc/nginx/sites-available/annth_selfsigned_ssl /etc/nginx/sites-enabled/annth_selfsigned_ssl
	```
	- Kiá»ƒm tra cáº¥u hÃ¬nh vÃ  reload 
	``` 
	nginx -t
	systemctl restart nginx 
	```
	- ![images](./images/s-94.png)
	- Kiá»ƒm tra:
	- ![images](./images/s-95.png)
	- ![images](./images/s-96.png)

- Sá»­ dá»¥ng SSL ZeroSSL 
	- Thá»±c hiá»‡n merge chá»©ng chá»‰: VÃ¬ Nginx khÃ´ng cÃ³ tÃ¹y chá»n cáº¥u hÃ¬nh tÃ¡ch biá»‡t cho CA Chain ná»n cáº§n gá»™p chuá»—i 
	```
	cat /etc/ssl/zerossl/certificate.crt /etc/ssl/zerossl/ca_bundle.crt > /etc/ssl/zerossl/fullchain.pem
	```
	- ![images](./images/s-97.png)
	- Táº¡o virtual host 443 sá»­ dá»¥ng SSL ZeroSSL
	```
	nano /etc/nginx/sites-available/annth_zerossl
	```
	```
	server {
		listen   443;
		ssl    on;
		ssl_certificate    /etc/ssl/zerossl/fullchain.pem; 
		ssl_certificate_key    /etc/ssl/self_signed/annth.key;
		server_name annth.io.vn;
		access_log /var/log/nginx/annth.io.vn.access.log;
		error_log /var/log/nginx/annth.io.vn.error.log;
		
		location / {
		root   /var/www/annth/public_html/;
		index  index.html;
		}
	}
	```
	- ![images](./images/s-98.png)
	- Disable virtual host cÅ© enable virtual host sá»­ dá»¥ng ssl ZeroSSL
	```
	unlink /etc/nginx/sites-enabled/annth_selfsigned_ssl
	ln -s /etc/nginx/sites-available/annth_zerossl /etc/nginx/sites-enabled/annth_zerossl

	```
	- Test cáº¥u hÃ¬nh vÃ  restart nginx 
	```
	nginx -t
	systemctl restart nginx
	```
	- ![images](./images/s-99.png)
	- Tests
	- ![images](./images/s-100.png)
	- ![images](./images/s-101.png) 
##### Cáº¥u hÃ¬nh HTTP Redirect, HSTS, OCSP Stapling, HTTP/2 
- HTTP Redirect
	- Chá»‰nh sá»­a trong khá»‘i cáº¥u hÃ¬nh server láº¯ng nghe cá»•ng 80 (HTTP), thÃªm:
	```
	nano /etc/nginx/sites-available/annth_zerossl
	```
	`return 301 https://$host$request_uri;`
	- ![images](./images/s-102.png)
	- Reload Nginx
	```
	systemctl restart nginx 
	```
	- Kiá»ƒm tra báº±ng curl 
	```
	curl http://annth.io.vn 
	```
	- ![images](./images/s-103.png) 

	- HSTS 
	- ThÃªm header HSTS táº¡i cÃ¡c file VirtualHost cáº§n cáº¥u hÃ¬nh 
	```
	nano /etc/nginx/sites-available/annth_zerossl
	```
	`add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;`
	- ![images](./images/s-104.png) 
	- Reload Nginx
	```
	systemctl restart nginx 
	```
	- Kiá»ƒm tra 
	- ![images](./images/s-105.png)

- OSCP Stapling
	- Chá»‰nh sá»­a file virtual host 443 thÃªm cÃ¡c thÃ´ng sá»‘ 
	```
	nano /etc/nginx/sites-available/annth_zerossl
	```
	```
	ssl_stapling on;
	ssl_stapling_verify on;
	ssl_trusted_certificate /etc/ssl/zerossl/ca_bundle.crt;
	```
	- ![images](./images/s-113.png)
	- Reload Nginx
	```
	systemctl restart nginx 
	```
	- Kiá»ƒm tra 
	```
	openssl s_client -connect annth.io.vn:443 -status
	```
	- ![images](./images/s-112.png)

- HTTP/2 
	- Enable http2 trong pháº§n listen cá»§a virtualhost 
	```
	nano /etc/nginx/sites-available/annth_zerossl
	```
	`http2`
	- ![images](./images/s-115.png)
	- Kiá»ƒm tra  
	- Sá»­ dá»¥ng trÃ¬nh duyá»‡t 
	- ![images](./images/s-114.png)
	- Trong log 
	- ![images](./images/s-116.png)

##### Kiá»ƒm tra chá»©ng chá»‰ 
- SSL Labs
- ![images](./images/s-118.png)
- SSL Checker 
- ![images](./images/s-117.png)

#### 12.2.3 Tomcat 
##### CÃ i Ä‘áº·t Tomcat
- Táº¡o user 
```
sudo useradd -m -d /opt/tomcat -U -s /bin/false tomcat
```
- CÃ i IDK 
```
sudo apt update
sudo apt install default-jdk
```
- ![images](./images/s-119.png) 
- Kiá»ƒm tra 
```
java -version 
```
- ![images](./images/s-120.png)
- Táº£i file cÃ i 
```
cd /tmp
https://adp-mirror-vm1-he-fi.apache.org/tomcat/tomcat-10/v10.1.4/bin/apache-tomcat-10.1.4.tar.gz
```
- Giáº£i nÃ©n 
```
sudo tar xzvf apache-tomcat-10.1.4.tar.gz -C /opt/tomcat --strip-components=1
```
- ![images](./images/s-121.png) 
- Cáº¥p quyá»n 
```
sudo chown -R tomcat:tomcat /opt/tomcat/
sudo chmod -R u+x /opt/tomcat/bin
```
- ![images](./images/s-122.png)
- Táº¡o Virtual Host 
	```
	nano /opt/tomcat/conf/server.xml
	```
	- Trong tháº» Engine 
		- Thá»±c hiá»‡n comment pháº§n cáº¥u hÃ¬nh host máº·c Ä‘á»‹nh 
		- ![images](./images/s-186.png)
		- VÃ  thÃªm pháº§n sau 
		```
			  <Host name="annth.io.vn" appBase="webapps"
					unpackWARs="false" autoDeploy="true">
					<Alias>www.annth.io.vn</Alias>
					<Context path="" docBase="/var/www/annth/public_html" />
					<Valve className="org.apache.catalina.valves.AccessLogValve"
						   directory="logs"
						   prefix="annth_access_log"
						   suffix=".txt"
						   pattern="%h %l %u %t &quot;%r&quot; %s %b" />
			  </Host>
		```
- Restart 
```
systemctl restart tomcat 
```
- Táº¡o service 
```
sudo nano /etc/systemd/system/tomcat.service
```
```
[Unit]
Description=Tomcat
After=network.target

[Service]
Type=forking

User=tomcat
Group=tomcat

Environment="JAVA_HOME=/usr/lib/jvm/java-1.11.0-openjdk-amd64"
Environment="JAVA_OPTS=-Djava.security.egd=file:///dev/urandom"
Environment="CATALINA_BASE=/opt/tomcat"
Environment="CATALINA_HOME=/opt/tomcat"
Environment="CATALINA_PID=/opt/tomcat/temp/tomcat.pid"
Environment="CATALINA_OPTS=-Xms512M -Xmx1024M -server -XX:+UseParallelGC"

ExecStart=/opt/tomcat/bin/startup.sh
ExecStop=/opt/tomcat/bin/shutdown.sh

RestartSec=10
Restart=always

[Install]
WantedBy=multi-user.target
```
- ![images](./images/s-127.png) 
- Khá»Ÿi Ä‘á»™ng 
```
sudo systemctl daemon-reload
sudo systemctl start tomcat
sudo systemctl status tomcat
```
- ![images](./images/s-128.png) 
- Má»Ÿ port 
```
sudo ufw allow 8080
```
- Thá»±c hiá»‡n kiá»ƒm tra táº¡i http://annth.io.vn:8080/
- ![images](./images/s-130.png)

##### Táº¡o CSR
- Táº¡o keystore
```
keytool -genkey -alias annth.io.vn -keyalg RSA -keysize 2048 -keystore annth.io.vn.jks
keytool -certreq -alias annth.io.vn -file csr.txt -keystore annth.io.vn.jks
```
- ChÃº Ã½ khi táº¡o CSR pháº§n yÃªu cáº§u cung cáº¥p há», tÃªn cáº§n Ä‘iá»n FQDN cá»§a domain cáº§n cáº¥u hÃ¬nh. 
- ![images](./images/s-146.png)
- Sá»­ dá»¥ng CSR xin cert tÆ°Æ¡ng tá»± táº¡i zerossl 
- ![images](./images/s-147.png) 
- ![images](./images/s-148.png) 
- QÃºa trÃ¬nh xÃ¡c minh 
- ![images](./images/s-149.png)
- ![images](./images/s-150.png)
- ![images](./images/s-151.png)
- ![images](./images/s-152.png) 
- Sau khi xÃ¡c minh thÃ nh cÃ´ng Ä‘Æ°á»£c cáº¥p chá»©ng chá»‰ SSL 
- ![images](./images/s-153.png)
- Upload lÃªn thÆ° má»¥c trÃªn mÃ¡y chá»§ cÃ i Ä‘áº·t sá»­ dá»¥ng scp 
```
scp -i ah.pem -P 2222 ca_bundle.crt root@34.128.67.222:/etc/ssl/zerossl/tomcat
scp -i ah.pem -P 2222 certificate.crt root@34.128.67.222:/etc/ssl/zerossl/tomcat
```
- ![images](./images/- ![images](./images/s-154.png)
- ![images](./images/- ![images](./images/s-155.png)

- Convert sang Ä‘á»‹nh dáº¡ng tomcat sá»­ dá»¥ng 
```
openssl crl2pkcs7 -nocrl -certfile certificate.crt -out certificate.p7b -certfile ca_bundle.crt 
```
- ![images](./images/s-156.png)
- Thá»±c hiá»‡n import chá»©ng chá»‰ vÃ o keystore:
```
mv certificate.p7b annth.io.vn.p7b
keytool -import -alias annth.io.vn -file annth.io.vn.p7b -keystore annth.io.vn.jks
```
- ![images](./images/s-157.png)

##### CÃ i Ä‘áº·t SSL 
- Cáº¥u hÃ¬nh Connector táº¡i file server.xml 
```
nano /opt/tomcat/conf/server.xml
```
- Cáº¥u hÃ¬nh pháº§n `Connector` trÃªn port 8443, cung cáº¥p thÃ´ng tin keystore, máº­t kháº©u keystore 
```
	<Connector port="8443"
			   protocol="org.apache.coyote.http11.Http11NioProtocol"
			   SSLEnabled="true"
			   scheme="https"
			   secure="true">

		<SSLHostConfig>
			<Certificate certificateKeystoreFile="/etc/ssl/zerossl/tomcat/annth.io.vn.jks"
						 certificateKeystorePassword="Qaz@123"
						 type="RSA" />
		</SSLHostConfig>
	</Connector>
```
- ![images](./images/s-158.png) 
- Kiá»ƒm tra cáº¥u hÃ¬nh báº±ng lá»‡nh 
```
/opt/tomcat/bin/configtest.sh
```
- ![images](./images/s-159.png)
- ![images](./images/s-160.png)
- Reload 
```
systemctl restart tomcat 
```
- Kiá»ƒm tra táº¡o https://annth.io.vn:8443
- ![images](./images/s-161.png) 

##### Cáº¥u hÃ¬nh HTTP Redirect, HSTS, OCSP Stapling, HTTP/2 
- HTTP Redirect
	- Chá»‰nh sá»­a trong file `web.xml`
	```
	nano /opt/tomcat/conf/web.xml 
	```
	ThÃªm Ä‘oáº¡n sau vÃ o cuá»‘i file trÆ°á»›c tháº» </webapp>
	```
		<security-constraint>
			<web-resource-collection>
			<web-resource-name>Automatic Forward to HTTPS/SSL
			</web-resource-name>
			<url-pattern>/*</url-pattern>
			</web-resource-collection>
			<user-data-constraint>
			   <transport-guarantee>CONFIDENTIAL</transport-guarantee>
			</user-data-constraint>
		</security-constraint>
	```
	- ![images](./images/s-164.png)
	- `<security-constraint>`: Khá»‘i chÃ­nh Ä‘á»‹nh nghÄ©a cÃ¡c yÃªu cáº§u báº£o máº­t cho á»©ng dá»¥ng web.
	- `<web-resource-collection>`: XÃ¡c Ä‘á»‹nh tÃ i nguyÃªn nÃ o (URL nÃ o) sáº½ Ã¡p dá»¥ng báº£o máº­t.
	- `<web-resource-name>Automatic Forward to HTTPS/SSL</web-resource-name>`: TÃªn mÃ´ táº£ tÃ i nguyÃªn (chá»‰ Ä‘á»ƒ Ä‘á»c, khÃ´ng áº£nh hÆ°á»Ÿng tá»›i hoáº¡t Ä‘á»™ng).
	- `<url-pattern>/*</url-pattern>`: ToÃ n bá»™ URL cá»§a á»©ng dá»¥ng (/*) sáº½ bá»‹ Ã¡p dá»¥ng chÃ­nh sÃ¡ch HTTPS.
	- `<user-data-constraint>`: XÃ¡c Ä‘á»‹nh loáº¡i káº¿t ná»‘i mÃ  ngÆ°á»i dÃ¹ng pháº£i dÃ¹ng.
	- `<transport-guarantee>CONFIDENTIAL</transport-guarantee>`: Báº¯t buá»™c ngÆ°á»i dÃ¹ng pháº£i sá»­ dá»¥ng káº¿t ná»‘i mÃ£ hoÃ¡ (HTTPS). Khi Ä‘i qua HTTP sáº½ bá»‹ tá»± Ä‘á»™ng chuyá»ƒn hÆ°á»›ng sang HTTPS náº¿u cÃ³ cáº¥u hÃ¬nh redirectPort trong server.xml.

	- Chá»‰nh sá»­a thÃªm redirect trong server.xml 
	```
	nano /opt/tomcat/conf/server.xml 
	```
	```
		<Connector port="8080"
			   protocol="HTTP/1.1"
			   connectionTimeout="20000"
			   redirectPort="8443"  />
	```
	- ![images](./images/s-166.png)
	- Restart Tomcat
	```
	systemctl restart tomcat 
	```
	- Kiá»ƒm tra truy cáº­p http://annth.io.vn:8080 tá»± redirect sang https://annth.io.vn:8443/
	- ![images](./images/s-165.png)

- HSTS 
	- Chá»‰nh sá»­a trong file cáº¥u hÃ¬nh `web.xml`
	```
	nano /opt/tomcat/conf/web.xml 
	```
	- ThÃªm Ä‘oáº¡n sau vÃ o cuá»‘i file trÆ°á»›c tháº» </webapp>
	```
		 <filter>
			   <filter-name>httpHeaderSecurity</filter-name>
			   <filter-class>org.apache.catalina.filters.HttpHeaderSecurityFilter</filter-class>
			   <async-supported>true</async-supported>
			   <init-param>
				<param-name>hstsEnabled</param-name>
				<param-value>true</param-value>
			   </init-param>
			   <init-param>
				<param-name>hstsMaxAgeSeconds</param-name>
				<param-value>63072000</param-value>
			   </init-param>
			   <init-param>
				<param-name>hstsIncludeSubDomains</param-name>
				<param-value>true</param-value>
			   </init-param>
		 </filter>
		  
		 <!-- The mapping for the HTTP header security Filter -->
		 <filter-mapping>
			   <filter-name>httpHeaderSecurity</filter-name>
			   <url-pattern>/*</url-pattern>
			   <dispatcher>REQUEST</dispatcher>
		 </filter-mapping>
	```
	- `<filter>`: Khai bÃ¡o má»™t filter (bá»™ lá»c) Ä‘á»ƒ xá»­ lÃ½ request/response trong servlet.
	- `<filter-name>httpHeaderSecurity</filter-name>`: TÃªn Ä‘á»‹nh danh cá»§a filter nÃ y.
	- `<filter-class>org.apache.catalina.filters.HttpHeaderSecurityFilter</filter-class>`: Lá»›p filter do Tomcat cung cáº¥p Ä‘á»ƒ tá»± Ä‘á»™ng thÃªm cÃ¡c HTTP Security Headers.
	- `<async-supported>true</async-supported>`: Cho phÃ©p filter nÃ y hoáº¡t Ä‘á»™ng trong cÃ¡c request báº¥t Ä‘á»“ng bá»™ (asynchronous).
	- `<init-param>` vá»›i `hstsEnabled=true`: Báº­t header HSTS (`Strict-Transport-Security`) Ä‘á»ƒ Ã©p trÃ¬nh duyá»‡t chá»‰ dÃ¹ng HTTPS.
	- `<init-param>` vá»›i `hstsMaxAgeSeconds=63072000`: HSTS sáº½ cÃ³ hiá»‡u lá»±c trong 2 nÄƒm (63072000 giÃ¢y).
	- `<init-param>` vá»›i `hstsIncludeSubDomains=true`: HSTS cÅ©ng Ã¡p dá»¥ng cho cÃ¡c subdomain (vÃ­ dá»¥: `api.domain.com`).
	- `<filter-mapping>`: Gáº¯n filter vÃ o cÃ¡c request cá»¥ thá»ƒ.
	- `<url-pattern>/*</url-pattern>`: Ãp dá»¥ng filter cho toÃ n bá»™ URL cá»§a á»©ng dá»¥ng.
	- `<dispatcher>REQUEST</dispatcher>`: Chá»‰ Ã¡p dá»¥ng cho request chÃ­nh, khÃ´ng pháº£i forward/include/error.
	- Restart 
	```
	systemctl restart tomcat 
	```
	- Kiá»ƒm tra báº±ng trÃ¬nh duyá»‡t 
	- ![images](./images/s-168.png)

- OCSP Stapling
	- Chá»‰nh sá»­a file service enable biáº¿n mÃ´i trÆ°á»ng `tls.server.enableStatusRequestExtension`
	```
	sudo nano /etc/systemd/system/tomcat.service
	```
	- ThÃªm dÃ²ng 
	```
	Environment="JAVA_OPTS=-Djava.security.egd=file:///dev/urandom -Djdk.tls.server.enableStatusRequestExtension=true"
	```
	- ![images](./images/s-170.png)
	- Reload Daemon vÃ  restart tomcat 
	```
	systemctl daemon-reload
	systemctl restart tomcat 
	```
	- ![images](./images/s-171.png)
	- Kiá»ƒm tra báº±ng openssl 
	```
	openssl s_client -connect annth.io.vn:8443 -status 
	```
	- ![images](./images/s-169.png)
	- ![images](./images/s-172.png)

- HTTP/2
	- Chá»‰nh sá»­a upgrade protocol trong `server.xml`
	```
	nano /opt/tomcat/conf/server.xml
	```
	- ThÃªm dÃ²ng sau vÃ o cáº¥u hÃ¬nh `Connector`
	```
	<UpgradeProtocol className="org.apache.coyote.http2.Http2Protocol" />
	```
	- ![images](./images/s-176.png)
	- Restart tomcat
	```
	systemctl restart tomcat 
	```
	- Kiá»ƒm tra  
	- TrÆ°á»›c khi enable cáº¥u hÃ¬nh sá»­ dá»¥ng HTTP 1.1
	- ![images](./images/s-173.png)
	- Sau khi enable sá»­ dá»¥ng HTTP 2 
	- ![images](./images/s-174.png)
	- Sá»­ dá»¥ng `curl`
	- ![images](./images/s-175.png) 

##### Kiá»ƒm tra SSL 
- SSL Labs
- ![images](./images/s-178.png)
- SSL Checker 
- ![images](./images/s-177.png)

- Note 
	- Cáº¥u hÃ¬nh Tomcat cháº¡y trÃªn port 80/443
		- Sá»­a trong file `server.xml` táº¡i cÃ¡c Connector sá»­a thÃ nh 80 vÃ  443 
		- ![images](./images/s-179.png) 
		- VÃ¬ cÃ¡c port 80.443 lÃ  cÃ¡c privileged port nÃªn cáº§n cáº¥u hÃ¬nh service tomcat cháº¡y á»Ÿ user root 
		````
		sudo nano /etc/systemd/system/tomcat.service
		```
		- Sá»­a user vÃ  group = root 
		- ![images](./images/s-180.png)
		- Reload Daemon vÃ  Tomcat 
		```
		systemctl daemon-reload
		systemctl restart tomcat
		netstat -tlnp 
		```
		- ![images](./images/s-181.png) 

		- CÃ³ thá»ƒ khÃ´ng cáº¥u hÃ¬nh Ä‘á»•i port trong tomcat sá»­ dá»¥ng iptables Ä‘á»ƒ map port
		```
		iptables -A PREROUTING -t nat -i eth0 -p tcp --dport 443 -j REDIRECT --to-port 8443
		iptables -A PREROUTING -t nat -i eth0 -p tcp --dport 80 -j REDIRECT --to-port 8080
		```
#### 12.2.4 IIS 
##### Khá»Ÿi táº¡o IIS, CSR 
- Cáº¥u hÃ¬nh trÃªn Windows Server 2022 Ä‘Ã£ báº­t feature IIS 
- ![images](./images/s-183.png) 

- Táº¡o sites `annth.io.vn` 
	- Trong IIS táº¡o site má»›i 
	- ![images](./images/s-187.png) 
	- Cáº¥u hÃ¬nh hostname, thÆ° má»¥c lÆ°u trá»¯, port bind 
	- ![images](./images/s-188.png) 
	- Web trÃªn port80 
	- ![images](./images/s-189.png) 

- Sinh CSR sá»­ dá»¥ng IIS 
	- Má»Ÿ IIS Manager 
	- á» panel giá»¯a, báº¥m Ä‘Ãºp vÃ o Server Certificates
	- ![images](./images/s-190.png) 
	- á» panel bÃªn pháº£i (Actions), chá»n Create Certificate Request
	- ![images](./images/s-191.png) 
	- Äiá»n thÃ´ng tin doanh nghiá»‡p:
		- Common name: tÃªn miá»n (vÃ­ dá»¥: example.com)
		- Organization: tÃªn cÃ´ng ty
		- Organizational unit: bá»™ pháº­n (vÃ­ dá»¥: IT)
		- City/State/Country: thÃ´ng tin Ä‘á»‹a lÃ½
	- ![images](./images/s-192.png) 
	- Báº¥m Next, chá»n:
		- Cryptographic provider: Microsoft RSA SChannel
		- Bit length: 2048 (hoáº·c cao hÆ¡n náº¿u cáº§n)
	- ![images](./images/s-193.png) 
	- Báº¥m Next, chá»n Ä‘Æ°á»ng dáº«n lÆ°u file .req (vÃ­ dá»¥: C:\certs\mycsr.req)
	- Báº¥m Finish
	- ![images](./images/s-194.png) 
	- CÃ³ thá»ƒ sá»­ dá»¥ng CSR nÃ y Ä‘á»ƒ xin CA cáº¥p chá»©ng chá»‰ 

##### Cáº¥u hÃ¬nh SSL 
- Self Signed 
	- Táº¡o chá»©ng chá»‰ tá»± kÃ½
		- Má»Ÿ IIS 
		- á» panel giá»¯a, nháº¥p Ä‘Ãºp vÃ o Server Certificates
		- ![images](./images/s-190.png) 
		- á» panel bÃªn pháº£i (Actions), chá»n Create Self-Signed Certificate
		- ![images](./images/s-195.png) 
		- Nháº­p:
			- Friendly name: tÃªn dá»… nhá»› cho chá»©ng chá»‰ (vÃ­ dá»¥: MyLocalCert)
			- Personal lÃ  store máº·c Ä‘á»‹nh â†’ giá»¯ nguyÃªn
		- ![images](./images/s-196.png) 
		- Nháº¥n OK
		- Chá»©ng chá»‰ Ä‘Æ°á»£c táº¡o 
		- ![images](./images/s-197.png) 

	- GÃ¡n chá»©ng chá»‰ cho website
		- Trong IIS, má»Ÿ má»¥c Sites â†’ chá»n website cáº§n cáº¥u hÃ¬nh 
		- á» panel bÃªn pháº£i, chá»n Bindings
		- ![images](./images/s-198.png) 
		- Nháº¥n Add â†’ chá»n:
		- Type: https
		- IP address: All Unassigned hoáº·c IP cá»¥ thá»ƒ
		- Port: 443
		- SSL certificate: chá»n chá»©ng chá»‰ vá»«a táº¡o
		- Nháº¥n OK â†’ Close
		- ![images](./images/s-199.png) 
	- Kiá»ƒm tra: Sá»­ dá»¥ng trÃ¬nh duyá»‡t truy cáº­p https://annth.io.vn
	- ![images](./images/s-200.png) 

- ZeroSSL 
	- IIS chá»‰ há»— trá»£ Ä‘á»‹nh dáº¡ng pfx. Cáº§n chuyá»ƒn Ä‘á»•i sang Ä‘Ãºng Ä‘á»‹nh dáº¡ng sá»­ dá»¥ng openssl 
	- CÃ i Ä‘áº·t openssl 
		- Truy cáº­p https://slproweb.com/products/Win32OpenSSL.html
		- Táº£i xuá»‘ng vÃ  cÃ i Ä‘áº·t 
		- ![images](./images/s-201.png) 
		- ![images](./images/s-202.png)
		- ThÃªm biáº¿n mÃ´i trÆ°á»ng 
		- ![images](./images/s-203.png) 
	- Gá»™p cÃ¡c file cá»§a chá»©ng chá»‰ 
		- CÃ¡c file private key, cerrtificate vÃ  ca_bundle 
		- ![images](./images/s-204.png) 
		- Sá»­ dá»¥ng lá»‡nh openssl 
		```
		openssl pkcs12 -export -out domain.name.pfx -inkey domain.name.key -in domain.name.crt -in intermediate.crt -in rootca.crt
		```
		Cá»¥ thá»ƒ 
		```
		openssl pkcs12 -export -out annth.io.vn.pfx -inkey annth.key -in certificate.crt 
		```
		Khi khá»Ÿi cháº¡y sáº½ Ä‘Æ°á»£c yÃªu cáº§u nháº­p máº­t kháº©u Ä‘á»ƒ báº£o vá»‡ file .pfx. HÃ£y nhá»› máº­t kháº©u nÃ y Ä‘á»ƒ dÃ¹ng khi import vÃ o IIS
		- ![images](./images/s-205.png) 
	- Import vÃ o IIS 
		- Má»Ÿ IIS Manager (inetmgr)
		- Chá»n tÃªn server (bÃªn trÃ¡i) â†’ má»Ÿ Server Certificates
		- ![images](./images/s-190.png) 
		- á» panel bÃªn pháº£i, chá»n Import
		- ![images](./images/s-206.png) 
		- Chá»n file annth.io.vn.pfx vá»«a táº¡o vÃ  nháº­p máº­t kháº©u
		- ![images](./images/s-207.png) 
		- Nháº¥n OK â†’ chá»©ng chá»‰ sáº½ xuáº¥t hiá»‡n trong danh sÃ¡ch
		- ![images](./images/s-208.png) 
	- GÃ¡n chá»©ng chá»‰ cho website
		- Trong IIS, má»Ÿ má»¥c Sites â†’ chá»n website cáº§n cáº¥u hÃ¬nh 
		- á» panel bÃªn pháº£i, chá»n Bindings
		- ![images](./images/s-198.png) 
		- Chá»n pháº§n https vÃ  chá»n Edit 
		- ![images](./images/s-209.png) 
		- Má»¥c SSL chá»n chá»©ng chá»‰ má»›i Import
		- ![images](./images/s-210.png) 
	- Kiá»ƒm tra: Sá»­ dá»¥ng trÃ¬nh duyá»‡t truy cáº­p https://annth.io.vn
	- ![images](./images/s-211.png) 
	
##### Cáº¥u hÃ¬nh HTTP Redirect, HSTS, OCSP Stapling, HTTP/2 
- HTTP Redirect vÃ  HSTS 
	- Má»Ÿ IIS Manager (inetmgr)
	- Trong khung Connections, chá»n website báº¡n muá»‘n cáº¥u hÃ¬nh
	- á» khung Actions bÃªn pháº£i, tÃ¬m má»¥c Configure, chá»n HSTS
	- ![images](./images/s-212.png) 
	- Cá»­a sá»• Edit Website HSTS sáº½ hiá»‡n ra: Chá»n 
		- Enable â†’ Ä‘á»ƒ báº­t HSTS
		- Redirect HTTP to HTTPS â†’ Ä‘á»ƒ IIS tá»± chuyá»ƒn hÆ°á»›ng ngÆ°á»i dÃ¹ng tá»« HTTP sang HTTPS
		- Nháº¥n OK Ä‘á»ƒ lÆ°u cáº¥u hÃ¬nh
	- ![images](./images/s-213.png) 
	- Kiá»ƒm tra 
	- Sá»­ dá»¥ng curl vá»›i http bÃ¡o document move 
	- ![images](./images/s-215.png) 
	- Sá»­ dá»¥ng trÃ¬nh duyá»‡t kiá»ƒm tra Ä‘Ã£ cÃ³ Header HSTS 
	- ![images](./images/s-214.png) 
- OCSP Stapling vÃ  HTTP/2 máº·c Ä‘á»‹nh Ä‘Ã£ Ä‘Æ°á»£c IIS báº­t khi website cÃ³ SSL 
	- Kiá»ƒm tra báº±ng lá»‡nh openssl 
	```
	openssl s_client -connect annth.io.vn:443 -status 
	```
	- ![images](./images/s-216.png) 
	- Sá»­ dá»¥ng trÃ¬nh duyá»‡t protocol nháº­n http/2 
	- ![images](./images/s-217.png) 

### 12.3 Web Hosting Manager 

#### 12.3.1 Plesk 
- ÄÄƒng kÃ½ free trial vÃ  quÃ¡ trÃ¬nh cÃ i Ä‘áº·t 
- Truy cáº­p [Try Plesk for FREE on Your Server](https://www.plesk.com/plesk-free-download/)
- Äiá»n thÃ´ng tin Ä‘Äƒng kÃ½ 
- ![images](./images/s-218.png) 
- XÃ¡c nháº­n Email 
- ![images](./images/s-219.png) 

- 2 CÃ¡ch cÃ i Ä‘áº·t 
	- Tá»± Ä‘á»™ng thÃ´ng qua Plesk 360 
		- Truy cáº­p [Plesk Web Installer](https://get.plesk.com/)
		- Cáº¥u hÃ¬nh thÃ´ng tin mÃ¡y chá»§ cáº§n cÃ i Ä‘áº·t 
		- ![images](./images/s-221.png) 
		- Táº¡o tÃ i khoáº£n plesk 360 
		- ![images](./images/s-222.png) 
		- ![images](./images/s-223.png) 
		- ![images](./images/s-224.png) 
		- QÃºa trÃ¬nh cÃ i Ä‘áº·t Plesk Trial Ä‘ang diá»…n ra 
		- ![images](./images/s-225.png) 
		- ![images](./images/s-226.png) 
	- TrÃªn server cáº§n cháº¡y lá»‡nh cÃ i Ä‘áº·t 
	```
	sh <(curl https://autoinstall.plesk.com/one-click-installer || wget -O - https://autoinstall.plesk.com/one-click-installer)
	```
	- ![images](./images/s-228.png) 
	- QuÃ¡ trÃ¬nh cÃ i Ä‘áº·t diá»…n ra tá»± Ä‘á»™ng 
	- ![images](./images/s-229.png) 
	- CÃ i Ä‘áº·t thÃ nh cÃ´ng 
	- ![images](./images/s-230.png) 
	- Truy cáº­p trang quáº£n trá»‹, cáº¥u hÃ¬nh tÃ i khoáº£n admin 
	- ![images](./images/s-231.png) 
	- Plesk Ä‘ang Ä‘Æ°á»£c khá»Ÿi táº¡o 
	- ![images](./images/s-232.png) 
	- Giao diá»‡n Plesk 
	- ![images](./images/s-233.png) 
	
- Thao tÃ¡c cáº¥u hÃ¬nh cÆ¡ báº£n 
	- Táº¡o service plan 
		- Chuyá»ƒn sang view quáº£n trá»‹. Táº¡i pháº§n `ChangeView` chá»n `Switch to Service Provider View`
		- ![images](./images/s-238.png) 
		- Giao diá»‡n `Service Provider`
		- ![images](./images/s-239.png) 
		- Táº¡i giao diá»‡n quáº£n lÃ½ Plesk, chá»n má»¥c Service Plans sau Ä‘Ã³ chá»n Add New Plan
		- ![images](./images/s-240.png) 
		- Tiáº¿p theo Ä‘iá»n cÃ¡c thÃ´ng tin cáº§n thiáº¿t Ä‘á»ƒ táº¡o má»›i má»™t Plan nhÆ°:
			- Service plan name: tÃªn hiá»ƒn thá»‹ cá»§a Plan cáº§n táº¡o
			- Disk space: Dung lÆ°á»£ng cho Plan
			- Notify when disk space usage reaches: ThÃ´ng bÃ¡o khi Ä‘áº¡t ngÆ°á»¡ng dung lÆ°á»£ng
			- Traffic: BÄƒng thÃ´ng trong má»™t thÃ¡ng
			- Notify when traffic usage reaches: ThÃ´ng bÃ¡o khi Ä‘áº¡t ngÆ°á»¡ng bÄƒng thÃ´ng
			- Domains/Subdomains: Sá»‘ lÆ°á»£ng Domain chÃ­nh vÃ  Sub Domain
			- Mailboxes/Mailbox size/Total mailboxes quota/Mailing lists: Sá»‘ lÆ°á»£ng há»™p thÆ° mail, dung lÆ°á»£ng cáº¥p cho má»—i mailbox cá»§a subscription (dÃ¹ng Ä‘á»ƒ lÆ°u trá»¯ email vÃ  cÃ¡c file Ä‘Ã­nh kÃ¨m), tá»•ng dung lÆ°á»£ng lÆ°u trá»¯ cá»§a cÃ¡c há»™p thÆ° cá»§a subscription vÃ  tá»•ng sá»‘ danh sÃ¡ch mail mÃ  subscription cÃ³ thá»ƒ lÆ°u trá»¯.
			- Additional FTP accounts: Sá»‘ lÆ°á»£ng tá»‘i Ä‘a tÃ i khoáº£n FTP Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ truy cáº­p file vÃ  cÃ¡c thÆ° má»¥c Ä‘Æ°á»£c táº¡o trong subscription.
			- MySQL database/MS SQL database: Sá»‘ lÆ°á»£ng cÆ¡ sá»Ÿ dá»¯ liá»‡u tá»‘i Ä‘a Ä‘Æ°á»£c táº¡o trong Plesk server
			- Total MySQL databases quota/Total MS SQL databases quota: Dung lÆ°á»£ng tá»‘i Ä‘a cá»§a MySQL/ MS SQL
			- MS SQL database file size: Dung lÆ°á»£ng tá»‘i Ä‘a cá»§a file database
			- MS SQL database log file size: Dung lÆ°á»£ng tá»‘i Ä‘a cá»§a file log
			- Expiration date: Thá»i háº¡n cá»§a Plan
			- NgoÃ i ra cÃ²n cÃ¡c cáº¥u hÃ¬nh khÃ¡c vá» `Permissions`, `Hosting Parameters`, `PHP Settings`, `Webserver`, `Mail`, `Logs & Statastics`, `Applications`, `Additional Services`
		- ![images](./images/s-241.png) 
		- ![images](./images/s-242.png) 
		- ![images](./images/s-243.png) 
		- ![images](./images/s-244.png) 
		- ![images](./images/s-245.png) 
		- ![images](./images/s-246.png) 
		- ![images](./images/s-247.png) 
		- ![images](./images/s-248.png) 
		- ![images](./images/s-249.png) 
		- ![images](./images/s-250.png) 
		- Sau khi Ä‘iá»n Ä‘áº§y Ä‘á»§ thÃ´ng tin, Click OK Ä‘á»ƒ tiáº¿n hÃ nh táº¡o má»›i Plan.
		- ![images](./images/s-251.png) 

	- Táº¡o reseller 
		- Resellers lÃ  nhá»¯ng Ä‘á»‘i tÆ°á»£ng khÃ¡ch hÃ ng Ä‘áº¡i lÃ½, Ä‘á»ƒ thá»±c hiá»‡n táº¡o má»›i Resellers vÃ o má»¥c Resellers vÃ  chá»n Add Reseller
		- ![images](./images/s-252.png) 
		- Äiá»n Ä‘áº§y Ä‘á»§ cÃ¡c thÃ´ng tin cáº§n thiáº¿t cho Reseller nhÆ°:
		- Contact Information: gá»“m nhá»¯ng thÃ´ng tin cá»§a Reseller cáº§n táº¡o.
		- Access to Plesk: ThÃ´ng tin User vÃ  Password Ä‘á»ƒ Reseller Ä‘Äƒng nháº­p vÃ o trang quáº£n lÃ½ Plesk.
		- ![images](./images/s-253.png) 
		- ![images](./images/s-254.png) 
		- Sau khi Ä‘iá»n Ä‘áº§y Ä‘á»§ cÃ¡c thÃ´ng tin trÃªn, Click OK Ä‘á»ƒ tiáº¿n hÃ nh táº¡o má»›i Reseller. 
		- ![images](./images/s-255.png) 

	- Táº¡o customer 
		- Customer lÃ  nhÃ³m khÃ¡ch hÃ ng dÃ nh cho nhá»¯ng khÃ¡ch hÃ ng láº», Ä‘á»ƒ thá»±c hiá»‡n táº¡o má»›i Customer vÃ o má»¥c Customers vÃ  chá»n Add New Customer 
		- ![images](./images/s-256.png) 
		- Viá»‡c táº¡o má»›i Customer cÅ©ng tÆ°Æ¡ng tá»± vá»›i Reseller, Ä‘iá»n Ä‘áº§y Ä‘á»§ cÃ¡c thÃ´ng tin nhÆ° sau:
		- Contact Information: thÃ´ng tin liÃªn láº¡c cá»§a khÃ¡ch hÃ ng Customer
		- Access to Plesk: ThÃ´ng tin User vÃ  Password Ä‘Äƒng nháº­p trang quáº£n lÃ½ Plesk.
		- Subscription:
		- Domain name: tÃªn domain chÃ­nh cá»§a khÃ¡ch hÃ ng.
		- Service plan: táº¡i pháº§n nÃ y cÃ³ thá»ƒ choose Customer vÃ o 1 Plan nÃ o Ä‘Ã³ Ä‘Ã£ táº¡o trÆ°á»›c Ä‘á»ƒ dá»… dÃ ng quáº£n lÃ½ (á» Ä‘Ã¢y chá»n service Test Ä‘Ã£ táº¡o)
		- User vÃ  Password trong tab nÃ y dÃ¹ng Ä‘á»ƒ Ä‘Äƒng nháº­p khi Customer cáº§n FTP vÃ o hosting cá»§a há».
		- ![images](./images/s-257.png) 
		- ![images](./images/s-258.png) 

- ÄÄƒng nháº­p Web hosting manager 
- ![images](./images/s-259.png) 
- ![images](./images/s-260.png) 

- Cáº¥u hÃ¬nh SSL 
	- Táº¡i pháº§n `Websites & Domains` chá»n `SSL/TLS Certificates`
	- ![images](./images/s-261.png) 
	- Táº¡i Ä‘Ã¢y Plesk cung cáº¥p 3 lá»±a chá»n, sá»­ dá»¥ng let's encypt ssl, táº£i lÃªn chá»©ng chá»‰ cÃ³ sáºµn, táº£i vá» chá»©ng chá»‰ Ä‘Ã£ thÃªm 
	- ![images](./images/s-262.png) 
	- Táº¡i Ä‘Ã¢y chá»n táº£i lÃªn chá»©ng chá»‰ cÃ³ sáºµn, chá»©ng chá»‰ cáº¥p tá»« ZeroSSL gá»“m 3 file privatekey, certificate vÃ  Certificate Chain. Äá»ƒ upload chá»©ng chá»‰ lÃªn Plesk cáº§n gá»™p 3 chá»©ng chá»‰ thÃ nh 1 file full-chain.pem 
	- ![images](./images/s-263.png) 
	- Sá»­ dá»¥ng lá»‡nh sau Ä‘á»ƒ gá»™p vÃ  táº¡o file `fullchain.pem`
		- Windows 
		```
		type annth.key certificate.crt ca_bundle.crt > fullchain.pem
		```
		- Linux 
		```
		cat private.key certificate.crt ca_bundle.crt > fullchain.pem
		```
	- ![images](./images/s-264.png) 
	- Upload file lÃªn Plesk thÃ´ng bÃ¡o Ä‘Ã£ import thÃ nh cÃ´ng 
	- ![images](./images/s-265.png) 
- Enable cÃ¡c tÃ­nh nÄƒng HTTP redirect, HSTS, OSCP Stapling, HTTP/2	
	- Truy cáº­p pháº§n cáº¥u hÃ¬nh SSL vÃ  báº­t cÃ¡c tÃ­nh nÄƒng 
	- ![images](./images/s-266.png) 
	- Cáº¥u hÃ¬nh vá»›i HSTS 
	- ![images](./images/s-267.png) 
	- Báº­t cÃ¡c tÃ­nh nÄƒng cÃ²n láº¡i 
	- ![images](./images/s-268.png) 
- Kiá»ƒm tra 
	- Truy cáº­p tÃªn miá»n cÃ³ sssl 
	- ![images](./images/s-269.png) 
	- SSL Labs 
	- ![images](./images/s-270.png) 
	- HTTP Redirect
	- ![images](./images/s-271.png) 
	- HSTS 
	- ![images](./images/s-274.png) 
	- OSCP Stapling
	- ![images](./images/s-273.png) 
	- HTTP/2 
	- ![images](./images/s-272.png) 


#### 12.3.2 DirectAdmin 
- ÄÄƒng kÃ½ free trial 30days 
	- Truy cáº­p trang chá»§ [DirectAdmin](https://www.directadmin.com/features_list.php)
	- Chá»n `Oder Now`
	- ![images](./images/s-275.png) 
	- ÄÄƒng kÃ½ tÃ i khoáº£n 
	- ![images](./images/s-276.png) 
	- ![images](./images/s-277.png) 
	- ![images](./images/s-278.png) 
	- Nháº­n user/pass táº¡i mail 
	- ![images](./images/s-279.png) 
	- ÄÄƒng nháº­p táº¡i trang client cá»§a DirectAdmin
	- ![images](./images/s-280.png) 
	- Táº¡o license má»›i, cáº¥u hÃ¬nh cÃ¡c thÃ´ng tin, áº¥n proceed 1 láº§n rá»“i back láº¡i lÃºc nÃ y license Ä‘Æ°á»£c táº¡o nhÆ°ng chÆ°a kÃ­ch hoáº¡t.
	- ![images](./images/s-281.png) 
	- ![images](./images/s-282.png) 
	- ![images](./images/s-283.png) 
	- Thá»±c hiá»‡n táº¡o ticket xin support kÃ­ch hoáº¡t gÃ³i free trial
	- ![images](./images/s-284.png) 
	- ![images](./images/s-286.png) 
	- ![images](./images/s-287.png) 

- Cháº¡y lá»‡nh cÃ i Ä‘áº·t kÃ¨m license key 
```
bash <(curl -fsSL https://download.directadmin.com/setup.sh) 'Provided license key should go here'
```
- HoÃ n táº¥t cÃ i Ä‘áº·t sá»­ dá»¥ng tÃ i khoáº£n admin Ä‘Æ°á»£c cáº¥p truy cáº­p web quáº£n trá»‹ admin táº¡i http://server.ip.address:2222
- ![images](./images/s-331.png) 
- ![images](./images/s-332.png) 
- ![images](./images/s-333.png) 

- CÃ¡c cáº¥u hÃ¬nh quáº£n trá»‹ cÆ¡ báº£n 
	- Táº¡o reseller package 
		- Táº¡i DirectAdmin Admin Level -> Manage Reseller Pakages 
		- ![images](./images/s-334.png) 
		- Chá»n Add Package Ä‘á»ƒ táº¡o gÃ³i má»›i 
		- ![images](./images/s-335.png) 
		- Táº¡i Ä‘Ã¢y cáº¥u hÃ¬nh cÃ¡c thÃ´ng sá»‘ cho gÃ³i reseller
			- Giá»›i háº¡n tÃ i nguyÃªn 

			| Cáº¥u hÃ¬nh            | Giáº£i thÃ­ch                                                                                 |
			| ------------------- | ------------------------------------------------------------------------------------------ |
			| **Bandwidth (MB)**  | LÆ°á»£ng dá»¯ liá»‡u tá»‘i Ä‘a mÃ  cÃ¡c tÃ i khoáº£n con cÃ³ thá»ƒ sá»­ dá»¥ng má»—i thÃ¡ng. VÃ­ dá»¥: 5000 MB = 5 GB. |
			| **Disk Space (MB)** | Dung lÆ°á»£ng á»• Ä‘Ä©a Ä‘Æ°á»£c cáº¥p phÃ¡t cho toÃ n bá»™ tÃ i khoáº£n con. 1000 MB = 1 GB.                  |
			| **Inodes**          | Sá»‘ lÆ°á»£ng tá»‡p vÃ  thÆ° má»¥c tá»‘i Ä‘a Ä‘Æ°á»£c phÃ©p. 0 = khÃ´ng giá»›i háº¡n.                              |
			| **Domains**         | Sá»‘ lÆ°á»£ng tÃªn miá»n chÃ­nh mÃ  Ä‘áº¡i lÃ½ cÃ³ thá»ƒ táº¡o cho khÃ¡ch hÃ ng.                               |
			| **Sub-Domains**     | Sá»‘ lÆ°á»£ng tÃªn miá»n phá»¥ (vÃ­ dá»¥: blog.tenmien.com).                                           |
			| **User Accounts**   | Sá»‘ lÆ°á»£ng tÃ i khoáº£n ngÆ°á»i dÃ¹ng mÃ  Ä‘áº¡i lÃ½ cÃ³ thá»ƒ táº¡o. 0 = khÃ´ng giá»›i háº¡n.                    |
			| **IPs**             | Sá»‘ Ä‘á»‹a chá»‰ IP riÃªng mÃ  Ä‘áº¡i lÃ½ cÃ³ thá»ƒ sá»­ dá»¥ng.                                              |
			| **Email Accounts**  | Tá»•ng sá»‘ tÃ i khoáº£n email Ä‘Æ°á»£c phÃ©p táº¡o.                                                     |
			| **Forwarders**      | Sá»‘ lÆ°á»£ng Ä‘á»‹a chá»‰ email chuyá»ƒn tiáº¿p (forward) Ä‘Æ°á»£c phÃ©p.                                    |
			| **Mailing Lists**   | Sá»‘ lÆ°á»£ng danh sÃ¡ch gá»­i thÆ° (mailing list) Ä‘Æ°á»£c phÃ©p táº¡o.                                   |
			| **Autoresponders**  | Sá»‘ lÆ°á»£ng email tráº£ lá»i tá»± Ä‘á»™ng Ä‘Æ°á»£c phÃ©p thiáº¿t láº­p.                                        |
			| **MySQL Databases** | Sá»‘ lÆ°á»£ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL Ä‘Æ°á»£c phÃ©p táº¡o. 0 = khÃ´ng giá»›i háº¡n.                            |
			| **Domain Pointers** | Sá»‘ lÆ°á»£ng tÃªn miá»n trá» vá» má»™t website chÃ­nh.                                                |
			| **FTP Accounts**    | Sá»‘ lÆ°á»£ng tÃ i khoáº£n FTP Ä‘Æ°á»£c phÃ©p táº¡o Ä‘á»ƒ táº£i lÃªn/táº£i xuá»‘ng dá»¯ liá»‡u.                         |

			- Cáº¥u hÃ¬nh tÃ­nh nÄƒng, quyá»n truy cáº­p 

			| TÃ­nh nÄƒng                | Giáº£i thÃ­ch                                                                                              |
			| ------------------------ | ------------------------------------------------------------------------------------------------------- |
			| **CGI Access**           | Cho phÃ©p cháº¡y cÃ¡c script CGI (thÆ°á»ng dÃ¹ng cho cÃ¡c á»©ng dá»¥ng web cÅ©).                                     |
			| **PHP Access**           | Cho phÃ©p cháº¡y mÃ£ PHP trÃªn website.                                                                      |
			| **SpamAssassin**         | Bá»™ lá»c thÆ° rÃ¡c giÃºp giáº£m email khÃ´ng mong muá»‘n.                                                         |
			| **SSL Access**           | Cho phÃ©p cÃ i Ä‘áº·t chá»©ng chá»‰ SSL (HTTPS) cho website.                                                     |
			| **SSH Access**           | Truy cáº­p dÃ²ng lá»‡nh mÃ¡y chá»§ qua SSH (dÃ nh cho ngÆ°á»i dÃ¹ng nÃ¢ng cao).                                      |
			| **Overselling**          | Cho phÃ©p Ä‘áº¡i lÃ½ bÃ¡n vÆ°á»£t giá»›i háº¡n tÃ i nguyÃªn Ä‘Æ°á»£c cáº¥p (vÃ­ dá»¥: chia nhá» 1000MB thÃ nh nhiá»u gÃ³i nhá» hÆ¡n). |
			| **Cron Jobs**            | Thiáº¿t láº­p cÃ¡c tÃ¡c vá»¥ tá»± Ä‘á»™ng cháº¡y theo lá»‹ch (vÃ­ dá»¥: sao lÆ°u dá»¯ liá»‡u má»—i ngÃ y).                          |
			| **System Info**          | Xem thÃ´ng tin há»‡ thá»‘ng nhÆ° CPU, RAM, dung lÆ°á»£ng á»• Ä‘Ä©a.                                                  |
			| **Login Keys**           | Táº¡o khÃ³a Ä‘Äƒng nháº­p tá»± Ä‘á»™ng mÃ  khÃ´ng cáº§n máº­t kháº©u.                                                       |
			| **DNS Control**          | Cho phÃ©p Ä‘áº¡i lÃ½ vÃ  ngÆ°á»i dÃ¹ng chá»‰nh sá»­a báº£n ghi DNS.                                                    |
			| **Share Server IP**      | Cho phÃ©p cÃ¡c tÃ i khoáº£n chia sáº» cÃ¹ng má»™t Ä‘á»‹a chá»‰ IP mÃ¡y chá»§.                                             |
			| **Anonymous FTP**        | Cho phÃ©p ngÆ°á»i dÃ¹ng táº£i lÃªn/táº£i xuá»‘ng qua FTP mÃ  khÃ´ng cáº§n tÃ i khoáº£n (khÃ´ng báº­t vÃ¬ lÃ½ do báº£o máº­t).      |
			| **Catch-All Email**      | Nháº­n táº¥t cáº£ email gá»­i Ä‘áº¿n tÃªn miá»n, ká»ƒ cáº£ Ä‘á»‹a chá»‰ khÃ´ng tá»“n táº¡i (thÆ°á»ng bá»‹ táº¯t Ä‘á»ƒ trÃ¡nh spam).          |
			| **SSH Access for Users** | Cho phÃ©p ngÆ°á»i dÃ¹ng cuá»‘i truy cáº­p SSH (thÆ°á»ng bá»‹ táº¯t Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n).                               |
			| **Personal DNS (3 IPs)** | Cho phÃ©p Ä‘áº¡i lÃ½ sá»­ dá»¥ng DNS riÃªng vá»›i 3 Ä‘á»‹a chá»‰ IP (vÃ­ dá»¥: ns1.tenmien.com).                            |

		- Äáº·t tÃªn lÃ  `reseler_package_1` vÃ  lÆ°u láº¡i 
		- ![images](./images/s-336.png) 

	- Táº¡o Reseller 
		- Táº¡o giao diá»‡n quáº£n trá»‹ -> `Create Reseller`
		- ![images](./images/s-337.png) 
		- Táº¡i Ä‘Ã¢y cáº¥u hÃ¬nh cÃ¡c thÃ´ng sá»‘ 
		- ThÃ´ng tin tÃ i khoáº£n
			- Username: TÃªn Ä‘Äƒng nháº­p cá»§a tÃ i khoáº£n Ä‘áº¡i lÃ½.
			- E-Mail: Äá»‹a chá»‰ email quáº£n trá»‹.
			- Password: Máº­t kháº©u Ä‘Äƒng nháº­p (nháº­p hai láº§n Ä‘á»ƒ xÃ¡c nháº­n).
			- Domain: TÃªn miá»n chÃ­nh gÃ¡n cho tÃ i khoáº£n Ä‘áº¡i lÃ½.
		- Cáº¥u hÃ¬nh gÃ³i vÃ  IP
			- Use Reseller Package: Chá»n gÃ³i Ä‘áº¡i lÃ½ Ä‘Ã£ táº¡o sáºµn (vÃ­ dá»¥: reseler_package_1).
			- Account IP: Chá»n loáº¡i IP cho tÃ i khoáº£n (Shared - dÃ¹ng chung IP mÃ¡y chá»§).
		- ThÃ´ng bÃ¡o qua email
			- Send Email Notification: Gá»­i email thÃ´ng bÃ¡o khi táº¡o tÃ i khoáº£n.
			- Edit Reseller Message: Cho phÃ©p chá»‰nh sá»­a ná»™i dung email gá»­i Ä‘i.
		- TÃ¹y chá»n khÃ¡c: Customize: Tá»± cáº¥u hÃ¬nh giá»›i háº¡n náº¿u khÃ´ng dÃ¹ng gÃ³i cÃ³ sáºµn.
		- ![images](./images/s-338.png) 
		- Reseller Ä‘Æ°á»£c táº¡o 
		- ![images](./images/s-339.png) 

- Táº¡o User
	- Táº¡o gÃ³i user 
		- ÄÄƒng nháº­p vÃ o tÃ i khoáº£n reseller vá»«a táº¡o 
		- ![images](./images/s-340.png) 
		- ![images](./images/s-341.png) 
		- Chá»n `Manage User Packages`
		- ![images](./images/s-342.png) 
		- Chá»n `Add package` Ä‘á»ƒ thÃªm gÃ³i user má»›i 
		- ![images](./images/s-343.png) 
		- Táº¡i Ä‘Ã¢y cáº¥u hÃ¬nh cÃ¡c thÃ´ng sá»‘ 
		- TÃ i nguyÃªn há»‡ thá»‘ng
			- Bandwidth (MB): 1000 â€“ BÄƒng thÃ´ng tá»‘i Ä‘a má»—i thÃ¡ng (1 GB).
			- Disk Space (MB): 100 â€“ Dung lÆ°á»£ng á»• Ä‘Ä©a (100 MB).
			- Inodes: Unlimited â€“ KhÃ´ng giá»›i háº¡n sá»‘ lÆ°á»£ng tá»‡p vÃ  thÆ° má»¥c.
		- TÃªn miá»n vÃ  tÃ i khoáº£n
			- Domains: 1 â€“ Chá»‰ Ä‘Æ°á»£c táº¡o 1 tÃªn miá»n chÃ­nh.
			- Sub-Domains: 10 â€“ Tá»‘i Ä‘a 10 tÃªn miá»n phá»¥.
			- Domain Pointers: 0 â€“ KhÃ´ng cho phÃ©p trá» thÃªm tÃªn miá»n phá»¥ trá»£.
		- Email
			- Email Accounts: 10 â€“ Tá»‘i Ä‘a 10 tÃ i khoáº£n email.
			- Email Forwarders: 0 â€“ KhÃ´ng cho phÃ©p chuyá»ƒn tiáº¿p email.
			- Mailing Lists: 0 â€“ KhÃ´ng há»— trá»£ danh sÃ¡ch gá»­i thÆ°.
			- AutoResponders: 10 â€“ Tá»‘i Ä‘a 10 email tráº£ lá»i tá»± Ä‘á»™ng.
		- CÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  FTP
			- MySQL Databases: 5 â€“ Tá»‘i Ä‘a 5 cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL.
			- FTP Accounts: 1 â€“ Chá»‰ Ä‘Æ°á»£c táº¡o 1 tÃ i khoáº£n FTP.
		- TÃ­nh nÄƒng vÃ  quyá»n truy cáº­p
			- CGI Access: Disabled â€“ KhÃ´ng cho phÃ©p cháº¡y CGI scripts.
			- PHP Access: Enabled â€“ Cho phÃ©p cháº¡y mÃ£ PHP.
			- SpamAssassin: Enabled â€“ Báº­t bá»™ lá»c thÆ° rÃ¡c.
			- SSL Access: Enabled â€“ Há»— trá»£ chá»©ng chá»‰ SSL (HTTPS).
			- Cron Jobs: Enabled â€“ Cho phÃ©p thiáº¿t láº­p tÃ¡c vá»¥ Ä‘á»‹nh ká»³.
			- System Info: Enabled â€“ Cho phÃ©p xem thÃ´ng tin há»‡ thá»‘ng.
			- Login Keys: Enabled â€“ Há»— trá»£ Ä‘Äƒng nháº­p báº±ng khÃ³a báº£o máº­t.
			- DNS Control: Enabled â€“ Cho phÃ©p chá»‰nh sá»­a báº£n ghi DNS.
		- KhÃ¡c
			- Suspend At Limit: Enabled â€“ Tá»± Ä‘á»™ng khÃ³a tÃ i khoáº£n náº¿u vÆ°á»£t giá»›i háº¡n.
			- Skin: Enhanced â€“ Giao diá»‡n ngÆ°á»i dÃ¹ng sá»­ dá»¥ng skin â€œEnhancedâ€.
			- Language: en â€“ NgÃ´n ngá»¯ giao diá»‡n lÃ  tiáº¿ng Anh.
		- Äáº·t tÃªn cho gÃ³i vÃ  save 
		- ![images](./images/s-344.png) 
		- ![images](./images/s-345.png) 
	- Táº¡o User 
		- Táº¡i giao diá»‡n quáº£n trá»‹ chá»n `Add new user`
		- ![images](./images/s-346.png) 
		- Cáº¥u hÃ¬nh cÃ¡c thÃ´ng sá»‘ 
		- ThÃ´ng tin tÃ i khoáº£n
			- Username: customer1 â€“ TÃªn Ä‘Äƒng nháº­p cá»§a ngÆ°á»i dÃ¹ng.
			- E-Mail: customer1@gmail.com â€“ Email quáº£n trá»‹, dÃ¹ng Ä‘á»ƒ nháº­n thÃ´ng bÃ¡o.
			- Password / Re-Enter Password: Máº­t kháº©u Ä‘Äƒng nháº­p (áº©n báº±ng dáº¥u * Ä‘á»ƒ báº£o máº­t).
			- Domain: annth.io.vn â€“ TÃªn miá»n chÃ­nh gÃ¡n cho tÃ i khoáº£n nÃ y.
		- GÃ³i vÃ  IP
			- User Package: Chá»n gÃ³i tÃ i nguyÃªn cÃ³ sáºµn (chÆ°a hiá»ƒn thá»‹ trong áº£nh, cÃ³ thá»ƒ chá»n sau).
			- IP Address: 192.168.100.138 - Shared - Server â€“ IP dÃ¹ng chung vá»›i mÃ¡y chá»§.
		- TÃ¹y chá»n khÃ¡c
			- Send Email Notification: ÄÆ°á»£c báº­t â€“ Gá»­i email thÃ´ng bÃ¡o khi táº¡o tÃ i khoáº£n.
			- Edit User Message: Cho phÃ©p chá»‰nh sá»­a ná»™i dung email gá»­i Ä‘i (nÃºt khÃ´ng Ä‘Æ°á»£c chá»n).
			- Customize: TÃ¹y chá»‰nh cáº¥u hÃ¬nh tÃ i nguyÃªn náº¿u khÃ´ng dÃ¹ng gÃ³i cÃ³ sáºµn.
			- Submit: NÃºt Ä‘á»ƒ táº¡o tÃ i khoáº£n.
		- ![images](./images/s-347.png) 
		- User Ä‘Æ°á»£c táº¡o 
		- ![images](./images/s-348.png) 

- CÃ i Ä‘áº·t SSL 
- ÄÄƒng nháº­p tÃ i khoáº£n user quáº£n trá»‹ 
- ![images](./images/s-349.png) 
- ![images](./images/s-350.png) 
- Táº¡i pháº§n `Advanced Features`-> `SSL Certificates` 
- ![images](./images/s-351.png) 
- ÄÃ¢y lÃ  trang cáº¥u hÃ¬nh cÃ i Ä‘áº·t chá»©ng chá»‰ SSL, DA há»— trá»£ cÃ¡c tuá»³ chá»n:
	- Use the server's certificate: DÃ¹ng chá»©ng chá»‰ SSL máº·c Ä‘á»‹nh cá»§a mÃ¡y chá»§.
	- Use the server's shared signed certificate: DÃ¹ng chá»©ng chá»‰ Ä‘Ã£ kÃ½ chung cá»§a mÃ¡y chá»§.
	- Create your own self-signed certificate: Tá»± táº¡o chá»©ng chá»‰ SSL khÃ´ng cÃ³ chá»¯ kÃ½ xÃ¡c thá»±c (dÃ¹ng táº¡m, khÃ´ng báº£o máº­t cao).
	- Create a certificate request: Táº¡o yÃªu cáº§u cáº¥p chá»©ng chá»‰ (CSR) Ä‘á»ƒ gá»­i Ä‘áº¿n nhÃ  cung cáº¥p chá»©ng chá»‰.
	- Free & automatic certificate from Let's Encrypt: Nháº­n chá»©ng chá»‰ SSL miá»…n phÃ­ tá»« Let's Encrypt (khuyÃªn dÃ¹ng).
	- Paste a pre-generated certificate and key: DÃ¡n chá»©ng chá»‰ vÃ  khÃ³a riÃªng náº¿u báº¡n Ä‘Ã£ cÃ³ sáºµn.
	- Click Here to paste a CA Root Certificate: DÃ¡n chá»©ng chá»‰ gá»‘c tá»« nhÃ  cung cáº¥p.
	- Force SSL with https redirect: Báº¯t buá»™c chuyá»ƒn hÆ°á»›ng HTTP sang HTTPS.
- ![images](./images/s-352.png) 
- Táº¡i Ä‘Ã¢y chá»n paste chá»©ng chá»‰ cÃ³ sáºµn 
- ![images](./images/s-353.png) 
- ![images](./images/s-354.png) 
- Kiá»ƒm tra nháº­n tháº¥y web Ä‘Ã£ nháº­n chá»©ng chá»‰ 
- ![images](./images/s-355.png) 

- Cáº¥u hÃ¬nh cÃ¡c tÃ­nh nÄƒng  HTTP Redirect, HSTS, OCSP stapling, HTTP/2 
	- HTTP Redirect 
		- Táº¡i web quáº£n trá»‹ -> `Domain Setups` -> chá»n Domain cáº§n chá»‰nh sá»­a 
		- ![images](./images/s-356.png) 
		- ![images](./images/s-357.png) 
		- TÃ­ch chá»n `Force SSL with HTTP redirect`
		- ![images](./images/s-358.png) 
		- Kiá»ƒm tra 
		- Truy cáº­p http tá»± Ä‘á»™ng chuyá»ƒn tá»›i https 
		- ![images](./images/s-365.png) 
		- ![images](./images/s-368.png) 

	- HSTS 
		- Táº¡i web quáº£n trá»‹ admin level pháº§n `Extra Features` -> `Custom HTTPD Configurations`
		- ![images](./images/s-361.png) 
		- Chá»n tÃªn miá»n cáº§n cáº¥u hÃ¬nh 
		- ![images](./images/s-362.png) 
		- Táº¡i pháº§n Custom1 thÃªm cáº¥u hÃ¬nh vÃ  Save
		```
		Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
		```
		- ![images](./images/s-363.png) 
		- Kiá»ƒm tra tháº¥y Ä‘Ã£ cÃ³ header HSTS 
		- ![images](./images/s-364.png) 

	- OCSP 
		- Cáº¥u hÃ¬nh táº¡i pháº§n `Custom HTTPD Configurations` tÆ°Æ¡ng tá»± HSTS 
		- Bá»• sung táº¡i pháº§n `Http.conf Customization for annth.io.vn`
		```
		SSLUseStapling on
		SSLStaplingResponderTimeout 5
		SSLStaplingReturnResponderErrors off
		SSLStaplingFakeTryLater off
		SSLStaplingStandardCacheTimeout 86400
		```
		- Pháº§n `Custom1`
		```
		SSLStaplingCache "shmcb:logs/ssl_stapling(32768)"
		```
		- Save 
		- ![images](./images/s-366.png) 
		- Kiá»ƒm tra 
		```
		openssl s_client -connect annth.io.vn:443 -status | findstr OCSP
		```
		- ![images](./images/s-367.png) 

	- HTTP/2 Máº·c Ä‘á»‹nh Ä‘Æ°á»£c há»— trá»£ 
		- ![images](./images/s-369.png) 


#### 12.3.3 Cpanel 
- QÃºa trÃ¬nh cÃ i Ä‘áº·t, Ä‘Äƒng kÃ½ free trial táº¡i [Ä‘Ã¢y](https://github.com/anthanh264/thuctapnhanhoa/blob/main/31.05.25/1.%20C%C3%A0i%20%C4%91%E1%BA%B7t%20Cpanel.md) 
- Táº¡o user táº¡o web quáº£n trá»‹ WHM -> Account Functions -> Create a New User 
	- ![images](./images/s-288.png) 
	- ![images](./images/s-289.png) 
	- ÄÄƒng nháº­p vá»›i thÃ´ng tin user vá»«a táº¡o 
	- ![images](./images/s-290.png) 
	- Táº¡o site WordPress
	- ![images](./images/s-291.png) 

- CÃ i Ä‘áº·t SSL 
	- Táº¡o panel Cpanel user chá»n `Tools`
	- ![images](./images/s-292.png) 
	- Táº¡i má»¥c `Security` -> `SSL/TLS` 
	- ![images](./images/s-293.png) 
	- Chá»n pháº§n `Certificate (CRT)`
	- ![images](./images/s-295.png) 
	- Táº¡i Ä‘Ã¢y cÃ³ thá»ƒ paste chá»©ng chá»‰ Ä‘Ã£ Ä‘Æ°á»£c cáº¥p hoáº·c táº£i lÃªn. Trong vÃ­ dá»¥ nÃ y thá»±c hiá»‡n táº£i lÃªn chá»©ng chá»‰ 
	- ![images](./images/s-296.png) 
	- ![images](./images/s-297.png) 
	- ![images](./images/s-298.png) 
	- Chá»©ng chá»‰ Ä‘Ã£ Ä‘Æ°á»£c thÃªm 
	- ![images](./images/s-299.png) 
	- Tiáº¿n hÃ nh cÃ i Ä‘áº·t. Chá»n `Install`
	- ![images](./images/s-300.png) 
	- Bá»• sung thÃ´ng tin `PrivateKey` cá»§a chá»©ng chá»‰. ThÃ´ng tin CA Bundle thÆ°á»ng sáº½ Ä‘Æ°á»£c há»‡ thá»‘ng tá»± Ä‘á»™ng cáº­p nháº­t. 
	- ![images](./images/s-301.png) 
	- Sau khi bá»• sung -> `Install Certificate` -> Chá»©ng chá»‰ Ä‘Æ°á»£c cÃ i thÃ nh cÃ´ng 
	- ![images](./images/s-302.png) 
	- Kiá»ƒm tra báº±ng cÃ¡ch truy cáº­p trang web kiá»ƒm tra thÃ´ng tin chá»©ng chá»‰ 
	- ![images](./images/s-303.png) 

- Cáº¥u hÃ¬nh cÃ¡c tÃ­nh nÄƒng  HTTP Redirect, HSTS, OCSP stapling, HTTP/2 
	- HTTP Redirect
		- Táº¡i Cpanel cá»§a user, `Tools`-> `Domains` -> `Domain`
		- ![images](./images/s-304.png) 
		- Báº­t tÃ­nh nÄƒng `force HTTPS redirect`
		- ![images](./images/s-305.png) 
		- ![images](./images/s-306.png) 

	- HSTS
		- Cáº¥u hÃ¬nh toÃ n server: táº¡i trang quáº£n trá»‹ WHM -> `Service Configuration` -> `Apache Configuration` -> `Include Editor`
		- ![images](./images/s-307.png) 
		- Táº¡i pháº§n `Pre Main Include` chá»n `All Verions` pháº§n Global bá»• sung Ä‘oáº¡n sau 
		```
		<IfModule mod_headers.c>
		Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
		Header always edit Set-Cookie (.*) "$1;HttpOnly;Secure"
		Header always set X-Frame-Options "sameorigin"
		Header setifempty Referrer-Policy: same-origin
		Header set X-XSS-Protection "1; mode=block"
		Header set X-Permitted-Cross-Domain-Policies "none"
		Header set Referrer-Policy "no-referrer"
		Header set X-Content-Type-Options: nosniff
		</IfModule>
		```
			- `Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"`: Set trÃ¬nh duyá»‡t dÃ¹ng HTTPS trong 1 nÄƒm cho cáº£ subdomain  
			- `Header always edit Set-Cookie (.*) "$1;HttpOnly;Secure"`: thÃªm HttpOnly vÃ  Secure vÃ o cookie Ä‘á»ƒ tÄƒng báº£o máº­t  
			- `Header always set X-Frame-Options "sameorigin"`: chá»‰ cho phÃ©p iframe tá»« cÃ¹ng domain Ä‘á»ƒ chá»‘ng clickjacking  
			- `Header setifempty Referrer-Policy: same-origin`: náº¿u chÆ°a cÃ³ thÃ¬ chá»‰ gá»­i referrer trong cÃ¹ng domain  
			- `Header set X-XSS-Protection "1; mode=block"`: báº­t bá»™ lá»c XSS cá»§a trÃ¬nh duyá»‡t vÃ  cháº·n náº¿u phÃ¡t hiá»‡n táº¥n cÃ´ng  
			- `Header set X-Permitted-Cross-Domain-Policies "none"`: cháº·n Flash/PDF tá»« domain khÃ¡c truy cáº­p tÃ i nguyÃªn  
			- `Header set Referrer-Policy "no-referrer"`: khÃ´ng gá»­i referrer trong má»i trÆ°á»ng há»£p  
			- `Header set X-Content-Type-Options: nosniff`: ngÄƒn trÃ¬nh duyá»‡t Ä‘oÃ¡n sai kiá»ƒu file Ä‘á»ƒ trÃ¡nh thá»±c thi mÃ£ Ä‘á»™c
		- Click chá»n `Update` vÃ  `Restart` Apache Ä‘á»ƒ Ã¡p dá»¥ng.
		- ![images](./images/s-308.png) 
		- ![images](./images/s-309.png) 
		- ![images](./images/s-310.png) 
		- ![images](./images/s-311.png) 
		- Kiá»ƒm tra báº±ng trÃ¬nh duyá»‡t nháº­n tháº¥y Ä‘Ã£ cÃ³ header HSTS 	
		- ![images](./images/s-312.png) 
	- OCSP Stapling Ä‘Ã£ Ä‘Æ°á»£c há»— trá»£ máº·c Ä‘á»‹nh 
		- ![images](./images/s-314.png) 

	- HTTP/2
		- Táº¡i trang quáº£n trá»‹ WHM -> `Software` -> `EasyApache4` 
		- ![images](./images/s-315.png) 
		- Táº¡i pháº§n `Currently Installed Packages` chá»n `Customize` 
		- ![images](./images/s-316.png) 
		- Chá»n tab Apache Modules 
		- ![images](./images/s-317.png) 
		- TÃ¬m http/2 vÃ  enable 
		- ![images](./images/s-318.png) 
		- Chá»n Yes
		- ![images](./images/s-319.png) 
		- Äá»ƒ cháº¡y HTTP/2 cáº§n chá»n mod khÃ¡c prefolk -> Continue 
		- ![images](./images/s-320.png) 
		- Chá»n mod eventdriven 
		- ![images](./images/s-321.png) 
		- Chuyá»ƒn sang tab `Review` -> `Provision`
		- ![images](./images/s-322.png) 
		- ![images](./images/s-323.png) 
		- ![images](./images/s-324.png) 
- Kiá»ƒm tra
	- Sá»­ dá»¥ng curl 
	- ![images](./images/s-325.png) 
	- Sá»­ dá»¥ng trÃ¬nh duyá»‡t 
	- ![images](./images/s-326.png) 

## References
1. [What is SSL? | SSL definition](https://www.cloudflare.com/learning/ssl/what-is-ssl/)
2. [What is TLS (Transport Layer Security)?](https://www.cloudflare.com/learning/ssl/transport-layer-security-tls/)
3. [What is SSL/TLS: An In-Depth Guide - SSL.com](https://www.ssl.com/article/what-is-ssl-tls-an-in-depth-guide/)
4. [A Comprehensive Guide to SSL/TLS Technology](https://www.pubnub.com/guides/ssl-tls/)
5. [SSL vs TLS | What's the Difference between SSL and TLS?](https://www.globalsign.com/en/blog/ssl-vs-tls-difference)
6. [The Benefits & Limitations of SSL Certificates](https://www.indusface.com/blog/the-benefits-limitations-of-ssl-certificates/)
7. [The Pros And Cons Of Implementing SSL / HTTPS](https://www.nexcess.net/blog/the-pros-and-cons-of-implementing-ssl-https/#:~:text=Data%20Integrity,more%20difficult%20to%20pull%20off.)
8. [SSL vs TLS - Difference Between Communication Protocols - AWS](https://aws.amazon.com/compare/the-difference-between-ssl-and-tls/)
9. [How does HTTPS work? (Episode 6) - by Alex Xu](https://blog.bytebytego.com/p/how-does-https-work-episode-6)
10. [What happens in a TLS handshake? | SSL handshake](https://www.cloudflare.com/en-gb/learning/ssl/what-happens-in-a-tls-handshake/)
11. [Private And Public Keys - SSL.com](https://www.ssl.com/article/private-and-public-keys/)
12. [Public Key and Private Key: How they Pair & Work Together](https://www.preveil.com/blog/public-and-private-key/)
13. [Certificate Signing Request (CSR): What is it?](https://www.globalsign.com/en/blog/what-is-a-certificate-signing-request-csr)
14. [SSL Certificate Formats and File Extensions - SSL Dragon](https://www.ssldragon.com/blog/ssl-certificate-formats/)
15. [What is HTTP Strict Transport Security (HSTS)? - SSL.com](https://www.ssl.com/article/what-is-http-strict-transport-security-hsts/)
16. [Apache - Configuring HTTP Strict Transport Security](https://www.xolphin.com/support/Apache_FAQ/Apache_-_Configuring_HTTP_Strict_Transport_Security)
17. [HTTP Strict Transport Security (HSTS) and NGINX â€“ NGINX Community Blog](https://blog.nginx.org/blog/http-strict-transport-security-hsts-and-nginx)
18. [IIS - Configuring HTTP Strict Transport Security](https://www.xolphin.com/support/IIS_FAQ/IIS_-_Configuring_HTTP_Strict_Transport_Security)
19. [PTC Help Center](https://support.ptc.com/help/thingworx/platform/r9.6/en/index.html#page/ThingWorx/Help/Composer/Security/enabling_hsts_in_apache_tomcat.html)
20. [How To Configure OCSP Stapling on Apache and Nginx | DigitalOcean](https://www.digitalocean.com/community/tutorials/how-to-configure-ocsp-stapling-on-apache-and-nginx)
21. [Windows | Enabling OCSP Stapling on Your Server](https://knowledge.digicert.com/tutorials/windows-enable-ocsp-stapling)
22. [TLS-SSL Settings | Microsoft Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn786418(v=ws.11)#ocsp-stapling)
23. [How to configure Tomcat for OCSP stapling?](https://lists.apache.org/thread/t5m2jf7tvzj8bkdj19gfw9rqy13vww60#:~:text=On%20Mon%2C%20May%2028%2C%202018,the%20OCSP%20url%20is%20present)
24. [Configure tomcat to use Java 9 native OCSP stapling and OCSP check](https://stackoverflow.com/questions/56518867/configure-tomcat-to-use-java-9-native-ocsp-stapling-and-ocsp-check)
25. [How to Implement HTTP2 in Tomcat?](https://geekflare.com/dev/tomcat-http2/)
26. [What is mixed content?](https://www.cloudflare.com/learning/ssl/what-is-mixed-content/)
27. [How to Fix ERR_CERT_COMMON_NAME_INVALID](https://www.gogetssl.com/wiki/problems/err_cert_common_name_invalid/?srsltid=AfmBOoqIUMGTiKB5aVSR94zT6_1pTyLEaGMj0s4XN5L2EF9cEwZ_abnc)
28. [What Is SSL Handshake & How Do I Fix SSL Handshake Failed?](https://blog.hubspot.com/website/ssl-handshake-failed)
29. [What is HTTPS?](https://www.cloudflare.com/learning/ssl/what-is-https/)
30. [HTTP/3 for Beginners and How to Protect Your HTTP/3 Website - DEV Community](https://dev.to/carrie_luo1/http3-for-beginners-and-how-to-protect-your-http3-website-3n9b)
31. [PCI DSS lÃ  gÃ¬? Má»¥c Ä‘Ã­ch chÃ­nh cá»§a tiÃªu chuáº©n báº£o máº­t PCI DSS](https://cmccloud.vn/tin-tuc/pci-dss-la-gi)
32. [Chá»©ng chá»‰ PCI DSS lÃ  gÃ¬?](https://www.momo.vn/hoi-dap/chung-chi-pci-dss-la-gi)
33. [KhÃ´ng cÃ³ tiÃªu Ä‘á»](https://viettelidc.com.vn/tin-tuc/quyen-rieng-tu-gdpr-la-gi-tat-tan-tat-cac-thong-tin)
34. [HIPAA lÃ  gÃ¬? Quy táº¯c báº£o vá»‡ dá»¯ liá»‡u sá»©c khá»e chuáº©n Hoa Ká»³](https://fptcloud.com/hipaa-la-gi/)
35. [Enabling HTTP Strict Transport Security (HSTS)](https://docs.cadmatic.com/eshare/Content/Installation/IIS_EnablingHSTS.htm)